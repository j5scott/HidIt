
<!-- saved from url=(0080)https://www.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/6_CPU_Scheduling.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="GENERATOR" content="Adobe PageMill 3.0 Win">
  <title>Operating Systems: CPU Scheduling</title>
  <style type="text/css">
<!--
.courier {
	font-family: Courier New, Courier, monospace;
}
-->
  .hideWord{color:blue;background-color:blue}.hideWord2{color:white;background-color:white}.hoverOver{color:red;opacity:1;background-color:white}.whiteBG{background-color:white!important}.imageHide{opacity:0.02!important}.imageReveal{opacity:1.0!important}.imageReveal:parent{background-color:white!important}.imageHide:parent{background-color:blue!important}</style>
</head>
<body bgcolor="#ffff80" class="whiteBG">

<h1><span></span><center><span>
</span> <span></span> <span>CPU</span> <span>Scheduling</span> <span>
</span></center></h1>

<h3></h3>

<ol>
  <li><span>Abraham</span> <span>Silberschatz,</span> <span>Greg</span> <span>Gagne,</span> <span>and</span> <span>Peter</span> <span>Baer</span> <span>Galvin,</span> <span>"Operating</span> <span>System</span> <span>Concepts,</span> <span>Ninth</span> <span>Edition</span> <span>",</span> <span>Chapter</span> </li></ol>

<h3><span>6</span>.<span>1</span> <span>Basic</span> <span>Concepts</span> </h3>
<ul>
  <li><span>Almost</span> <span>all</span> <span>programs</span> <span>have</span> <span>some</span> <span>alternating</span> <span>cycle</span> <span>of</span> <span>CPU</span> <span>number</span> <span>crunching</span> <span>and</span> <span>waiting</span> <span>for</span> <span>I/O</span> <span>of</span> <span>some</span> <span>kind</span>.<span></span> <span>(</span> <span>Even</span> <span>a</span> <span>simple</span> <span>fetch</span> <span>from</span> <span>memory</span> <span>takes</span> <span>a</span> <span>long</span> <span>time</span> <span>relative</span> <span>to</span> <span>CPU</span> <span>speeds</span>.</li>
  <li><span>In</span> <span>a</span> <span>simple</span> <span>system</span> <span>running</span> <span>a</span> <span>single</span> <span>process,</span> <span>the</span> <span>time</span> <span>spent</span> <span>waiting</span> <span>for</span> <span>I/O</span> <span>is</span> <span>wasted,</span> <span>and</span> <span>those</span> <span>CPU</span> <span>cycles</span> <span>are</span> <span>lost</span> <span>forever</span>.</li>
  <li><span>A</span> <span>scheduling</span> <span>system</span> <span>allows</span> <span>one</span> <span>process</span> <span>to</span> <span>use</span> <span>the</span> <span>CPU</span> <span>while</span> <span>another</span> <span>is</span> <span>waiting</span> <span>for</span> <span>I/O,</span> <span>thereby</span> <span>making</span> <span>full</span> <span>use</span> <span>of</span> <span>otherwise</span> <span>lost</span> <span>CPU</span> <span>cycles</span>.</li>
  <li><span>The</span> <span>challenge</span> <span>is</span> <span>to</span> <span>make</span> <span>the</span> <span>overall</span> <span>system</span> <span>as</span> <span>"efficient"</span> <span>and</span> <span>"fair"</span> <span>as</span> <span>possible,</span> <span>subject</span> <span>to</span> <span>varying</span> <span>and</span> <span>often</span> <span>dynamic</span> <span>conditions,</span> <span>and</span> <span>where</span> <span>"efficient"</span> <span>and</span> <span>"fair"</span> <span>are</span> <span>somewhat</span> <span>subjective</span> <span>terms,</span> <span>often</span> <span>subject</span> <span>to</span> <span>shifting</span> <span>priority</span> <span>policies</span>.<span></span> <span></span> <span></span> </li>
</ul>
<blockquote>
  <h4><span>6</span>.<span>1</span>.<span>1</span> <span>CPU-I/O</span> <span>Burst</span> </h4>
  <ul>
    <li><span>Almost</span> <span>all</span> <span>processes</span> <span>alternate</span> <span>between</span> <span>two</span> <span>states</span> <span>in</span> <span>a</span> <span>continuing</span><em><span></span><strong><span></span> <span>cycle</span></strong><span></span></em><span>,</span> <span>as</span> <span>shown</span> <span>in</span> <span>Figure</span> <span>6</span>.<span>1</span> <span>below</span> <span></span><em><span></span><strong><span>:</span></strong><span></span></em><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>A</span> <span>CPU</span> <span>burst</span> <span>of</span> <span>performing</span> <span>calculations,</span> <span>and</span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>An</span> <span>I/O</span> <span>burst,</span> <span>waiting</span> <span>for</span> <span>data</span> <span>transfer</span> <span>in</span> <span>or</span> <span>out</span> <span>of</span> <span>the</span> <span>system</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_01_CPU_BurstCycle.jpg" width="338" height="632"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>1</span> <span>-</span> <span>Alternating</span> <span>sequence</span> <span>of</span> <span>CPU</span> <span>and</span> <span>I/O</span> <span>bursts</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <li><span>CPU</span> <span>bursts</span> <span>vary</span> <span>from</span> <span>process</span> <span>to</span> <span>process,</span> <span>and</span> <span>from</span> <span>program</span> <span>to</span> <span>program,</span> <span>but</span> <span>an</span> <span>extensive</span> <span>study</span> <span>shows</span> <span>frequency</span> <span>patterns</span> <span>similar</span> <span>to</span> <span>that</span> <span>shown</span> <span>in</span> <span>Figure</span> <span>6</span>.<span>2:</span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_02_CPU_Histogram.jpg" width="719" height="478"><span></span><br><span>
</span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>2</span> <span>-</span> <span>Histogram</span> <span>of</span> <span>CPU-burst</span> <span>durations</span>.<span></span></strong></p>
  <h4><span>6</span>.<span>1</span>.<span>2</span> <span>CPU</span> </h4>
  <ul>
    <li><span>Whenever</span> <span>the</span> <span>CPU</span> <span>becomes</span> <span>idle,</span> <span>it</span> <span>is</span> <span>the</span> <span>job</span> <span>of</span> <span>the</span> <span>CPU</span> <span>Scheduler</span> <span>(</span> <span>a</span>.<span>k</span>.<span>a</span>.<span></span> <span>the</span> <span>short-term</span> <span>scheduler</span> <span>)</span> <span>to</span> <span>select</span> <span>another</span> <span>process</span> <span>from</span> <span>the</span> <span>ready</span> <span>queue</span> <span>to</span> <span>run</span> <span>next</span>.</li>
    <li><span>The</span> <span>storage</span> <span>structure</span> <span>for</span> <span>the</span> <span>ready</span> <span>queue</span> <span>and</span> <span>the</span> <span>algorithm</span> <span>used</span> <span>to</span> <span>select</span> <span>the</span> <span>next</span> <span>process</span> <span>are</span> <span>not</span> <span>necessarily</span> <span>a</span> <span>FIFO</span> <span>queue</span>.<span></span> <span>There</span> <span>are</span> <span>several</span> <span>alternatives</span> <span>to</span> <span>choose</span> <span>from,</span> <span>as</span> <span>well</span> <span>as</span> <span>numerous</span> <span>adjustable</span> <span>parameters</span> <span>for</span> <span>each</span> <span>algorithm,</span> <span>which</span> <span>is</span> <span>the</span> <span>basic</span> <span>subject</span> <span>of</span> <span>this</span> <span>entire</span> <span>chapter</span>.<span></span> </li>
  </ul>
  <h4><span>6</span>.<span>1</span>.<span>3</span>.<span></span> <span>Preemptive</span> </h4>
  <ul>
    <li><span>CPU</span> <span>scheduling</span> <span>decisions</span> <span>take</span> <span>place</span> <span>under</span> <span>one</span> <span>of</span> <span>four</span> <span>conditions:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>When</span> <span>a</span> <span>process</span> <span>switches</span> <span>from</span> <span>the</span> <span>running</span> <span>state</span> <span>to</span> <span>the</span> <span>waiting</span> <span>state,</span> <span>such</span> <span>as</span> <span>for</span> <span>an</span> <span>I/O</span> <span>request</span> <span>or</span> <span>invocation</span> <span>of</span> <span>the</span> <span>wait(</span> <span>)</span> <span>system</span> <span>call</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>When</span> <span>a</span> <span>process</span> <span>switches</span> <span>from</span> <span>the</span> <span>running</span> <span>state</span> <span>to</span> <span>the</span> <span>ready</span> <span>state,</span> <span>for</span> <span>example</span> <span>in</span> <span>response</span> <span>to</span> <span>an</span> <span>interrupt</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>When</span> <span>a</span> <span>process</span> <span>switches</span> <span>from</span> <span>the</span> <span>waiting</span> <span>state</span> <span>to</span> <span>the</span> <span>ready</span> <span>state,</span> <span>say</span> <span>at</span> <span>completion</span> <span>of</span> <span>I/O</span> <span>or</span> <span>a</span> <span>return</span> <span>from</span> <span>wait(</span> <span>)</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>When</span> <span>a</span> <span>process</span> <span>terminates</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>For</span> <span>conditions</span> <span>1</span> <span>and</span> <span>4</span> <span>there</span> <span>is</span> <span>no</span> <span>choice</span> <span>-</span> <span>A</span> <span>new</span> <span>process</span> <span>must</span> <span>be</span> <span>selected</span>.</li>
    <li><span>For</span> <span>conditions</span> <span>2</span> <span>and</span> <span>3</span> <span>there</span> <span>is</span> <span>a</span> <span>choice</span> <span>-</span> <span>To</span> <span>either</span> <span>continue</span> <span>running</span> <span>the</span> <span>current</span> <span>process,</span> <span>or</span> <span>select</span> <span>a</span> <span>different</span> <span>one</span>.<span></span> <span></span> <span></span> <span></span> <span></span> <span></span> </li>
    <li><span>If</span> <span>scheduling</span> <span>takes</span> <span>place</span> <span>only</span> <span>under</span> <span>conditions</span> <span>1</span> <span>and</span> <span>4,</span> <span>the</span> <span>system</span> <span>is</span> <span>said</span> <span>to</span> <span>be</span><em><span></span><strong><span></span> <span>non-preemptive</span></strong><span></span></em><span>,</span> <span>or</span> <span></span><em><span></span><strong><span>cooperative</span></strong><span></span></em><span></span>.<span></span> <span>Under</span> <span>these</span> <span>conditions,</span> <span>once</span> <span>a</span> <span>process</span> <span>starts</span> <span>running</span> <span>it</span> <span>keeps</span> <span>running,</span> <span>until</span> <span>it</span> <span>either</span> <span>voluntarily</span> <span>blocks</span> <span>or</span> <span>until</span> <span>it</span> <span>finishes</span>.<span></span> <span>Otherwise</span> <span>the</span> <span>system</span> <span>is</span> <span>said</span> <span>to</span> <span>be</span> <span></span><em><span></span><strong><span>preemptive</span>.<span></span></strong><span></span></em></li>
    <li><span>Windows</span> <span>used</span> <span>non-preemptive</span> <span>scheduling</span> <span>up</span> <span>to</span> <span>Windows</span> <span>3</span>.<span>x,</span> <span>and</span> <span>started</span> <span>using</span> <span>pre-emptive</span> <span>scheduling</span> <span>with</span> <span>Win95</span>.<span></span> <span>Macs</span> <span>used</span> <span>non-preemptive</span> <span>prior</span> <span>to</span> <span>OSX,</span> <span>and</span> <span>pre-emptive</span> <span>since</span> <span>then</span>.<span></span> <span>Note</span> <span>that</span> <span>pre-emptive</span> <span>scheduling</span> <span>is</span> <span>only</span> <span>possible</span> <span>on</span> <span>hardware</span> <span>that</span> <span>supports</span> <span>a</span> <span>timer</span> <span>interrupt</span>.</li>
    <li><span>Note</span> <span>that</span> <span>pre-emptive</span> <span>scheduling</span> <span>can</span> <span>cause</span> <span>problems</span> <span>when</span> <span>two</span> <span>processes</span> <span>share</span> <span>data,</span> <span>because</span> <span>one</span> <span>process</span> <span>may</span> <span>get</span> <span>interrupted</span> <span>in</span> <span>the</span> <span>middle</span> <span>of</span> <span>updating</span> <span>shared</span> <span>data</span> <span>structures</span>.<span></span> <span>Chapter</span> <span>5</span> <span>examined</span> <span>this</span> <span>issue</span> <span>in</span> <span>greater</span> <span>detail</span>.</li>
    <li><span>Preemption</span> <span>can</span> <span>also</span> <span>be</span> <span>a</span> <span>problem</span> <span>if</span> <span>the</span> <span>kernel</span> <span>is</span> <span>busy</span> <span>implementing</span> <span>a</span> <span>system</span> <span>call</span> <span>(</span> <span>e</span>.<span>g</span>.<span></span> <span>updating</span> <span>critical</span> <span>kernel</span> <span>data</span> <span>structures</span> <span>)</span> <span>when</span> <span>the</span> <span>preemption</span> <span>occurs</span>.<span></span> <span></span> <span>Most</span> <span>modern</span> <span>UNIXes</span> <span>deal</span> <span>with</span> <span>this</span> <span>problem</span> <span>by</span> <span>making</span> <span>the</span> <span>process</span> <span>wait</span> <span>until</span> <span>the</span> <span>system</span> <span>call</span> <span>has</span> <span>either</span> <span>completed</span> <span>or</span> <span>blocked</span> <span>before</span> <span>allowing</span> <span>the</span> <span>preemption</span> <span>Unfortunately</span> <span>this</span> <span>solution</span> <span>is</span> <span>problematic</span> <span>for</span> <span>real-time</span> <span>systems,</span> <span>as</span> <span>real-time</span> <span>response</span> <span>can</span> <span>no</span> <span>longer</span> <span>be</span> <span>guaranteed</span>.</li>
    <li><span>Some</span> <span>critical</span> <span>sections</span> <span>of</span> <span>code</span> <span>protect</span> <span>themselves</span> <span>from</span> <span>con</span> <span>currency</span> <span>problems</span> <span>by</span> <span>disabling</span> <span>interrupts</span> <span>before</span> <span>entering</span> <span>the</span> <span>critical</span> <span>section</span> <span>and</span> <span>re-enabling</span> <span>interrupts</span> <span>on</span> <span>exiting</span> <span>the</span> <span>section</span>.<span></span> <span>Needless</span> <span>to</span> <span>say,</span> <span>this</span> <span>should</span> <span>only</span> <span>be</span> <span>done</span> <span>in</span> <span>rare</span> <span>situations,</span> <span>and</span> <span>only</span> <span>on</span> <span>very</span> <span>short</span> <span>pieces</span> <span>of</span> <span>code</span> <span>that</span> <span>will</span> <span>finish</span> <span>quickly,</span> <span>(&nbsp;usually</span> <span>just</span> <span>a</span> <span>few</span> <span>machine</span> <span>instructions</span>.<span>&nbsp;)</span> </li>
  </ul>
  <h4><span>6</span>.<span>1</span>.<span>4</span> </h4>
  <ul>
    <li><span>The</span> <span></span><strong><span>dispatcher</span></strong><span></span> <span>is</span> <span>the</span> <span>module</span> <span>that</span> <span>gives</span> <span>control</span> <span>of</span> <span>the</span> <span>CPU</span> <span>to</span> <span>the</span> <span>process</span> <span>selected</span> <span>by</span> <span>the</span> <span>scheduler</span>.<span></span> <span>This</span> <span>function</span> <span>involves:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Switching</span> <span>context</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Switching</span> <span>to</span> <span>user</span> <span>mode</span>.<span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Jumping</span> <span>to</span> <span>the</span> <span>proper</span> <span>location</span> <span>in</span> <span>the</span> <span>newly</span> <span>loaded</span> <span>program</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>The</span> <span>dispatcher</span> <span>needs</span> <span>to</span> <span>be</span> <span>as</span> <span>fast</span> <span>as</span> <span>possible,</span> <span>as</span> <span>it</span> <span>is</span> <span>run</span> <span>on</span> <span>every</span> <span>context</span> <span>switch</span>.<span></span> <span>The</span> <span>time</span> <span>consumed</span> <span>by</span> <span>the</span> <span>dispatcher</span> <span>is</span> <span>known</span> <span>as</span> <span></span><strong><span>dispatch</span> <span>latency</span>.<span></span> <span></span></strong></li>
  </ul>
</blockquote>
<h3><span>6</span>.<span>2</span> <span>Scheduling</span> <span>Criteria</span> </h3>
<ul>
  <li><span>There</span> <span>are</span> <span>several</span> <span>different</span> <span>criteria</span> <span>to</span> <span>consider</span> <span>when</span> <span>trying</span> <span>to</span> <span>select</span> <span>the</span> <span>"best"</span> <span>scheduling</span> <span>algorithm</span> <span>for</span> <span>a</span> <span>particular</span> <span>situation</span> <span>and</span> <span>environment,</span> <span>including:
</span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>CPU</span> <span>utilization</span></strong><span></span> <span>-</span> <span>Ideally</span> <span>the</span> <span>CPU</span> <span>would</span> <span>be</span> <span>busy</span> <span>100%</span> <span>of</span> <span>the</span> <span>time,</span> <span>so</span> <span>as</span> <span>to</span> <span>waste</span> <span>0</span> <span>CPU</span> <span>cycles</span>.<span></span> <span>On</span> <span>a</span> <span>real</span> <span>system</span> <span>CPU</span> <span>usage</span> <span>should</span> <span>range</span> <span>from</span> <span>40%</span> <span>(&nbsp;lightly</span> <span>loaded&nbsp;)</span> <span>to</span> <span>90%</span> <span>(&nbsp;heavily</span> <span>loaded</span>.<span>&nbsp;)</span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Throughput</span></strong><span></span> <span>-</span> <span>Number</span> <span>of</span> <span>processes</span> <span>completed</span> <span>per</span> <span>unit</span> <span>time</span>.<span></span> <span>May</span> <span>range</span> <span>from</span> <span>10</span> <span>/</span> <span>second</span> <span>to</span> <span>1</span> <span>/</span> <span>hour</span> <span>depending</span> <span>on</span> <span>the</span> <span>specific</span> <span>processes</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Turnaround</span> <span>time</span></strong><span></span> <span>-</span> <span>Time</span> <span>required</span> <span>for</span> <span>a</span> <span>particular</span> <span>process</span> <span>to</span> <span>complete,</span> <span>from</span> <span>submission</span> <span>time</span> <span>to</span> <span>completion</span>.<span></span> <span>(&nbsp;Wall</span> <span>clock</span> <span>time</span>.<span>&nbsp;)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Waiting</span> <span>time</span></strong><span></span> <span>-</span> <span>How</span> <span>much</span> <span>time</span> <span>processes</span> <span>spend</span> <span>in</span> <span>the</span> <span>ready</span> <span>queue</span> <span>waiting</span> <span>their</span> <span>turn</span> <span>to</span> <span>get</span> <span>on</span> <span>the</span> <span>CPU</span>.<span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>(&nbsp;</span><strong><span>Load</span> <span>average</span></strong><span></span> <span>-</span> <span>The</span> <span>average</span> <span>number</span> <span>of</span> <span>processes</span> <span>sitting</span> <span>in</span> <span>the</span> <span>ready</span> <span>queue</span> <span>waiting</span> <span>their</span> <span>turn</span> <span>to</span> <span>get</span> <span>into</span> <span>the</span> <span>CPU</span>.<span></span> <span>Reported</span> <span>in</span> <span>1-minute,</span> <span>5-minute,</span> <span>and</span> <span>15-minute</span> <span>averages</span> <span>by</span> <span>"uptime"</span> <span>and</span> <span>"who"</span>.<span>&nbsp;)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Response</span> <span>time</span></strong><span></span> <span>-</span> <span>The</span> <span>time</span> <span>taken</span> <span>in</span> <span>an</span> <span>interactive</span> <span>program</span> <span>from</span> <span>the</span> <span>issuance</span> <span>of</span> <span>a</span> <span>command</span> <span>to</span> <span>the</span> <span></span><em><span></span><strong><span>commence</span></strong><span></span></em><span></span> <span>of</span> <span>a</span> <span>response</span> <span>to</span> <span>that</span> <span>command</span>.<span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> </li>
  <li><span>In</span> <span>general</span> <span>one</span> <span>wants</span> <span>to</span> <span>optimize</span> <span>the</span> <span>average</span> <span>value</span> <span>of</span> <span>a</span> <span>criteria</span> <span>(&nbsp;Maximize</span> <span>CPU</span> <span>utilization</span> <span>and</span> <span>throughput,</span> <span>and</span> <span>minimize</span> <span>all</span> <span>the</span> <span>others</span>.<span>&nbsp;)</span> <span>However</span> <span>some</span> <span>times</span> <span>one</span> <span>wants</span> <span>to</span> <span>do</span> <span>something</span> <span>different,</span> <span>such</span> <span>as</span> <span>to</span> <span>minimize</span> <span>the</span> <span>maximum</span> <span>response</span> <span>time</span>.</li>
  <li><span>Sometimes</span> <span>it</span> <span>is</span> <span>most</span> <span>desirable</span> <span>to</span> <span>minimize</span> <span>the</span> <span></span><em><span></span><strong><span>variance</span></strong><span></span></em><span></span> <span>of</span> <span>a</span> <span>criteria</span> <span>than</span> <span>the</span> <span>actual</span> <span>value</span>.<span></span> <span>I</span>.<span>e</span>.<span></span> <span>users</span> <span>are</span> <span>more</span> <span>accepting</span> <span>of</span> <span>a</span> <span>consistent</span> <span>predictable</span> <span>system</span> <span>than</span> <span>an</span> <span>inconsistent</span> <span>one,</span> <span>even</span> <span>if</span> <span>it</span> <span>is</span> <span>a</span> <span>little</span> <span>bit</span> <span>slower</span>.<span></span> </li>
</ul>
<h3><span>6</span>.<span>3</span> <span>Scheduling</span> <span>Algorithms</span> </h3>
<blockquote>
  <p><span>The</span> <span>following</span> <span>subsections</span> <span>will</span> <span>explain</span> <span>several</span> <span>common</span> <span>scheduling</span> <span>strategies,</span> <span>looking</span> <span>at</span> <span>only</span> <span>a</span> <span>single</span> <span>CPU</span> <span>burst</span> <span>each</span> <span>for</span> <span>a</span> <span>small</span> <span>number</span> <span>of</span> <span>processes</span>.<span></span> <span>Obviously</span> <span>real</span> <span>systems</span> <span>have</span> <span>to</span> <span>deal</span> <span>with</span> <span>a</span> <span>lot</span> <span>more</span> <span>simultaneous</span> <span>processes</span> <span>executing</span> <span>their</span> <span>CPU-I/O</span> <span>burst</span> <span>cycles</span>.<span></span> </p>
  <h4><span>6</span>.<span>3</span>.<span>1</span> <span>First-Come</span> <span>First-Serve</span> <span>Scheduling,</span> </h4>
  <ul>
    <li><span>FCFS</span> <span>is</span> <span>very</span> <span>simple</span> <span>-</span> <span>Just</span> <span>a</span> <span>FIFO</span> <span>queue,</span> <span>like</span> <span>customers</span> <span>waiting</span> <span>in</span> <span>line</span> <span>at</span> <span>the</span> <span>bank</span> <span>or</span> <span>the</span> <span>post</span> <span>office</span> <span>or</span> <span>at</span> <span>a</span> <span>copying</span> <span>machine</span>.</li>
    <li><span>Unfortunately,</span> <span>however,</span> <span>FCFS</span> <span>can</span> <span>yield</span> <span>some</span> <span>very</span> <span>long</span> <span>average</span> <span>wait</span> <span>times,</span> <span>particularly</span> <span>if</span> <span>the</span> <span>first</span> <span>process</span> <span>to</span> <span>get</span> <span>there</span> <span>takes</span> <span>a</span> <span>long</span> <span>time</span>.<span></span> <span>For</span> <span>example,</span> <span>consider</span> <span>the</span> <span>following</span> <span>three</span> </li>
  </ul>
  <blockquote><center>
    <table width="400" border="1" cellspacing="5" cellpadding="2">
      <tbody><tr>
        <th scope="col">Process</th>
        <th scope="col">Burst Time </th>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P1</span></div></td>
        <td><span></span><div align="center"><span>24</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P2</span></div></td>
        <td><span></span><div align="center"><span>3</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P3</span></div></td>
        <td><span></span><div align="center"><span>3</span></div></td>
      </tr>
    </tbody></table>
	</center>
  </blockquote>
  <ul>
    <li><span>In</span> <span>the</span> <span>first</span> <span>Gantt</span> <span>chart</span> <span>below,</span> <span>process</span> <span>P1</span> <span>arrives</span> <span>first</span>.<span></span> <span>The</span> <span>average</span> <span>waiting</span> <span>time</span> <span>for</span> <span>the</span> <span>three</span> <span>processes</span> <span>is</span> <span>(</span> <span>0</span> <span>+</span> <span>24</span> <span>+</span> <span>27</span> <span></span> <span>)</span> <span>/</span> <span>3</span> <span>=</span> <span>17</span>.<span>0</span> <span>ms</span>.</li>
    <li><span>In</span> <span>the</span> <span>second</span> <span>Gantt</span> <span>chart</span> <span>below,</span> <span>the</span> <span>same</span> <span>three</span> <span>processes</span> <span>have</span> <span>an</span> <span>average</span> <span>wait</span> <span>time</span> <span>of</span> <span>(</span> <span>0</span> <span>+</span> <span>3</span> <span>+</span> <span>6</span> <span>)</span> <span>/</span> <span>3</span> <span>=</span> <span>3</span>.<span>0</span> <span>ms</span>.<span></span> <span>The</span> <span>total</span> <span>run</span> <span>time</span> <span>for</span> <span>the</span> <span>three</span> <span>bursts</span> <span>is</span> <span>the</span> <span>same,</span> <span>but</span> <span>in</span> <span>the</span> <span>second</span> <span>case</span> <span>two</span> <span>of</span> <span>the</span> <span>three</span> <span>finish</span> <span>much</span> <span>quicker,</span> <span>and</span> <span>the</span> <span>other</span> <span>process</span> <span>is</span> <span>only</span> <span>delayed</span> <span>by</span> <span>a</span> <span>short</span> <span>amount</span>.<span></span> <span></span> </li>
  </ul>
  <blockquote>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_FCFS_Chart1.jpg" width="710" height="83"></p>
<p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_FCFS_Chart2.jpg" width="710" height="83"></p>
  </blockquote>
  <ul>
    <li><span>FCFS</span> <span>can</span> <span>also</span> <span>block</span> <span>the</span> <span>system</span> <span>in</span> <span>a</span> <span>busy</span> <span>dynamic</span> <span>system</span> <span>in</span> <span>another</span> <span>way,</span> <span>known</span> <span>as</span> <span>the</span> <span></span><em><span></span><strong><span>convoy</span> <span>effect</span></strong><span></span></em><span></span>.<span></span> <span>When</span> <span>one</span> <span>CPU</span> <span>intensive</span> <span>process</span> <span>blocks</span> <span>the</span> <span>CPU,</span> <span>a</span> <span>number</span> <span>of</span> <span>I/O</span> <span>intensive</span> <span>processes</span> <span>can</span> <span>get</span> <span>backed</span> <span>up</span> <span>behind</span> <span>it,</span> <span>leaving</span> <span>the</span> <span>I/O</span> <span>devices</span> <span>idle</span>.<span></span> <span>When</span> <span>the</span> <span>CPU</span> <span>hog</span> <span>finally</span> <span>relinquishes</span> <span>the</span> <span>CPU,</span> <span>then</span> <span>the</span> <span>I/O</span> <span>processes</span> <span>pass</span> <span>through</span> <span>the</span> <span>CPU</span> <span>quickly,</span> <span>leaving</span> <span>the</span> <span>CPU</span> <span>idle</span> <span>while</span> <span>everyone</span> <span>queues</span> <span>up</span> <span>for</span> <span>I/O,</span> <span>and</span> <span>then</span> <span>the</span> <span>cycle</span> <span>repeats</span> <span>itself</span> <span>when</span> <span>the</span> <span>CPU</span> <span>intensive</span> <span>process</span> <span>gets</span> <span>back</span> <span>to</span> <span>the</span> <span>ready</span> <span>queue</span>.<span></span> <span></span> </li>
  </ul>
  <h4><span>6</span>.<span>3</span>.<span>2</span> <span>Shortest-Job-First</span> <span>Scheduling,</span> <span>SJF</span> </h4>
  <ul>
    <li><span>The</span> <span>idea</span> <span>behind</span> <span>the</span> <span>SJF</span> <span>algorithm</span> <span>is</span> <span>to</span> <span>pick</span> <span>the</span> <span>quickest</span> <span>fastest</span> <span>little</span> <span>job</span> <span>that</span> <span>needs</span> <span>to</span> <span>be</span> <span>done,</span> <span>get</span> <span>it</span> <span>out</span> <span>of</span> <span>the</span> <span>way</span> <span>first,</span> <span>and</span> <span>then</span> <span>pick</span> <span>the</span> <span>next</span> <span>smallest</span> <span>fastest</span> <span>job</span> <span>to</span> <span>do</span> <span>next</span>.</li>
    <li><span>(</span> <span>Technically</span> <span>this</span> <span>algorithm</span> <span>picks</span> <span>a</span> <span>process</span> <span>based</span> <span>on</span> <span>the</span> <span>next</span> <span>shortest</span><strong><span></span> <span>CPU</span> <span>burst</span></strong><span>,</span> <span>not</span> <span>the</span> <span>overall</span> <span>process</span> <span>time</span>.</li>
    <li><span>For</span> <span>example,</span> <span>the</span> <span>Gantt</span> <span>chart</span> <span>below</span> <span>is</span> <span>based</span> <span>upon</span> <span>the</span> <span>following</span> <span>CPU</span> <span>burst</span> <span>times,</span> <span>(&nbsp;and</span> <span>the</span> <span>assumption</span> <span>that</span> <span>all</span> <span>jobs</span> <span>arrive</span> <span>at</span> <span>the</span> <span>same</span> <span>time</span>.</li>
  </ul>
  <blockquote>
  <center>
    <table width="400" border="1" cellspacing="5" cellpadding="2">
      <tbody><tr>
        <th scope="col">Process</th>
        <th scope="col">Burst Time </th>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P1</span></div></td>
        <td><span></span><div align="center"><span>6</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P2</span></div></td>
        <td><span></span><div align="center"><span>8</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P3</span></div></td>
        <td><span></span><div align="center"><span>7</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P4</span></div></td>
        <td><span></span><div align="center"><span>3</span></div></td>
      </tr>
    </tbody></table>
	</center>
  </blockquote>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_SJF_Chart.jpg" width="710" height="83"></p>
  <ul>
    <li><span>In</span> <span>the</span> <span>case</span> <span>above</span> <span>the</span> <span>average</span> <span>wait</span> <span>time</span> <span>is</span> <span>(</span> <span>0</span> <span>+</span> <span>3</span> <span>+</span> <span>9</span> <span>+</span> <span>16</span> <span>)</span> <span>/</span> <span>4</span> <span>=</span> <span>7</span>.<span>0</span> <span>ms,</span> <span>(</span> <span>as</span> <span>opposed</span> <span>to</span> <span>10</span>.<span>25</span> <span>ms</span> <span>for</span> <span>FCFS</span> <span>for</span> <span>the</span> <span>same</span> <span>processes</span>.<span></span> <span>)</span> </li>
    <li><span>SJF</span> <span>can</span> <span>be</span> <span>proven</span> <span>to</span> <span>be</span> <span>the</span> <span>fastest</span> <span>scheduling</span> <span>algorithm,</span> <span>but</span> <span>it</span> <span>suffers</span> <span>from</span> <span>one</span> <span>important</span> <span>problem:</span> <span>How</span> <span>do</span> <span>you</span> <span>know</span> <span>how</span> <span>long</span> <span>the</span> <span>next</span> <span>CPU</span> <span>burst</span> <span>is</span> <span>going</span> <span>to</span> <span>be?
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>For</span> <span>long-term</span> <span>batch</span> <span>jobs</span> <span>this</span> <span>can</span> <span>be</span> <span>done</span> <span>based</span> <span>upon</span> <span>the</span> <span>limits</span> <span>that</span> <span>users</span> <span>set</span> <span>for</span> <span>their</span> <span>jobs</span> <span>when</span> <span>they</span> <span>submit</span> <span>them,</span> <span>which</span> <span>encourages</span> <span>them</span> <span>to</span> <span>set</span> <span>low</span> <span>limits,</span> <span>but</span> <span>risks</span> <span>their</span> <span>having</span> <span>to</span> <span>re-submit</span> <span>the</span> <span>job</span> <span>if</span> <span>they</span> <span>set</span> <span>the</span> <span>limit</span> <span>too</span> <span>low</span>.<span></span> <span>However</span> <span>that</span> <span>does</span> <span>not</span> <span>work</span> <span>for</span> <span>short-term</span> <span>CPU</span> <span>scheduling</span> <span>on</span> <span>an</span> <span>interactive</span> <span>system</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Another</span> <span>option</span> <span>would</span> <span>be</span> <span>to</span> <span>statistically</span> <span>measure</span> <span>the</span> <span>run</span> <span>time</span> <span>characteristics</span> <span>of</span> <span>jobs,</span> <span>particularly</span> <span>if</span> <span>the</span> <span>same</span> <span>tasks</span> <span>are</span> <span>run</span> <span>repeatedly</span> <span>and</span> <span>predictably</span>.<span></span> <span>But</span> <span>once</span> <span>again</span> <span>that</span> <span>really</span> <span>isn't</span> <span>a</span> <span>viable</span> <span>option</span> <span>for</span> <span>short</span> <span>term</span> <span>CPU</span> <span>scheduling</span> <span>in</span> <span>the</span> <span>real</span> <span>world</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>A</span> <span>more</span> <span>practical</span> <span>approach</span> <span>is</span> <span>to</span> <span></span><em><span></span><strong><span>predict</span></strong><span></span></em><span></span> <span>the</span> <span>length</span> <span>of</span> <span>the</span> <span>next</span> <span>burst,</span> <span>based</span> <span>on</span> <span>some</span> <span>historical</span> <span>measurement</span> <span>of</span> <span>recent</span> <span>burst</span> <span>times</span> <span>for</span> <span>this</span> <span>process</span>.<span></span> <span>One</span> <span>simple,</span> <span>fast,</span> <span>and</span> <span>relatively</span> <span>accurate</span> <span>method</span> <span>is</span> <span>the</span> <span></span><em><span></span><strong><span>exponential</span> <span>average</span></strong><span></span></em><span>,</span> <span>which</span> <span>can</span> <span>be</span> <span>defined</span> <span>as</span> <span>follows</span>.<span></span> <span>(</span> <span>The</span> <span>book</span> <span>uses</span> <span>tau</span> <span>and</span> <span>t</span> <span>for</span> <span>their</span> <span>variables,</span> <span>but</span> <span>those</span> <span>are</span> <span>hard</span> <span>to</span> <span>distinguish</span> <span>from</span> <span>one</span> <span>another</span> <span>and</span> <span>don't</span> <span>work</span> <span>well</span> <span>in</span> <span>HTML</span>.<span></span> <span>)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><blockquote><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><p align="center"><span>estimate[</span> <span>i</span> <span>+</span> <span>1</span> <span>]</span> <span>=</span> <span>alpha</span> <span>*</span> <span>burst[</span> <span>i</span> <span>]</span> <span>+</span> <span>(</span> <span>1</span>.<span>0</span> <span>-</span> <span>alpha</span> <span>)</span> <span>*</span> <span>estimate[</span> <span>i</span> <span>]</span></p><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></blockquote><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>In</span> <span>this</span> <span>scheme</span> <span>the</span> <span>previous</span> <span>estimate</span> <span>contains</span> <span>the</span> <span>history</span> <span>of</span> <span>all</span> <span>previous</span> <span>times,</span> <span>and</span> <span>alpha</span> <span>serves</span> <span>as</span> <span>a</span> <span>weighting</span> <span>factor</span> <span>for</span> <span>the</span> <span>relative</span> <span>importance</span> <span>of</span> <span>recent</span> <span>data</span> <span>versus</span> <span>past</span> <span>history</span>.<span></span> <span>If</span> <span>alpha</span> <span>is</span> <span>1</span>.<span>0,</span> <span>then</span> <span>past</span> <span>history</span> <span>is</span> <span>ignored,</span> <span>and</span> <span>we</span> <span>assume</span> <span>the</span> <span>next</span> <span>burst</span> <span>will</span> <span>be</span> <span>the</span> <span>same</span> <span>length</span> <span>as</span> <span>the</span> <span>last</span> <span>burst</span>.<span></span> <span>If</span> <span>alpha</span> <span>is</span> <span>0</span>.<span>0,</span> <span>then</span> <span>all</span> <span>measured</span> <span>burst</span> <span>times</span> <span>are</span> <span>ignored,</span> <span>and</span> <span>we</span> <span>just</span> <span>assume</span> <span>a</span> <span>constant</span> <span>burst</span> <span>time</span>.<span></span> <span>Most</span> <span>commonly</span> <span>alpha</span> <span>is</span> <span>set</span> <span>at</span> <span>0</span>.<span>5,</span> <span>as</span> <span>illustrated</span> <span>in</span> <span>Figure</span> <span>5</span>.<span>3:</span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_03_BurstPrediction.jpg" width="639" height="463"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>3</span> <span>-</span> <span>Prediction</span> <span>of</span> <span>the</span> <span>length</span> <span>of</span> <span>the</span> <span>next</span> <span>CPU</span> <span>burst</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <li><span>SJF</span> <span>can</span> <span>be</span> <span>either</span> <span>preemptive</span> <span>or</span> <span>non-preemptive</span>.<span></span> <span>Preemption</span> <span>occurs</span> <span>when</span> <span>a</span> <span>new</span> <span>process</span> <span>arrives</span> <span>in</span> <span>the</span> <span>ready</span> <span>queue</span> <span>that</span> <span>has</span> <span>a</span> <span>predicted</span> <span>burst</span> <span>time</span> <span>shorter</span> <span>than</span> <span>the</span> <span>time</span> <span>remaining</span> <span>in</span> <span>the</span> <span>process</span> <span>whose</span> <span>burst</span> <span>is</span> <span>currently</span> <span>on</span> <span>the</span> <span>CPU</span>.<span></span> <span>Preemptive</span> <span>SJF</span> <span>is</span> <span>sometimes</span> <span>referred</span> <span>to</span> <span>as</span> <span></span><em><span></span><strong><span>shortest</span> <span>remaining</span> <span>time</span> <span>first</span> <span>scheduling</span>.<span></span></strong><span></span></em></li>
    <li><span>For</span> <span>example,</span> <span>the</span> <span>following</span> <span>Gantt</span> <span>chart</span> <span>is</span> <span>based</span> <span>upon</span> <span>the</span> <span>following</span> </li>
  </ul>
  <blockquote>
  <center>
    <table width="400" border="1" cellspacing="5" cellpadding="2">
      <tbody><tr>
        <th scope="col">Process</th>
        <th scope="col">Arrival Time </th>
        <th scope="col">Burst Time </th>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P1</span></div></td>
        <td><span></span><div align="center"><span>0</span></div></td>
        <td><span></span><div align="center"><span>8</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P2</span></div></td>
        <td><span></span><div align="center"><span>1</span></div></td>
        <td><span></span><div align="center"><span>4</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P3</span></div></td>
        <td><span></span><div align="center"><span>2</span></div></td>
        <td><span></span><div align="center"><span>9</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>p4</span></div></td>
        <td><span></span><div align="center"><span>3</span></div></td>
        <td><span></span><div align="center"><span>5</span></div></td>
      </tr>
    </tbody></table>
	</center>
    <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_PreemptiveSJF_Chart.jpg" width="711" height="83"></p>
  </blockquote>
  <ul>
    <li><span>The</span> <span>average</span> <span>wait</span> <span>time</span> <span>in</span> <span>this</span> <span>case</span> <span>is</span> <span>(</span> <span>(</span> <span>5</span> <span>-</span> <span>3</span> <span>)</span> <span>+</span> <span>(</span> <span>10</span> <span>-</span> <span>1</span> <span>)</span> <span>+</span> <span>(</span> <span>17</span> <span>-</span> <span>2</span> <span>)</span> <span>)</span> <span>/</span> <span>4</span> <span>=</span> <span>26</span> <span>/</span> <span>4</span> <span>=</span> <span>6</span>.<span>5</span> <span>ms</span>.<span></span> <span>(</span> <span>As</span> <span>opposed</span> <span>to</span> <span>7</span>.<span>75</span> <span>ms</span> <span>for</span> <span>non-preemptive</span> <span>SJF</span> <span>or</span> <span>8</span>.<span>75</span> <span>for</span> <span>FCFS</span>.<span></span> <span>)</span> </li>
  </ul>
  <h4><span>6</span>.<span>3</span>.<span>3</span> <span>Priority</span> </h4>
  <ul>
    <li><span>Priority</span> <span>scheduling</span> <span>is</span> <span>a</span> <span>more</span> <span>general</span> <span>case</span> <span>of</span> <span>SJF,</span> <span>in</span> <span>which</span> <span>each</span> <span>job</span> <span>is</span> <span>assigned</span> <span>a</span> <span>priority</span> <span>and</span> <span>the</span> <span>job</span> <span>with</span> <span>the</span> <span>highest</span> <span>priority</span> <span>gets</span> <span>scheduled</span> <span>first</span>.<span></span> <span>(&nbsp;SJF</span> <span>uses</span> <span>the</span> <span>inverse</span> <span>of</span> <span>the</span> <span>next</span> <span>expected</span> <span>burst</span> <span>time</span> <span>as</span> <span>its</span> <span>priority</span> <span>-</span> <span>The</span> <span>smaller</span> <span>the</span> <span>expected</span> <span>burst,</span> <span>the</span> <span>higher</span> <span>the</span> <span>priority</span>.<span></span> </li>
    <li><span>Note</span> <span>that</span> <span>in</span> <span>practice,</span> <span>priorities</span> <span>are</span> <span>implemented</span> <span>using</span> <span>integers</span> <span>within</span> <span>a</span> <span>fixed</span> <span>range,</span> <span>but</span> <span>there</span> <span>is</span> <span>no</span> <span>agreed-upon</span> <span>convention</span> <span>as</span> <span>to</span> <span>whether</span> <span>"high"</span> <span>priorities</span> <span>use</span> <span>large</span> <span>numbers</span> <span>or</span> <span>small</span> <span>numbers</span>.<span></span> <span>This</span> <span>book</span> <span>uses</span> <span>low</span> <span>number</span> <span>for</span> <span>high</span> <span>priorities,</span> <span>with</span> <span>0</span> <span>being</span> <span>the</span> <span>highest</span> <span>possible</span> <span>priority</span>.</li>
    <li><span>For</span> <span>example,</span> <span>the</span> <span>following</span> <span>Gantt</span> <span>chart</span> <span>is</span> <span>based</span> <span>upon</span> <span>these</span> <span>process</span> <span>burst</span> <span>times</span> <span>and</span> <span>priorities,</span> <span>and</span> <span>yields</span> <span>an</span> <span>average</span> <span>waiting</span> <span>time</span> <span>of</span> <span>8</span>.<span>2</span> </li>
  </ul>
  <blockquote>
  <center>
    <table width="400" border="1" cellspacing="5" cellpadding="2">
      <tbody><tr>
        <th scope="col">Process</th>
        <th scope="col">Burst Time </th>
        <th scope="col">Priority</th>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P1</span></div></td>
        <td><span></span><div align="center"><span>10</span></div></td>
        <td><span></span><div align="center"><span>3</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P2</span></div></td>
        <td><span></span><div align="center"><span>1</span></div></td>
        <td><span></span><div align="center"><span>1</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P3</span></div></td>
        <td><span></span><div align="center"><span>2</span></div></td>
        <td><span></span><div align="center"><span>4</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P4</span></div></td>
        <td><span></span><div align="center"><span>1</span></div></td>
        <td><span></span><div align="center"><span>5</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P5</span></div></td>
        <td><span></span><div align="center"><span>5</span></div></td>
        <td><span></span><div align="center"><span>2</span></div></td>
      </tr>
    </tbody></table>
	</center>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_PriorityChart.jpg" width="711" height="83"></p>
  </blockquote>
  <ul>
    <li><span>Priorities</span> <span>can</span> <span>be</span> <span>assigned</span> <span>either</span> <span>internally</span> <span>or</span> <span>externally</span>.<span></span> <span>Internal</span> <span>priorities</span> <span>are</span> <span>assigned</span> <span>by</span> <span>the</span> <span>OS</span> <span>using</span> <span>criteria</span> <span>such</span> <span>as</span> <span>average</span> <span>burst</span> <span>time,</span> <span>ratio</span> <span>of</span> <span>CPU</span> <span>to</span> <span>I/O</span> <span>activity,</span> <span>system</span> <span>resource</span> <span>use,</span> <span>and</span> <span>other</span> <span>factors</span> <span>available</span> <span>to</span> <span>the</span> <span>kernel</span>.<span></span> <span>External</span> <span>priorities</span> <span>are</span> <span>assigned</span> <span>by</span> <span>users,</span> <span>based</span> <span>on</span> <span>the</span> <span>importance</span> <span>of</span> <span>the</span> <span>job,</span> <span>fees</span> <span>paid,</span> <span>politics,</span> <span>etc</span>.<span></span> </li>
    <li><span>Priority</span> <span>scheduling</span> <span>can</span> <span>be</span> <span>either</span> <span>preemptive</span> <span>or</span> <span>non-preemptive</span>.</li>
    <li><span>Priority</span> <span>scheduling</span> <span>can</span> <span>suffer</span> <span>from</span> <span>a</span> <span>major</span> <span>problem</span> <span>known</span> <span>as</span> <span></span><em><span></span><strong><span>indefinite</span> <span>blocking</span></strong><span></span></em><span>,</span> <span>or</span> <span></span><em><span></span><strong><span>starvation</span></strong><span></span></em><span>,</span> <span>in</span> <span>which</span> <span>a</span> <span>low-priority</span> <span>task</span> <span>can</span> <span>wait</span> <span>forever</span> <span>because</span> <span>there</span> <span>are</span> <span>always</span> <span>some</span> <span>other</span> <span>jobs</span> <span>around</span> <span>that</span> <span>have</span> <span>higher</span> <span>priority</span>.<span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>If</span> <span>this</span> <span>problem</span> <span>is</span> <span>allowed</span> <span>to</span> <span>occur,</span> <span>then</span> <span>processes</span> <span>will</span> <span>either</span> <span>run</span> <span>eventually</span> <span>when</span> <span>the</span> <span>system</span> <span>load</span> <span>lightens</span> <span>(</span> <span>at</span> <span>say</span> <span>2:00</span> <span>a</span>.<span>m</span>.<span></span> <span>),</span> <span>or</span> <span>will</span> <span>eventually</span> <span>get</span> <span>lost</span> <span>when</span> <span>the</span> <span>system</span> <span>is</span> <span>shut</span> <span>down</span> <span>or</span> <span>crashes</span>.<span></span> <span>(&nbsp;There</span> <span>are</span> <span>rumors</span> <span>of</span> <span>jobs</span> <span>that</span> <span>have</span> <span>been</span> <span>stuck</span> <span>for</span> <span>years</span>.<span></span> <span>)</span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>One</span> <span>common</span> <span>solution</span> <span>to</span> <span>this</span> <span>problem</span> <span>is</span> <span></span><em><span></span><strong><span>aging</span></strong><span></span></em><span>,</span> <span>in</span> <span>which</span> <span>priorities</span> <span>of</span> <span>jobs</span> <span>increase</span> <span>the</span> <span>longer</span> <span>they</span> <span>wait</span>.<span></span> <span>Under</span> <span>this</span> <span>scheme</span> <span>a</span> <span>low-priority</span> <span>job</span> <span>will</span> <span>eventually</span> <span>get</span> <span>its</span> <span>priority</span> <span>raised</span> <span>high</span> <span>enough</span> <span>that</span> <span>it</span> <span>gets</span> <span>run</span>.<span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <h4><span>6</span>.<span>3</span>.<span>4</span> <span>Round</span> <span>Robin</span> </h4>
  <ul>
    <li><span>Round</span> <span>robin</span> <span>scheduling</span> <span>is</span> <span>similar</span> <span>to</span> <span>FCFS</span> <span>scheduling,</span> <span>except</span> <span>that</span> <span>CPU</span> <span>bursts</span> <span>are</span> <span>assigned</span> <span>with</span> <span>limits</span> <span>called</span> <span></span><em><span></span><strong><span>time</span> <span>quantum</span></strong><span></span></em><span></span>.</li>
    <li><span>When</span> <span>a</span> <span>process</span> <span>is</span> <span>given</span> <span>the</span> <span>CPU,</span> <span>a</span> <span>timer</span> <span>is</span> <span>set</span> <span>for</span> <span>whatever</span> <span>value</span> <span>has</span> <span>been</span> <span>set</span> <span>for</span> <span>a</span> <span>time</span> <span>quantum</span>.<span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>If</span> <span>the</span> <span>process</span> <span>finishes</span> <span>its</span> <span>burst</span> <span>before</span> <span>the</span> <span>time</span> <span>quantum</span> <span>timer</span> <span>expires,</span> <span>then</span> <span>it</span> <span>is</span> <span>swapped</span> <span>out</span> <span>of</span> <span>the</span> <span>CPU</span> <span>just</span> <span>like</span> <span>the</span> <span>normal</span> <span>FCFS</span> <span>algorithm</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>If</span> <span>the</span> <span>timer</span> <span>goes</span> <span>off</span> <span>first,</span> <span>then</span> <span>the</span> <span>process</span> <span>is</span> <span>swapped</span> <span>out</span> <span>of</span> <span>the</span> <span>CPU</span> <span>and</span> <span>moved</span> <span>to</span> <span>the</span> <span>back</span> <span>end</span> <span>of</span> <span>the</span> <span>ready</span> <span>queue</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>The</span> <span>ready</span> <span>queue</span> <span>is</span> <span>maintained</span> <span>as</span> <span>a</span> <span>circular</span> <span>queue,</span> <span>so</span> <span>when</span> <span>all</span> <span>processes</span> <span>have</span> <span>had</span> <span>a</span> <span>turn,</span> <span>then</span> <span>the</span> <span>scheduler</span> <span>gives</span> <span>the</span> <span>first</span> <span>process</span> <span>another</span> <span>turn,</span> <span>and</span> <span>so</span> <span>on</span>.</li>
    <li><span>RR</span> <span>scheduling</span> <span>can</span> <span>give</span> <span>the</span> <span>effect</span> <span>of</span> <span>all</span> <span>processors</span> <span>sharing</span> <span>the</span> <span>CPU</span> <span>equally,</span> <span>although</span> <span>the</span> <span>average</span> <span>wait</span> <span>time</span> <span>can</span> <span>be</span> <span>longer</span> <span>than</span> <span>with</span> <span>other</span> <span>scheduling</span> <span>algorithms</span>.<span></span> <span>In</span> <span>the</span> <span>following</span> <span>example</span> <span>the</span> <span>average</span> <span>wait</span> <span>time</span> <span>is</span> <span>5</span>.<span>66</span> <span>ms</span>.</li>
  </ul>
  <blockquote>
  <center>
    <table width="400" border="1" cellspacing="5" cellpadding="2">
      <tbody><tr>
        <th scope="col">Process</th>
        <th scope="col">Burst Time </th>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P1</span></div></td>
        <td><span></span><div align="center"><span>24</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P2</span></div></td>
        <td><span></span><div align="center"><span>3</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P3</span></div></td>
        <td><span></span><div align="center"><span>3</span></div></td>
      </tr>
    </tbody></table>
	</center>
  </blockquote>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_RoundRobinChart.jpg" width="730" height="87"></p>
  <ul>
    <li><span>The</span> <span>performance</span> <span>of</span> <span>RR</span> <span>is</span> <span>sensitive</span> <span>to</span> <span>the</span> <span>time</span> <span>quantum</span> <span>selected</span>.<span></span> <span>If</span> <span>the</span> <span>quantum</span> <span>is</span> <span>large</span> <span>enough,</span> <span>then</span> <span>RR</span> <span>reduces</span> <span>to</span> <span>the</span> <span>FCFS</span> <span>algorithm;</span> <span>If</span> <span>it</span> <span>is</span> <span>very</span> <span>small,</span> <span>then</span> <span>each</span> <span>process</span> <span>gets</span> <span>1/nth</span> <span>of</span> <span>the</span> <span>processor</span> <span>time</span> <span>and</span> <span>share</span> <span>the</span> <span>CPU</span> <span>equally</span>.</li>
    <li><span></span><strong><span>BUT</span></strong><span>,</span> <span>a</span> <span>real</span> <span>system</span> <span>invokes</span> <span>overhead</span> <span>for</span> <span>every</span> <span>context</span> <span>switch,</span> <span>and</span> <span>the</span> <span>smaller</span> <span>the</span> <span>time</span> <span>quantum</span> <span>the</span> <span>more</span> <span>context</span> <span>switches</span> <span>there</span> <span>are</span>.<span></span> <span>(</span> <span>See</span> <span>Figure</span> <span>6</span>.<span>4</span> <span>below</span>.<span></span> <span>)</span> <span>Most</span> <span>modern</span> <span>systems</span> <span>use</span> <span>time</span> <span>quantum</span> <span>between</span> <span>10</span> <span>and</span> <span>100</span> <span>milliseconds,</span> <span>and</span> <span>context</span> <span>switch</span> <span>times</span> <span>on</span> <span>the</span> <span>order</span> <span>of</span> <span>10</span> <span>microseconds,</span> <span>so</span> <span>the</span> <span>overhead</span> <span>is</span> <span>small</span> <span>relative</span> <span>to</span> <span>the</span> <span>time</span> <span>quantum</span>.<span></span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_04_quantums.jpg" width="670" height="282"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>4</span> <span>-</span> <span>The</span> <span>way</span> <span>in</span> <span>which</span> <span>a</span> <span>smaller</span> <span>time</span> <span>quantum</span> <span>increases</span> <span>context</span> <span>switches</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <li><span>Turn</span> <span>around</span> <span>time</span> <span>also</span> <span>varies</span> <span>with</span> <span>quantum</span> <span>time,</span> <span>in</span> <span>a</span> <span>non-apparent</span> <span>manner</span>.<span></span> <span>Consider,</span> <span>for</span> <span>example</span> <span>the</span> <span>processes</span> <span>shown</span> <span>in</span> <span>Figure</span> <span>6</span>.<span>5:</span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_05_TurnaroundTime.jpg" width="592" height="490"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>5</span> <span>-</span> <span>The</span> <span>way</span> <span>in</span> <span>which</span> <span>turnaround</span> <span>time</span> <span>varies</span> <span>with</span> <span>the</span> <span>time</span> <span>quantum</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <li><span>In</span> <span>general,</span> <span>turnaround</span> <span>time</span> <span>is</span> <span>minimized</span> <span>if</span> <span>most</span> <span>processes</span> <span>finish</span> <span>their</span> <span>next</span> <span>cpu</span> <span>burst</span> <span>within</span> <span>one</span> <span>time</span> <span>quantum</span>.<span></span> <span>For</span> <span>example,</span> <span>with</span> <span>three</span> <span>processes</span> <span>of</span> <span>10</span> <span>ms</span> <span>bursts</span> <span>each,</span> <span>the</span> <span>average</span> <span>turnaround</span> <span>time</span> <span>for</span> <span>1</span> <span>ms</span> <span>quantum</span> <span>is</span> <span>29,</span> <span>and</span> <span>for</span> <span>10</span> <span>ms</span> <span>quantum</span> <span>it</span> <span>reduces</span> <span>to</span> <span>20</span>.<span></span> <span>However,</span> <span>if</span> <span>it</span> <span>is</span> <span>made</span> <span>too</span> <span>large,</span> <span>then</span> <span>RR</span> <span>just</span> <span>degenerates</span> <span>to</span> <span>FCFS</span>.<span></span> <span>A</span> <span>rule</span> <span>of</span> <span>thumb</span> <span>is</span> <span>that</span> <span>80%</span> <span>of</span> <span>CPU</span> <span>bursts</span> <span>should</span> <span>be</span> <span>smaller</span> <span>than</span> <span>the</span> <span>time</span> <span>quantum</span>.<span></span> </li>
  </ul>
  <h4><span>6</span>.<span>3</span>.<span>5</span> <span>Multilevel</span> <span>Queue</span> </h4>
  <ul>
    <li><span>When</span> <span>processes</span> <span>can</span> <span>be</span> <span>readily</span> <span>categorized,</span> <span>then</span> <span>multiple</span> <span>separate</span> <span>queues</span> <span>can</span> <span>be</span> <span>established,</span> <span>each</span> <span>implementing</span> <span>whatever</span> <span>scheduling</span> <span>algorithm</span> <span>is</span> <span>most</span> <span>appropriate</span> <span>for</span> <span>that</span> <span>type</span> <span>of</span> <span>job,</span> <span>and/or</span> <span>with</span> <span>different</span> <span>parametric</span> <span>adjustments</span>.</li>
    <li><span>Scheduling</span> <span>must</span> <span>also</span> <span>be</span> <span>done</span> <span>between</span> <span>queues,</span> <span>that</span> <span>is</span> <span>scheduling</span> <span>one</span> <span>queue</span> <span>to</span> <span>get</span> <span>time</span> <span>relative</span> <span>to</span> <span>other</span> <span>queues</span>.<span></span> <span>Two</span> <span>common</span> <span>options</span> <span>are</span> <span>strict</span> <span>priority</span> <span>(</span> <span>no</span> <span>job</span> <span>in</span> <span>a</span> <span>lower</span> <span>priority</span> <span>queue</span> <span>runs</span> <span>until</span> <span>all</span> <span>higher</span> <span>priority</span> <span>queues</span> <span>are</span> <span>empty</span> <span>)</span> <span>and</span> <span>round-robin</span> <span>(</span> <span>each</span> <span>queue</span> <span>gets</span> <span>a</span> <span>time</span> <span>slice</span> <span>in</span> <span>turn,</span> <span>possibly</span> <span>of</span> <span>different</span> <span>sizes</span>.<span></span> <span>)</span> </li>
    <li><span>Note</span> <span>that</span> <span>under</span> <span>this</span> <span>algorithm</span> <span>jobs</span> <span>cannot</span> <span>switch</span> <span>from</span> <span>queue</span> <span>to</span> <span>queue</span> <span>-</span> <span>Once</span> <span>they</span> <span>are</span> <span>assigned</span> <span>a</span> <span>queue,</span> <span>that</span> <span>is</span> <span>their</span> <span>queue</span> <span>until</span> <span>they</span> <span>finish</span>.<span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_06_MultilevelQueueScheduling.jpg" width="648" height="429"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>6</span> <span>-</span> <span>Multilevel</span> <span>queue</span> <span>scheduling</span></strong><span>
</span> <span></span> </p>
  <h4><span>6</span>.<span>3</span>.<span>6</span> <span>Multilevel</span> <span>Feedback-Queue</span> </h4>
  <ul>
    <li><span>Multilevel</span> <span>feedback</span> <span>queue</span> <span>scheduling</span> <span>is</span> <span>similar</span> <span>to</span> <span>the</span> <span>ordinary</span> <span>multilevel</span> <span>queue</span> <span>scheduling</span> <span>described</span> <span>above,</span> <span>except</span> <span>jobs</span> <span>may</span> <span>be</span> <span>moved</span> <span>from</span> <span>one</span> <span>queue</span> <span>to</span> <span>another</span> <span>for</span> <span>a</span> <span>variety</span> <span>of</span> <span>reasons:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>If</span> <span>the</span> <span>characteristics</span> <span>of</span> <span>a</span> <span>job</span> <span>change</span> <span>between</span> <span>CPU-intensive</span> <span>and</span> <span>I/O</span> <span>intensive,</span> <span>then</span> <span>it</span> <span>may</span> <span>be</span> <span>appropriate</span> <span>to</span> <span>switch</span> <span>a</span> <span>job</span> <span>from</span> <span>one</span> <span>queue</span> <span>to</span> <span>another</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Aging</span> <span>can</span> <span>also</span> <span>be</span> <span>incorporated,</span> <span>so</span> <span>that</span> <span>a</span> <span>job</span> <span>that</span> <span>has</span> <span>waited</span> <span>for</span> <span>a</span> <span>long</span> <span>time</span> <span>can</span> <span>get</span> <span>bumped</span> <span>up</span> <span>into</span> <span>a</span> <span>higher</span> <span>priority</span> <span>queue</span> <span>for</span> <span>a</span> <span>while</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>Multilevel</span> <span>feedback</span> <span>queue</span> <span>scheduling</span> <span>is</span> <span>the</span> <span>most</span> <span>flexible,</span> <span>because</span> <span>it</span> <span>can</span> <span>be</span> <span>tuned</span> <span>for</span> <span>any</span> <span>situation</span>.<span></span> <span>But</span> <span>it</span> <span>is</span> <span>also</span> <span>the</span> <span>most</span> <span>complex</span> <span>to</span> <span>implement</span> <span>because</span> <span>of</span> <span>all</span> <span>the</span> <span>adjustable</span> <span>parameters</span>.<span></span> <span>Some</span> <span>of</span> <span>the</span> <span>parameters</span> <span>which</span> <span>define</span> <span>one</span> <span>of</span> <span>these</span> <span>systems</span> <span>include:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>The</span> <span>number</span> <span>of</span> <span>queues</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>The</span> <span>scheduling</span> <span>algorithm</span> <span>for</span> <span>each</span> <span>queue</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>The</span> <span>methods</span> <span>used</span> <span>to</span> <span>upgrade</span> <span>or</span> <span>demote</span> <span>processes</span> <span>from</span> <span>one</span> <span>queue</span> <span>to</span> <span>another</span>.<span></span> <span>(</span> <span>Which</span> <span>may</span> <span>be</span> <span>different</span>.<span></span> <span>)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>The</span> <span>method</span> <span>used</span> <span>to</span> <span>determine</span> <span>which</span> <span>queue</span> <span>a</span> <span>process</span> <span>enters</span> <span>initially</span>.<span></span> <span></span> <span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_07_MultilevelFeedbackQueues.jpg" width="476" height="289"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>7</span> <span>-</span> <span>Multilevel</span> <span>feedback</span> <span>queues</span>.<span></span></strong><span>
</span> <span></span> </p>
</blockquote>
<h3><span>6</span>.<span>4</span> <span>Thread</span> <span>Scheduling</span> </h3>
<ul>
  <li><span>The</span> <span>process</span> <span>scheduler</span> <span>schedules</span> <span>only</span> <span>the</span> <span>kernel</span> <span>threads</span>.</li>
  <li><span>User</span> <span>threads</span> <span>are</span> <span>mapped</span> <span>to</span> <span>kernel</span> <span>threads</span> <span>by</span> <span>the</span> <span>thread</span> <span>library</span> <span>-</span> <span>The</span> <span>OS</span> <span>(</span> <span>and</span> <span>in</span> <span>particular</span> <span>the</span> <span>scheduler</span> <span>)</span> <span>is</span> <span>unaware</span> <span>of</span> <span>them</span>.<span></span> </li>
</ul>
<blockquote>
  <h4><span>6</span>.<span>4</span>.<span>1</span> <span>Contention</span> </h4>
  <ul>
    <li><span></span><em><span></span><strong><span>Contention</span> <span>scope</span></strong><span></span></em><span></span> <span>refers</span> <span>to</span> <span>the</span> <span>scope</span> <span>in</span> <span>which</span> <span>threads</span> <span>compete</span> <span>for</span> <span>the</span> <span>use</span> <span>of</span> <span>physical</span> <span>CPUs</span>.<span></span> </li>
    <li><span>On</span> <span>systems</span> <span>implementing</span> <span>many-to-one</span> <span>and</span> <span>many-to-many</span> <span>threads,</span> <span></span><em><span></span><strong><span>Process</span> <span>Contention</span> <span>Scope,</span> <span>PCS,</span> <span></span></strong><span></span></em><span>occurs,</span> <span>because</span> <span>competition</span> <span></span> <span>occurs</span> <span>between</span> <span>threads</span> <span>that</span> <span>are</span> <span>part</span> <span>of</span> <span>the</span> <span>same</span> <span>process</span>.<span></span> <span></span> <span>(</span> <span>This</span> <span>is</span> <span>the</span> <span>management</span> <span>/</span> <span>scheduling</span> <span>of</span> <span>multiple</span> <span>user</span> <span>threads</span> <span>on</span> <span>a</span> <span>single</span> <span>kernel</span> <span>thread,</span> <span>and</span> <span>is</span> <span>managed</span> <span>by</span> <span>the</span> <span>thread</span> <span>library</span>.<span></span> <span>)</span> </li>
    <li><span></span><em><span></span><strong><span>System</span> <span>Contention</span> <span>Scope,</span> <span>SCS,</span> <span></span></strong><span></span></em><span></span> <span>involves</span> <span>the</span> <span>system</span> <span>scheduler</span> <span>scheduling</span> <span>kernel</span> <span>threads</span> <span>to</span> <span>run</span> <span>on</span> <span>one</span> <span>or</span> <span>more</span> <span>CPUs</span>.<span></span> <span>Systems</span> <span>implementing</span> <span>one-to-one</span> <span>threads</span> <span>(</span> <span>XP,</span> <span>Solaris</span> <span>9,</span> <span>Linux</span> <span>),</span> <span>use</span> <span>only</span> <span>SCS</span>.</li>
    <li><span>PCS</span> <span>scheduling</span> <span>is</span> <span>typically</span> <span>done</span> <span>with</span> <span>priority,</span> <span>where</span> <span>the</span> <span>programmer</span> <span>can</span> <span>set</span> <span>and/or</span> <span>change</span> <span>the</span> <span>priority</span> <span>of</span> <span>threads</span> <span>created</span> <span>by</span> <span>his</span> <span>or</span> <span>her</span> <span>programs</span>.<span></span> <span>Even</span> <span>time</span> <span>slicing</span> <span>is</span> <span>not</span> <span>guaranteed</span> <span>among</span> <span>threads</span> <span>of</span> <span>equal</span> <span>priority</span>.<span></span> </li>
  </ul>
  <h4><span>6</span>.<span>4</span>.<span>2</span> <span>Pthread</span> </h4>
  <ul>
    <li><span>The</span> <span>Pthread</span> <span>library</span> <span>provides</span> <span>for</span> <span>specifying</span> <span>scope</span> <span>contention:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>PTHREAD_SCOPE_PROCESS</span> <span>schedules</span> <span>threads</span> <span>using</span> <span>PCS,</span> <span>by</span> <span>scheduling</span> <span>user</span> <span>threads</span> <span>onto</span> <span>available</span> <span>LWPs</span> <span>using</span> <span>the</span> <span>many-to-many</span> <span>model</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>PTHREAD_SCOPE_SYSTEM</span> <span>schedules</span> <span>threads</span> <span>using</span> <span>SCS,</span> <span>by</span> <span>binding</span> <span>user</span> <span>threads</span> <span>to</span> <span>particular</span> <span>LWPs,</span> <span>effectively</span> <span>implementing</span> <span>a</span> <span>one-to-one</span> <span>model</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>getscope</span> <span>and</span> <span>setscope</span> <span>methods</span> <span>provide</span> <span>for</span> <span>determining</span> <span>and</span> <span>setting</span> <span>the</span> <span>scope</span> <span>contention</span> </li>
  </ul>
  <blockquote>
    <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_08_PThreadSchedulingAPI.jpg" width="736" height="1130"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>8</span> <span>-</span> <span>Pthread</span> <span>scheduling</span> <span>API</span>.<span></span></strong></p>
  </blockquote>
</blockquote>
<h3><span>6</span>.<span>5</span> <span>Multiple-Processor</span> <span>Scheduling</span> </h3>
<ul>
  <li><span>When</span> <span>multiple</span> <span>processors</span> <span>are</span> <span>available,</span> <span>then</span> <span>the</span> <span>scheduling</span> <span>gets</span> <span>more</span> <span>complicated,</span> <span>because</span> <span>now</span> <span>there</span> <span>is</span> <span>more</span> <span>than</span> <span>one</span> <span>CPU</span> <span>which</span> <span>must</span> <span>be</span> <span>kept</span> <span>busy</span> <span>and</span> <span>in</span> <span>effective</span> <span>use</span> <span>at</span> <span>all</span> <span>times</span>.</li>
  <li><span></span><strong><span></span><em><span>Load</span> <span>sharing</span></em><span></span></strong><span></span> <span>revolves</span> <span>around</span> <span>balancing</span> <span>the</span> <span>load</span> <span>between</span> <span>multiple</span> <span>processors</span>.</li>
  <li><span>Multi-processor</span> <span>systems</span> <span>may</span> <span>be</span> <span></span><strong><span>heterogeneous,</span> <span></span></strong><span>(</span> <span>different</span> <span>kinds</span> <span>of</span> <span>CPUs</span> <span>),</span> <span>or</span> <span></span><strong><span>homogenous,</span> <span></span></strong><span>(</span> <span>all</span> <span>the</span> <span>same</span> <span>kind</span> <span>of</span> <span>CPU</span> <span>)</span>.<span></span> <span>Even</span> <span>in</span> <span>the</span> <span>latter</span> <span>case</span> <span>there</span> <span>may</span> <span>be</span> <span>special</span> <span>scheduling</span> <span>constraints,</span> <span>such</span> <span>as</span> <span>devices</span> <span>which</span> <span>are</span> <span>connected</span> <span>via</span> <span>a</span> <span>private</span> <span>bus</span> <span>to</span> <span>only</span> <span>one</span> <span>of</span> <span>the</span> <span>CPUs</span>.<span></span> <span>This</span> <span>book</span> <span>will</span> <span>restrict</span> <span>its</span> <span>discussion</span> <span>to</span> <span>homogenous</span> <span>systems</span>.<span></span> <span></span> <span></span> <span></span> </li>
</ul>
<blockquote>
  <h4><span>6</span>.<span>5</span>.<span>1</span> <span>Approaches</span> <span>to</span> <span>Multiple-Processor</span> </h4>
  <ul>
    <li><span>One</span> <span>approach</span> <span>to</span> <span>multi-processor</span> <span>scheduling</span> <span>is</span> <span></span><em><span></span><strong><span>asymmetric</span> <span>multiprocessing,</span> <span></span></strong><span></span></em><span>in</span> <span>which</span> <span>one</span> <span>processor</span> <span>is</span> <span>the</span> <span>master,</span> <span>controlling</span> <span>all</span> <span>activities</span> <span>and</span> <span>running</span> <span>all</span> <span>kernel</span> <span>code,</span> <span>while</span> <span>the</span> <span>other</span> <span>runs</span> <span>only</span> <span>user</span> <span>code</span>.<span></span> <span>This</span> <span>approach</span> <span>is</span> <span>relatively</span> <span>simple,</span> <span>as</span> <span>there</span> <span>is</span> <span>no</span> <span>need</span> <span>to</span> <span>share</span> <span>critical</span> <span>system</span> <span>data</span>.</li>
    <li><span>Another</span> <span>approach</span> <span>is</span> <span></span><em><span></span><strong><span>symmetric</span> <span>multiprocessing,</span> <span>SMP,</span> <span></span></strong><span></span></em><span>where</span> <span>each</span> <span>processor</span> <span>schedules</span> <span>its</span> <span>own</span> <span>jobs,</span> <span>either</span> <span>from</span> <span>a</span> <span>common</span> <span>ready</span> <span>queue</span> <span>or</span> <span>from</span> <span>separate</span> <span>ready</span> <span>queues</span> <span>for</span> <span>each</span> <span>processor</span>.</li>
    <li><span>Virtually</span> <span>all</span> <span>modern</span> <span>OSes</span> <span>support</span> <span>SMP,</span> <span>including</span> <span>XP,</span> <span>Win</span> <span>2000,</span> <span>Solaris,</span> <span>Linux,</span> <span>and</span> <span>Mac</span> <span>OSX</span>.<span></span> <span></span> </li>
  </ul>
  <h4><span>6</span>.<span>5</span>.<span>2</span> <span>Processor</span> </h4>
  <ul>
    <li><span>Processors</span> <span>contain</span> <span>cache</span> <span>memory,</span> <span>which</span> <span>speeds</span> <span>up</span> <span>repeated</span> <span>accesses</span> <span>to</span> <span>the</span> <span>same</span> <span>memory</span> <span>locations</span>.</li>
    <li><span>If</span> <span>a</span> <span>process</span> <span>were</span> <span>to</span> <span>switch</span> <span>from</span> <span>one</span> <span>processor</span> <span>to</span> <span>another</span> <span>each</span> <span>time</span> <span>it</span> <span>got</span> <span>a</span> <span>time</span> <span>slice,</span> <span>the</span> <span>data</span> <span>in</span> <span>the</span> <span>cache</span> <span>(</span> <span>for</span> <span>that</span> <span>process</span> <span>)</span> <span>would</span> <span>have</span> <span>to</span> <span>be</span> <span>invalidated</span> <span>and</span> <span>re-loaded</span> <span>from</span> <span>main</span> <span>memory,</span> <span>thereby</span> <span>obviating</span> <span>the</span> <span>benefit</span> <span>of</span> <span>the</span> <span>cache</span>.</li>
    <li><span>Therefore</span> <span>SMP</span> <span>systems</span> <span>attempt</span> <span>to</span> <span>keep</span> <span>processes</span> <span>on</span> <span>the</span> <span>same</span> <span>processor,</span> <span>via</span> <span></span><em><span></span><strong><span>processor</span> <span>affinity</span>.<span></span></strong><span></span></em><span></span> <span></span><em><span></span><strong><span>Soft</span> <span>affinity</span></strong><span></span></em><span></span> <span>occurs</span> <span>when</span> <span>the</span> <span>system</span> <span>attempts</span> <span>to</span> <span>keep</span> <span>processes</span> <span>on</span> <span>the</span> <span>same</span> <span>processor</span> <span></span> <span></span> <span></span> <span>but</span> <span>makes</span> <span>no</span> <span>guarantees</span>.<span></span> <span>Linux</span> <span>and</span> <span>some</span> <span>other</span> <span>OSes</span> <span>support</span> <span></span><em><span></span><strong><span>hard</span> <span>affinity,</span> <span></span></strong><span></span></em><span>in</span> <span>which</span> <span>a</span> <span>process</span> <span>specifies</span> <span>that</span> <span>it</span> <span>is</span> <span>not</span> <span>to</span> <span>be</span> <span>moved</span> <span>between</span> <span>processors</span>.<span></span> </li>
    <li><span>Main</span> <span>memory</span> <span>architecture</span> <span>can</span> <span>also</span> <span>affect</span> <span>process</span> <span>affinity,</span> <span>if</span> <span>particular</span> <span>CPUs</span> <span>have</span> <span>faster</span> <span>access</span> <span>to</span> <span>memory</span> <span>on</span> <span>the</span> <span>same</span> <span>chip</span> <span>or</span> <span>board</span> <span>than</span> <span>to</span> <span>other</span> <span>memory</span> <span>loaded</span> <span>elsewhere</span>.<span></span> <span>(&nbsp;Non-Uniform</span> <span>Memory</span> <span>Access,</span> <span>NUMA</span>.<span>&nbsp;)</span> <span>As</span> <span>shown</span> <span>below,</span> <span>if</span> <span>a</span> <span>process</span> <span>has</span> <span>an</span> <span>affinity</span> <span>for</span> <span>a</span> <span>particular</span> <span>CPU,</span> <span>then</span> <span>it</span> <span>should</span> <span>preferentially</span> <span>be</span> <span>assigned</span> <span>memory</span> <span>storage</span> <span>in</span> <span>"local"</span> <span>fast</span> <span>access</span> <span>areas</span>.</li>
  </ul>
  <blockquote>
    <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_09_NUMA_CPU_Scheduling.jpg" width="612" height="327"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>9</span> <span>-</span> <span>NUMA</span> <span>and</span> <span>CPU</span> <span>scheduling</span>.<span></span></strong><span>
</span> <span></span> <span></span> <span></span> </p>
  </blockquote>
  <h4><span>6</span>.<span>5</span>.<span>3</span> <span>Load</span> </h4>
  <ul>
    <li><span>Obviously</span> <span>an</span> <span>important</span> <span>goal</span> <span>in</span> <span>a</span> <span>multiprocessor</span> <span>system</span> <span>is</span> <span>to</span> <span>balance</span> <span>the</span> <span>load</span> <span>between</span> <span>processors,</span> <span>so</span> <span>that</span> <span>one</span> <span>processor</span> <span>won't</span> <span>be</span> <span>sitting</span> <span>idle</span> <span>while</span> <span>another</span> <span>is</span> <span>overloaded</span>.</li>
    <li><span>Systems</span> <span>using</span> <span>a</span> <span>common</span> <span>ready</span> <span>queue</span> <span>are</span> <span>naturally</span> <span>self-balancing,</span> <span>and</span> <span>do</span> <span>not</span> <span>need</span> <span>any</span> <span>special</span> <span>handling</span>.<span></span> <span>Most</span> <span>systems,</span> <span>however,</span> <span>maintain</span> <span>separate</span> <span>ready</span> <span>queues</span> <span>for</span> <span>each</span> <span>processor</span>.</li>
    <li><span>Balancing</span> <span>can</span> <span>be</span> <span>achieved</span> <span>through</span> <span>either</span> <span></span><em><span></span><strong><span>push</span> <span>migration</span> <span></span></strong><span></span></em><span>or</span><em><span></span><strong><span></span> <span>pull</span> <span>migration:</span></strong><span></span></em><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span></span><em><span>Push</span> <span>migration</span> <span></span> <span></span> <span></span> <span></span></em><span></span></strong><span>involves</span> <span>a</span> <span>separate</span> <span>process</span> <span>that</span> <span>runs</span> <span>periodically,</span> <span>(</span> <span>e</span>.<span>g</span>.<span></span> <span>every</span> <span>200</span> <span>milliseconds</span> <span>),</span> <span>and</span> <span>moves</span> <span>processes</span> <span>from</span> <span>heavily</span> <span>loaded</span> <span>processors</span> <span>onto</span> <span>less</span> <span>loaded</span> <span>ones</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span></span><em><span>Pull</span> <span>migration</span></em><span></span></strong><span></span> <span>involves</span> <span>idle</span> <span>processors</span> <span>taking</span> <span>processes</span> <span>from</span> <span>the</span> <span>ready</span> <span>queues</span> <span>of</span> <span>other</span> <span>processors</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Push</span> <span>and</span> <span>pull</span> <span>migration</span> <span>are</span> <span>not</span> <span>mutually</span> <span>exclusive</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>Note</span> <span>that</span> <span>moving</span> <span>processes</span> <span>from</span> <span>processor</span> <span>to</span> <span>processor</span> <span>to</span> <span>achieve</span> <span>load</span> <span>balancing</span> <span>works</span> <span>against</span> <span>the</span> <span>principle</span> <span>of</span> <span>processor</span> <span>affinity,</span> <span>and</span> <span>if</span> <span>not</span> <span>carefully</span> <span>managed,</span> <span>the</span> <span>savings</span> <span>gained</span> <span>by</span> <span>balancing</span> <span>the</span> <span>system</span> <span>can</span> <span>be</span> <span>lost</span> <span>in</span> <span>rebuilding</span> <span>caches</span>.<span></span> <span>One</span> <span>option</span> <span>is</span> <span>to</span> <span>only</span> <span>allow</span> <span>migration</span> <span>when</span> <span>imbalance</span> <span>surpasses</span> <span>a</span> <span>given</span> <span>threshold</span>.<span></span> <span></span> <span></span> <span></span> <span></span> </li>
  </ul>
  <h4><span>6</span>.<span>5</span>.<span>4</span> <span>Multicore</span> </h4>
  <ul>
    <li><span>Traditional</span> <span>SMP</span> <span>required</span> <span>multiple</span> <span>CPU</span> <span>chips</span> <span>to</span> <span>run</span> <span>multiple</span> <span>kernel</span> <span>threads</span> <span>concurrently</span>.</li>
    <li><span>Recent</span> <span>trends</span> <span>are</span> <span>to</span> <span>put</span> <span>multiple</span> <span>CPUs</span> <span>(</span> <span>cores</span> <span>)</span> <span>onto</span> <span>a</span> <span>single</span> <span>chip,</span> <span>which</span> <span>appear</span> <span>to</span> <span>the</span> <span>system</span> <span>as</span> <span>multiple</span> <span>processors</span>.</li>
    <li><span>Compute</span> <span>cycles</span> <span>can</span> <span>be</span> <span>blocked</span> <span>by</span> <span>the</span> <span>time</span> <span>needed</span> <span>to</span> <span>access</span> <span>memory,</span> <span>whenever</span> <span>the</span> <span>needed</span> <span>data</span> <span>is</span> <span>not</span> <span>already</span> <span>present</span> <span>in</span> <span>the</span> <span>cache</span>.<span></span> <span>(</span> <span>Cache</span> <span>misses</span>.<span></span> <span>)</span> <span>In</span> <span>Figure</span> <span>5</span>.<span>10,</span> <span>as</span> <span>much</span> <span>as</span> <span>half</span> <span>of</span> <span>the</span> <span>CPU</span> <span>cycles</span> <span>are</span> <span>lost</span> <span>to</span> <span>memory</span> <span>stall</span>.</li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_10_MemoryStall.jpg" width="733" height="180"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>10</span> <span>-</span> <span>Memory</span> <span>stall</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <li><span>By</span> <span>assigning</span> <span>multiple</span> <span>kernel</span> <span>threads</span> <span>to</span> <span>a</span> <span>single</span> <span>processor,</span> <span>memory</span> <span>stall</span> <span>can</span> <span>be</span> <span>avoided</span> <span>(</span> <span>or</span> <span>reduced</span> <span>)</span> <span>by</span> <span>running</span> <span>one</span> <span>thread</span> <span>on</span> <span>the</span> <span>processor</span> <span>while</span> <span>the</span> <span>other</span> <span>thread</span> <span>waits</span> <span>for</span> <span>memory</span>.</li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_11_MultithreadedMulticore.jpg" width="737" height="180"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>11</span> <span>-</span> <span>Multithreaded</span> <span>multicore</span> <span>system</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <li><span>A</span> <span>dual-threaded</span> <span>dual-core</span> <span>system</span> <span>has</span> <span>four</span> <span>logical</span> <span>processors</span> <span>available</span> <span>to</span> <span>the</span> <span>operating</span> <span>system</span>.<span></span> <span>The</span> <span>UltraSPARC</span> <span>T1</span> <span>CPU</span> <span>has</span> <span>8</span> <span>cores</span> <span>per</span> <span>chip</span> <span>and</span> <span>4</span> <span>hardware</span> <span>threads</span> <span>per</span> <span>core,</span> <span>for</span> <span>a</span> <span>total</span> <span>of</span> <span>32</span> <span>logical</span> <span>processors</span> <span>per</span> <span>chip</span>.</li>
    <li><span>There</span> <span>are</span> <span>two</span> <span>ways</span> <span>to</span> <span>multi-thread</span> <span>a</span> <span>processor:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><em><span></span><strong><span>Coarse-grained</span> <span></span></strong><span></span></em><span></span> <span>multithreading</span> <span>switches</span> <span>between</span> <span>threads</span> <span>only</span> <span>when</span> <span>one</span> <span>thread</span> <span>blocks,</span> <span>say</span> <span>on</span> <span>a</span> <span>memory</span> <span>read</span>.<span></span> <span>Context</span> <span>switching</span> <span>is</span> <span>similar</span> <span>to</span> <span>process</span> <span>switching,</span> <span>with</span> <span>considerable</span> <span>overhead</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><em><span></span><strong><span>Fine-grained</span> <span></span></strong><span></span></em><span>multithreading</span> <span>occurs</span> <span>on</span> <span>smaller</span> <span>regular</span> <span>intervals,</span> <span>say</span> <span>on</span> <span>the</span> <span>boundary</span> <span>of</span> <span>instruction</span> <span>cycles</span>.<span></span> <span>However</span> <span>the</span> <span>architecture</span> <span>is</span> <span>designed</span> <span>to</span> <span>support</span> <span>thread</span> <span>switching,</span> <span>so</span> <span>the</span> <span>overhead</span> <span>is</span> <span>relatively</span> <span>minor</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>Note</span> <span>that</span> <span>for</span> <span>a</span> <span>multi-threaded</span> <span>multi-core</span> <span>system,</span> <span>there</span> <span>are</span> <span></span><strong><span>two</span></strong><span></span> <span>levels</span> <span>of</span> <span>scheduling,</span> <span></span><strong><span>at</span> <span>the</span> <span>kernel</span> <span>level:</span></strong><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>The</span> <span>OS</span> <span>schedules</span> <span>which</span> <span>kernel</span> <span>thread(s)</span> <span>to</span> <span>assign</span> <span>to</span> <span>which</span> <span>logical</span> <span>processors,</span> <span>and</span> <span>when</span> <span>to</span> <span>make</span> <span>context</span> <span>switches</span> <span>using</span> <span>algorithms</span> <span>as</span> <span>described</span> <span>above</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>On</span> <span>a</span> <span>lower</span> <span>level,</span> <span>the</span> <span>hardware</span> <span>schedules</span> <span>logical</span> <span>processors</span> <span>on</span> <span>each</span> <span>physical</span> <span>core</span> <span>using</span> <span>some</span> <span>other</span> <span>algorithm</span>.<span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>The</span> <span>UltraSPARC</span> <span>T1</span> <span>uses</span> <span>a</span> <span>simple</span> <span>round-robin</span> <span>method</span> <span>to</span> <span>schedule</span> <span>the</span> <span>4</span> <span>logical</span> <span>processors</span> <span>(</span> <span>kernel</span> <span>threads</span> <span>)</span> <span>on</span> <span>each</span> <span>physical</span> <span>core</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>The</span> <span>Intel</span> <span>Itanium</span> <span>is</span> <span>a</span> <span>dual-core</span> <span>chip</span> <span>which</span> <span>uses</span> <span>a</span> <span>7-level</span> <span>priority</span> <span>scheme</span> <span>(</span> <span>urgency</span> <span>)</span> <span>to</span> <span>determine</span> <span>which</span> <span>thread</span> <span>to</span> <span>schedule</span> <span>when</span> <span>one</span> <span>of</span> <span>5</span> <span>different</span> <span>events</span> <span>occurs</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <h4><span>/*</span> <span>Old</span> <span>5</span>.<span>5</span>.<span>5</span> <span>Virtualization</span> <span>and</span> <span>Scheduling</span> <span>(</span> <span>Optional,</span> <span>Omitted</span> <span>from</span> <span>9th</span> <span>edition</span> </h4>
  <ul>
    <li><span>Virtualization</span> <span>adds</span> <span>another</span> <span>layer</span> <span>of</span> <span>complexity</span> <span>and</span> <span>scheduling</span>.</li>
    <li><span>Typically</span> <span>there</span> <span>is</span> <span>one</span> <span>host</span> <span>operating</span> <span>system</span> <span>operating</span> <span>on</span> <span>"real"</span> <span>processor(s)</span> <span>and</span> <span>a</span> <span>number</span> <span>of</span> <span>guest</span> <span>operating</span> <span>systems</span> <span>operating</span> <span>on</span> <span>virtual</span> <span>processors</span>.</li>
    <li><span>The</span> <span>Host</span> <span>OS</span> <span>creates</span> <span>some</span> <span>number</span> <span>of</span> <span>virtual</span> <span>processors</span> <span>and</span> <span>presents</span> <span>them</span> <span>to</span> <span>the</span> <span>guest</span> <span>OSes</span> <span>as</span> <span>if</span> <span>they</span> <span>were</span> <span>real</span> <span>processors</span>.</li>
    <li><span>The</span> <span>guest</span> <span>OSes</span> <span>don't</span> <span>realize</span> <span>their</span> <span>processors</span> <span>are</span> <span>virtual,</span> <span>and</span> <span>make</span> <span>scheduling</span> <span>decisions</span> <span>on</span> <span>the</span> <span>assumption</span> <span>of</span> <span>real</span> <span>processors</span>.</li>
    <li><span>As</span> <span>a</span> <span>result,</span> <span>interactive</span> <span>and</span> <span>especially</span> <span>real-time</span> <span>performance</span> <span>can</span> <span>be</span> <span>severely</span> <span>compromised</span> <span>on</span> <span>guest</span> <span>systems</span>.<span></span> <span>The</span> <span>time-of-day</span> <span>clock</span> <span>will</span> <span>also</span> <span>frequently</span> <span>be</span> <span>off</span>.</li>
  </ul> 
  <h4><span>*/</span> </h4>
</blockquote>
<h3><span>6</span>.<span>6</span> <span>Real-Time</span> <span>CPU</span> <span>Scheduling</span> </h3>
<blockquote>
  <p><span>Real-time</span> <span>systems</span> <span>are</span> <span>those</span> <span>in</span> <span>which</span> <span>the</span> <span>time</span> <span>at</span> <span>which</span> <span>tasks</span> <span>complete</span> <span>is</span> <span>crucial</span> <span>to</span> <span>their</span> </p>
  <ul>
    <li><span></span><em><span></span><strong><span>Soft</span> <span>real-time</span> <span>systems</span></strong><span></span></em><span></span> <span>have</span> <span>degraded</span> <span>performance</span> <span>if</span> <span>their</span> <span>timing</span> <span>needs</span> <span>cannot</span> <span>be</span> <span>met</span>.<span></span> <span>Example:</span> <span>streaming</span> <span>video</span>.</li>
    <li><span></span><em><span></span><strong><span>Hard</span> <span>real-time</span> <span>systems</span></strong><span></span></em><span></span> <span>have</span> <span>total</span> <span>failure</span> <span>if</span> <span>their</span> <span>timing</span> <span>needs</span> <span>cannot</span> <span>be</span> <span>met</span>.<span></span> <span>Examples:</span> <span>Assembly</span> <span>line</span> <span>robotics,</span> <span>automobile</span> <span>air-bag</span> <span>deployment</span>.</li>
  </ul>
  <h4><span>6</span>.<span>6</span>.<span>1</span> <span>Minimizing</span> </h4>
  <ul>
    <li><span></span><em><span></span><strong><span>Event</span> <span>Latency</span></strong><span></span></em><span></span> <span>is</span> <span>the</span> <span>time</span> <span>between</span> <span>the</span> <span>occurrence</span> <span>of</span> <span>a</span> <span>triggering</span> <span>event</span> <span>and</span> <span>the</span> <span>(</span> <span>completion</span> <span>of</span> <span>)</span> <span>the</span> <span>system's</span> <span>response</span> <span>to</span> <span>the</span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_12_EventLatency.jpg" width="432" height="295"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>12</span> <span>-</span> <span>Event</span> <span>latency</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <li><span>In</span> <span>addition</span> <span>to</span> <span>the</span> <span>time</span> <span>it</span> <span>takes</span> <span>to</span> <span>actually</span> <span>process</span> <span>the</span> <span>event,</span> <span>there</span> <span>are</span> <span>two</span> <span>additional</span> <span>steps</span> <span>that</span> <span>must</span> <span>occur</span> <span>before</span> <span>the</span> <span>event</span> <span>handler</span> <span>(</span> <span>Interrupt</span> <span>Service</span> <span>Routine,</span> <span>ISR</span> <span>),</span> <span>can</span> <span>even</span> <span>start:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Interrupt</span> <span>processing</span> <span>determines</span> <span>which</span> <span>interrupt(s)</span> <span>have</span> <span>occurred,</span> <span>and</span> <span>which</span> <span>interrupt</span> <span>handler</span> <span>routine</span> <span>to</span> <span>run</span>.<span></span> <span>In</span> <span>the</span> <span>event</span> <span>of</span> <span>simultaneous</span> <span>interrupts,</span> <span>a</span> <span>priority</span> <span>scheme</span> <span>is</span> <span>needed</span> <span>to</span> <span>determine</span> <span>which</span> <span>ISR</span> <span>has</span> <span>the</span> <span>highest</span> <span>priority</span> <span>and</span> <span>gets</span> <span>to</span> <span>go</span> <span>next</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Context</span> <span>switching</span> <span>involves</span> <span>removing</span> <span>a</span> <span>running</span> <span>process</span> <span>from</span> <span>the</span> <span>CPU,</span> <span>saving</span> <span>its</span> <span>state,</span> <span>and</span> <span>loading</span> <span>up</span> <span>the</span> <span>ISR</span> <span>so</span> <span>that</span> <span>it</span> <span>can</span> <span>run</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_13_InterruptLatency.jpg" width="530" height="503"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>13</span> <span>-</span> <span>Interrupt</span> <span>latency</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <ul>
      <li><span>The</span> <span>total</span> <span>dispatch</span> <span>latency</span> <span>(</span> <span>context</span> <span>switching</span> <span>)</span> <span>consists</span> <span>of</span> <span>two</span> <span>parts:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Removing</span> <span>the</span> <span>currently</span> <span>running</span> <span>process</span> <span>from</span> <span>the</span> <span>CPU,</span> <span>and</span> <span>freeing</span> <span>up</span> <span>any</span> <span>resources</span> <span>that</span> <span>are</span> <span>needed</span> <span>by</span> <span>the</span> <span>ISR</span>.<span></span> <span>This</span> <span>step</span> <span>can</span> <span>be</span> <span>speeded</span> <span>up</span> <span>a</span> <span>lot</span> <span>by</span> <span>the</span> <span>use</span> <span>of</span> <span>pre-emptive</span> <span>kernels</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Loading</span> <span>the</span> <span>ISR</span> <span>up</span> <span>onto</span> <span>the</span> <span>CPU,</span> <span>(</span> <span>dispatching</span> <span>)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> </li>
    </ul>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_14_DsipatchLatency.jpg" width="652" height="481"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>14</span> <span>-</span> <span>Dispatch</span> <span>latency</span>.<span></span></strong><span>
</span> <span></span> </p>
  <h4><span>6</span>.<span>6</span>.<span>2</span> <span>Priority-Based</span> </h4>
  <ul>
    <li><span>Real-time</span> <span>systems</span> <span>require</span> <span>pre-emptive</span> <span>priority-based</span> <span>scheduling</span> <span>systems</span>.</li>
    <li><span>Soft</span> <span>real-time</span> <span>systems</span> <span>do</span> <span>the</span> <span>best</span> <span>they</span> <span>can,</span> <span>but</span> <span>make</span> <span>no</span> <span>guarantees</span>.<span></span> <span>They</span> <span>are</span> <span>generally</span> <span>discussed</span> <span>elsewhere</span>.</li>
    <li><span>Hard</span> <span>real-time</span> <span>systems,</span> <span>described</span> <span>here,</span> <span>must</span> <span>be</span> <span>able</span> <span>to</span> <span>provide</span> <span>firm</span> <span>guarantees</span> <span>that</span> <span>a</span> <span>tasks</span> <span>scheduling</span> <span>needs</span> <span>can</span> <span>be</span> <span>met</span>.<span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>One</span> <span>technique</span> <span>is</span> <span>to</span> <span>use</span> <span>a</span> <span></span><em><span></span><strong><span>admission-control</span></strong><span></span></em><span></span> <span>algorithm,</span> <span>in</span> <span>which</span> <span>each</span> <span>task</span> <span>must</span> <span>specify</span> <span>its</span> <span>needs</span> <span>at</span> <span>the</span> <span>time</span> <span>it</span> <span>attempts</span> <span>to</span> <span>launch,</span> <span>and</span> <span>the</span> <span>system</span> <span>will</span> <span>only</span> <span>launch</span> <span>the</span> <span>task</span> <span>if</span> <span>it</span> <span>can</span> <span>guarantee</span> <span>that</span> <span>its</span> <span>needs</span> <span>can</span> <span>be</span> <span>met</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>Hard</span> <span>real-time</span> <span>systems</span> <span>are</span> <span>often</span> <span>characterized</span> <span>by</span> <span>tasks</span> <span>that</span> <span>must</span> <span>run</span> <span>at</span> <span>regular</span> <span>periodic</span> <span>intervals,</span> <span>each</span> <span>having</span> <span>a</span> <span>period</span> <span>p,</span> <span>a</span> <span>constant</span> <span>time</span> <span>required</span> <span>to</span> <span>execute,</span> <span>(</span> <span>CPU</span> <span>burst</span> <span>),</span> <span>t,</span> <span>and</span> <span>a</span> <span>deadline</span> <span>after</span> <span>the</span> <span>beginning</span> <span>of</span> <span>each</span> <span>period</span> <span>by</span> <span>which</span> <span>the</span> <span>task</span> <span>must</span> <span>be</span> <span>completed,</span> <span>d</span>.</li>
    <li><span>In</span> <span>all</span> <span>cases,</span> <span>t</span> <span>&lt;=</span> <span>d</span> <span>&lt;=</span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_15_PeriodicTask.jpg" width="750" height="226"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>15</span> <span>-</span> <span>Periodic</span> <span>task</span>.<span></span></strong><span>
</span> <span></span> </p>
  <p align="center"></p>
  <h4><span>6</span>.<span>6</span>.<span>3</span> <span>Rate-Monotonic</span> </h4>
  <ul>
    <li><span>The</span> <span>rate-monotonic</span> <span>scheduling</span> <span>algorithm</span> <span>uses</span> <span>pre-emptive</span> <span>scheduling</span> <span>with</span> <span>static</span> <span>priorities</span>.</li>
    <li><span>Priorities</span> <span>are</span> <span>assigned</span> <span>inversely</span> <span>to</span> <span>the</span> <span>period</span> <span>of</span> <span>each</span> <span>task,</span> <span>giving</span> <span>higher</span> <span>(</span> <span>better</span> <span>)</span> <span>priority</span> <span>to</span> <span>tasks</span> <span>with</span> <span>shorter</span> <span>periods</span>.</li>
    <li><span>Let's</span> <span>consider</span> <span>an</span> <span>example,</span> <span>first</span> <span>showing</span> <span>what</span> <span>can</span> <span>happen</span> <span>if</span> <span>the</span> <span>task</span> <span>with</span> <span>the</span> <span>longer</span> <span>period</span> <span>is</span> <span>given</span> <span>higher</span> <span>priority:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Suppose</span> <span>that</span> <span>process</span> <span>P1</span> <span>has</span> <span>a</span> <span>period</span> <span>of</span> <span>50,</span> <span>an</span> <span>execution</span> <span>time</span> <span>of</span> <span>20,</span> <span>and</span> <span>a</span> <span>deadline</span> <span>that</span> <span>matches</span> <span>its</span> <span>period</span> <span>(</span> <span>50</span> <span>)</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Similarly</span> <span>suppose</span> <span>that</span> <span>process</span> <span>P2</span> <span>has</span> <span>period</span> <span>100,</span> <span>execution</span> <span>time</span> <span>of</span> <span>35,</span> <span>and</span> <span>deadline</span> <span>of</span> <span>100</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>The</span> <span>total</span> <span>CPU</span> <span>utilization</span> <span>time</span> <span>is</span> <span>20</span> <span>/</span> <span>50</span> <span>=</span> <span>0</span>.<span>4</span> <span>for</span> <span>P1,</span> <span>and</span> <span>25</span> <span>/</span> <span>100</span> <span>=</span> <span>0</span>.<span>35</span> <span>for</span> <span>P2,</span> <span>or</span> <span>0</span>.<span>75</span> <span>(</span> <span>75%</span> <span>)</span> <span>overall</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>However</span> <span>if</span> <span>P2</span> <span>is</span> <span>allowed</span> <span>to</span> <span>go</span> <span>first,</span> <span>then</span> <span>P1</span> <span>cannot</span> <span>complete</span> <span>before</span> <span>its</span> <span>deadline:</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_16_SchedulingTasks.jpg" width="621" height="117"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>16</span> <span>-</span> <span>Scheduling</span> <span>of</span> <span>tasks</span> <span>when</span> <span>P2</span> <span>has</span> <span>a</span> <span>higher</span> <span>priority</span> <span>than</span> <span>P1</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <ul>
      <li><span>Now</span> <span>on</span> <span>the</span> <span>other</span> <span>hand,</span> <span>if</span> <span>P1</span> <span>is</span> <span>given</span> <span>higher</span> <span>priority,</span> <span>it</span> <span>gets</span> <span>to</span> <span>go</span> <span>first,</span> <span>and</span> <span>P2</span> <span>starts</span> <span>after</span> <span>P1</span> <span>completes</span> <span>its</span> <span>burst</span>.</li>
      <li><span>At</span> <span>time</span> <span>50</span> <span>when</span> <span>the</span> <span>next</span> <span>period</span> <span>for</span> <span>P1</span> <span>starts,</span> <span>P2</span> <span>has</span> <span>only</span> <span>completed</span> <span>30</span> <span>of</span> <span>its</span> <span>35</span> <span>needed</span> <span>time</span> <span>units,</span> <span>but</span> <span>it</span> <span>gets</span> <span>pre-empted</span> <span>by</span> <span>P1</span>.</li>
      <li><span>At</span> <span>time</span> <span>70,</span> <span>P1</span> <span>completes</span> <span>its</span> <span>task</span> <span>for</span> <span>its</span> <span>second</span> <span>period,</span> <span>and</span> <span>the</span> <span>P2</span> <span>is</span> <span>allowed</span> <span>to</span> <span>complete</span> <span>its</span> <span>last</span> <span>5</span> <span>time</span> <span>units</span>.</li>
      <li><span>Overall</span> <span>both</span> <span>processes</span> <span>complete</span> <span>at</span> <span>time</span> <span>75,</span> <span>and</span> <span>the</span> <span>cpu</span> <span>is</span> <span>then</span> <span>idle</span> <span>for</span> <span>25</span> <span>time</span> <span>units,</span> <span>before</span> <span>the</span> <span>process</span> <span>repeats</span>.</li>
    </ul>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_17_RateMonotonicScheduling.jpg" width="760" height="117"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>17</span> <span>-</span> <span>Rate-monotonic</span> <span>scheduling</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <ul>
      <li><span>Rate-monotonic</span> <span>scheduling</span> <span>is</span> <span>considered</span> <span>optimal</span> <span>among</span> <span>algorithms</span> <span>that</span> <span>use</span> <span>static</span> <span>priorities,</span> <span>because</span> <span>any</span> <span>set</span> <span>of</span> <span>processes</span> <span>that</span> <span>cannot</span> <span>be</span> <span>scheduled</span> <span>with</span> <span>this</span> <span>algorithm</span> <span>cannot</span> <span>be</span> <span>scheduled</span> <span>with</span> <span>any</span> <span>other</span> <span>static-priority</span> <span>scheduling</span> <span>algorithm</span> <span>either</span>.</li>
      <li><span>There</span> <span>are,</span> <span>however,</span> <span>some</span> <span>sets</span> <span>of</span> <span>processes</span> <span>that</span> <span>cannot</span> <span>be</span> <span>scheduled</span> <span>with</span> <span>static</span> <span>priorities</span>.<span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>For</span> <span>example,</span> <span>supposing</span> <span>that</span> <span>P1</span> <span>=50,</span> <span>T1</span> <span>=</span> <span>25,</span> <span>P2</span> <span>=</span> <span>80,</span> <span>T2</span> <span>=</span> <span>35,</span> <span>and</span> <span>the</span> <span>deadlines</span> <span>match</span> <span>the</span> <span>periods</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Overall</span> <span>CPU</span> <span>usage</span> <span>is</span> <span>25/50</span> <span>=</span> <span>0</span>.<span>5</span> <span>for</span> <span>P1,</span> <span>35</span> <span>/</span> <span>80</span> <span>=0</span>.<span>44</span> <span>for</span> <span>P2,</span> <span>or</span> <span>0</span>.<span>94</span> <span>(</span> <span>94%</span> <span>)</span> <span>overall,</span> <span>indicating</span> <span>it</span> <span>should</span> <span>be</span> <span>possible</span> <span>to</span> <span>schedule</span> <span>the</span> <span>processes</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>With</span> <span>rate-monotonic</span> <span>scheduling,</span> <span>P1</span> <span>goes</span> <span>first,</span> <span>and</span> <span>completes</span> <span>its</span> <span>first</span> <span>burst</span> <span>at</span> <span>time</span> <span>25</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>P2</span> <span>goes</span> <span>next,</span> <span>and</span> <span>completes</span> <span>25</span> <span>out</span> <span>of</span> <span>its</span> <span>35</span> <span>time</span> <span>units</span> <span>before</span> <span>it</span> <span>gets</span> <span>pre-empted</span> <span>by</span> <span>P1</span> <span>at</span> <span>time</span> <span>50</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>P1</span> <span>completes</span> <span>its</span> <span>second</span> <span>burst</span> <span>at</span> <span>75,</span> <span>and</span> <span>then</span> <span>P2</span> <span>completes</span> <span>its</span> <span>last</span> <span>10</span> <span>time</span> <span>units</span> <span>at</span> <span>time</span> <span>85,</span> <span>missing</span> <span>its</span> <span>deadline</span> <span>of</span> <span>80</span> <span>by</span> <span>5</span> <span>time</span> <span>units</span>.<span></span> <span>:-(</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> </li>
    </ul>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_18_MissingDeadlines.jpg" width="750" height="117"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>18</span> <span>-</span> <span>Missing</span> <span>deadlines</span> <span>with</span> <span>rate-monotonic</span> <span>scheduling</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <ul>
      <li><span>The</span> <span>worst-case</span> <span>CPU</span> <span>utilization</span> <span>for</span> <span>scheduling</span> <span>N</span> <span>processes</span> <span>under</span> <span>this</span> <span>algorithm</span> <span>is</span> <span>N</span> <span>*</span> <span>(</span> <span>2^(1/N)</span> <span>-</span> <span>1</span> <span>),</span> <span>which</span> <span>is</span> <span>100%</span> <span>for</span> <span>a</span> <span>single</span> <span>process,</span> <span>but</span> <span>drops</span> <span>to</span> <span>75%</span> <span>for</span> <span>two</span> <span>processes</span> <span>and</span> <span>to</span> <span>69%</span> <span>as</span> <span>N</span> <span>approaches</span> <span>infinity</span>.<span></span> <span>Note</span> <span>that</span> <span>in</span> <span>our</span> <span>example</span> <span>above</span> <span>94%</span> <span>is</span> <span>higher</span> <span>than</span> <span>75%</span>.</li>
    </ul>
  </ul>
  <h4><span>6</span>.<span>6</span>.<span>4</span> <span>Earliest-Deadline-First</span> </h4>
  <ul>
    <li><span>Earliest</span> <span>Deadline</span> <span>First</span> <span>(</span> <span>EDF</span> <span>)</span> <span>scheduling</span> <span>varies</span> <span>priorities</span> <span>dynamically,</span> <span>giving</span> <span>the</span> <span>highest</span> <span>priority</span> <span>to</span> <span>the</span> <span>process</span> <span>with</span> <span>the</span> <span>earliest</span> <span>deadline</span>.</li>
    <li><span>Figure</span> <span>6</span>.<span>19</span> <span>shows</span> <span>our</span> <span>previous</span> <span>example</span> <span>repeated</span> <span>under</span> <span>EDF</span> <span>scheduling:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>At</span> <span>time</span> <span>0</span> <span>P1</span> <span>has</span> <span>the</span> <span>earliest</span> <span>deadline,</span> <span>highest</span> <span>priority,</span> <span>and</span> <span>goes</span> <span>first</span>.<span>,</span> <span>followed</span> <span>by</span> <span>P2</span> <span>at</span> <span>time</span> <span>25</span> <span>when</span> <span>P1</span> <span>completes</span> <span>its</span> <span>first</span> <span>burst</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>At</span> <span>time</span> <span>50</span> <span>process</span> <span>P1</span> <span>begins</span> <span>its</span> <span>second</span> <span>period,</span> <span>but</span> <span>since</span> <span>P2</span> <span>has</span> <span>a</span> <span>deadline</span> <span>of</span> <span>80</span> <span>and</span> <span>the</span> <span>deadline</span> <span>for</span> <span>P1</span> <span>is</span> <span>not</span> <span>until</span> <span>100,</span> <span>P2</span> <span>is</span> <span>allowed</span> <span>to</span> <span>stay</span> <span>on</span> <span>the</span> <span>CPU</span> <span>and</span> <span>complete</span> <span>its</span> <span>burst,</span> <span>which</span> <span>it</span> <span>does</span> <span>at</span> <span>time</span> <span>60</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>P1</span> <span>then</span> <span>starts</span> <span>its</span> <span>second</span> <span>burst,</span> <span>which</span> <span>it</span> <span>completes</span> <span>at</span> <span>time</span> <span>85</span>.<span></span> <span>P2</span> <span>started</span> <span>its</span> <span>second</span> <span>period</span> <span>at</span> <span>time</span> <span>80,</span> <span>but</span> <span>since</span> <span>P1</span> <span>had</span> <span>an</span> <span>earlier</span> <span>deadline,</span> <span>P2</span> <span>did</span> <span>not</span> <span>pre-empt</span> <span>P1</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>P2</span> <span>starts</span> <span>its</span> <span>second</span> <span>burst</span> <span>at</span> <span>time</span> <span>85,</span> <span>and</span> <span>continues</span> <span>until</span> <span>time</span> <span>100,</span> <span>at</span> <span>which</span> <span>time</span> <span>P1</span> <span>starts</span> <span>its</span> <span>third</span> <span>period</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>At</span> <span>this</span> <span>point</span> <span>P1</span> <span>has</span> <span>a</span> <span>deadline</span> <span>of</span> <span>150</span> <span>and</span> <span>P2</span> <span>has</span> <span>a</span> <span>deadline</span> <span>of</span> <span>160,</span> <span>so</span> <span>P1</span> <span>preempts</span> <span>P2</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>P1</span> <span>completes</span> <span>its</span> <span>third</span> <span>burst</span> <span>at</span> <span>time</span> <span>125,</span> <span>at</span> <span>which</span> <span>time</span> <span>P2</span> <span>starts,</span> <span>completing</span> <span>its</span> <span>third</span> <span>burst</span> <span>at</span> <span>time</span> <span>145</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>The</span> <span>CPU</span> <span>sits</span> <span>idle</span> <span>for</span> <span>5</span> <span>time</span> <span>units,</span> <span>until</span> <span>P1</span> <span>starts</span> <span>its</span> <span>next</span> <span>period</span> <span>at</span> <span>150</span> <span>and</span> <span>P2</span> <span>at</span> <span>160</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Question:</span> <span></span></strong><span>Which</span> <span>process</span> <span>will</span> <span>get</span> <span>to</span> <span>run</span> <span>at</span> <span>time</span> <span>160,</span> <span>and</span> <span>why?</span> <span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Answer:</span></strong><span></span> <span></span><font color="#ffff80"><span>Process</span> <span>P2,</span> <span>because</span> <span>P1</span> <span>now</span> <span>has</span> <span>a</span> <span>deadline</span> <span>of</span> <span>200</span> <span>and</span> <span>P2's</span> <span>new</span> <span>deadline</span> <span>is</span> <span>240</span>.<span></span></font><span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_19_EarliestDeadlineFirstScheduling.jpg" width="750" height="117"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>19</span> <span>-</span> <span>Earliest-deadline-first</span> <span>scheduling</span>.<span></span></strong><span>
</span> <span></span> </p>
  <h4><span>6</span>.<span>6</span>.<span>5</span> <span>Proportional</span> <span>Share</span> </h4>
  <ul>
    <li><span>Proportional</span> <span>share</span> <span>scheduling</span> <span>works</span> <span>by</span> <span>dividing</span> <span>the</span> <span>total</span> <span>amount</span> <span>of</span> <span>time</span> <span>available</span> <span>up</span> <span>into</span> <span>an</span> <span>equal</span> <span>number</span> <span>of</span> <span>shares,</span> <span>and</span> <span>then</span> <span>each</span> <span>process</span> <span>must</span> <span>request</span> <span>a</span> <span>certain</span> <span>share</span> <span>of</span> <span>the</span> <span>total</span> <span>when</span> <span>it</span> <span>tries</span> <span>to</span> <span>start</span>.</li>
    <li><span>Say</span> <span>for</span> <span>example</span> <span>that</span> <span>the</span> <span>total</span> <span>shares,</span> <span>T,</span> <span>=</span> <span>100,</span> <span>and</span> <span>then</span> <span>a</span> <span>particular</span> <span>process</span> <span>asks</span> <span>for</span> <span>N</span> <span>=</span> <span>30</span> <span>shares</span> <span>when</span> <span>it</span> <span>launches</span>.<span></span> <span>It</span> <span>will</span> <span>then</span> <span>be</span> <span>guaranteed</span> <span>30</span> <span>/</span> <span>100</span> <span>or</span> <span>30%</span> <span>of</span> <span>the</span> <span>available</span> <span>time</span>.</li>
    <li><span>Proportional</span> <span>share</span> <span>scheduling</span> <span>works</span> <span>with</span> <span>an</span> <span>admission-control</span> <span>policy,</span> <span>not</span> <span>starting</span> <span>any</span> <span>task</span> <span>if</span> <span>it</span> <span>cannot</span> <span>guarantee</span> <span>the</span> <span>shares</span> <span>that</span> <span>the</span> <span>task</span> <span>says</span> <span>that</span> <span>it</span> <span>needs</span>.</li>
  </ul>
  <h4><span>6</span>.<span>6</span>.<span>6</span> <span>POSIX</span> <span>Real-Time</span> </h4>
  <ul>
    <li><span>POSIX</span> <span>defines</span> <span>two</span> <span>scheduling</span> <span>classes</span> <span>for</span> <span>real</span> <span>time</span> <span>threads,</span> <span>SCHED_FIFO</span> <span>and</span> <span>SCHED_RR,</span> <span>depending</span> <span>on</span> <span>how</span> <span>threads</span> <span></span><em><span></span><strong><span>of</span> <span>equal</span> <span>priority</span></strong><span></span></em><span></span> <span>share</span> <span>time</span>.</li>
    <li><span>SCHED_FIFO</span> <span>schedules</span> <span>tasks</span> <span>in</span> <span>a</span> <span>first-in-first-out</span> <span>order,</span> <span>with</span> <span>no</span> <span>time</span> <span>slicing</span> <span>among</span> <span>threads</span> <span>of</span> <span>equal</span> <span>priority</span>.</li>
    <li><span>SCHED_RR</span> <span>performs</span> <span>round-robin</span> <span>time</span> <span>slicing</span> <span>among</span> <span>threads</span> <span>of</span> <span>equal</span> <span>priority</span>.</li>
    <li><span>POSIX</span> <span>provides</span> <span>methods</span> <span>for</span> <span>getting</span> <span>and</span> <span>setting</span> <span>the</span> <span>thread</span> <span>scheduling</span> <span>policy,</span> <span>as</span> <span>shown</span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_20_POSIX_API.jpg" width="736" height="1179"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>20</span> <span>-</span> <span>POSIX</span> <span>real-time</span> <span>scheduling</span> <span>API</span>.<span></span></strong><span>
</span> <span></span> </p>
</blockquote>
<h3><span>6</span>.<span>7</span> <span>Operating</span> <span>System</span> <span>Examples</span> <span>(</span> <span>Optional</span> </h3>
<blockquote>
  <h4><span>6</span>.<span>7</span>.<span>1</span> <span>Example:</span> <span>Linux</span> <span>Scheduling</span> <span>(</span> <span>was</span> <span>5</span>.<span>6</span>.<span>3</span> </h4>
  <ul>
    <li><span>Prior</span> <span>to</span> <span>version</span> <span>2</span>.<span>5,</span> <span>Linux</span> <span>used</span> <span>a</span> <span>traditional</span> <span>UNIX</span> <span>scheduling</span> <span>algorithm</span>.</li>
    <li><span>Version</span> <span>2</span>.<span>6</span> <span>used</span> <span>an</span> <span>algorithm</span> <span>known</span> <span>as</span> <span>O(1),</span> <span>that</span> <span>ran</span> <span>in</span> <span>constant</span> <span>time</span> <span>regardless</span> <span>of</span> <span>the</span> <span>number</span> <span>of</span> <span>tasks,</span> <span>and</span> <span>provided</span> <span>better</span> <span>support</span> <span>for</span> <span>SMP</span> <span>systems</span>.<span></span> <span>However</span> <span>it</span> <span>yielded</span> <span>poor</span> <span>interactive</span> <span>performance</span>.</li>
    <li><span>Starting</span> <span>in</span> <span>2</span>.<span>6</span>.<span>23,</span> <span>the</span> <span></span><em><span></span><strong><span>Completely</span> <span>Fair</span> <span>Scheduler,</span> <span>CFS,</span> <span></span></strong><span></span></em><span>became</span> <span>the</span> <span>standard</span> <span>Linux</span> <span>scheduling</span> <span>system</span>.<span></span> <span>See</span> <span>sidebar</span> </li>
  </ul>
  <div align="center">
    <table border="0" cellpadding="20">
      <tbody><tr>
        <td bgcolor="#E2FEFF"><span></span><h3 align="center"><span>CFS</span> <span>(</span> <span>Completely</span> <span>Fair</span> <span>Scheduler</span> <span>)</span> <span>Performance</span></h3><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><p align="justify"><span></span><font size="+1"><span>The</span> <span>Linux</span> <span>CFS</span> <span>scheduler</span> <span>provides</span> <span>an</span> <span>efficient</span> <span></span> <span>algorithm</span> <span>for</span> <span>selecting</span> <span>which</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>task</span> <span>to</span> <span>run</span> <span>next</span>.<span></span> <span>Each</span> <span>runnable</span> <span>task</span> <span>is</span> <span>placed</span> <span>in</span> <span>a</span> <span></span> <span>red-black</span> <span>treea</span> <span>balanced</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>binary</span> <span>search</span> <span>tree</span> <span>whose</span> <span>key</span> <span>is</span> <span>based</span> <span>on</span> <span>the</span> <span>value</span> <span></span> <span>of</span> <span></span><span class="courier"><span>vruntime</span></span><span></span>.<span></span> <span>This</span> <span></span> <span>tree</span> <span>is</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>shown</span> <span>below:</span></font><span></span></p><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><p align="justify"><span></span><img src="./4_ CPU Scheduling_files/6_vruntimeTree.jpg" width="600" height="316"><span></span></p><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><p align="justify"><span></span><font size="+1"><span>When</span> <span>a</span> <span>task</span> <span>becomes</span> <span>runnable,</span> <span>it</span> <span>is</span> <span>added</span> <span>to</span> <span>the</span> <span></span> <span>tree</span>.<span></span> <span>&nbsp;If</span> <span>a</span> <span>task</span> <span>on</span> <span>the</span> <span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>tree</span> <span>is</span> <span>not</span> <span>runnable</span> <span>(</span> <span>for</span> <span>example,</span> <span>if</span> <span>it</span> <span>is</span> <span>blocked</span> <span></span> <span>while</span> <span>waiting</span> <span>for</span> <span>I/O</span> <span>),</span> <span>it</span> <span>is</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>removed</span>.<span></span> <span>&nbsp;Generally</span> <span></span> <span>speaking,</span> <span>tasks</span> <span>that</span> <span>have</span> <span>been</span> <span>given</span> <span>less</span> <span>processing</span> <span>time</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>(</span> <span>smaller</span> <span>values</span> <span>of</span> <span></span><span class="courier"><span>vruntime</span></span><span></span> <span>)</span> <span>are</span> <span>toward</span> <span>the</span> <span>left</span> <span>side</span> <span>of</span> <span></span> <span>the</span> <span>tree,</span> <span>and</span> <span>tasks</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>that</span> <span>have</span> <span>been</span> <span>given</span> <span>more</span> <span>processing</span> <span>time</span> <span>are</span> <span>on</span> <span>the</span> <span></span> <span>right</span> <span>side</span>.<span></span> <span>According</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>to</span> <span>the</span> <span>properties</span> <span>of</span> <span>a</span> <span>binary</span> <span>search</span> <span>tree,</span> <span>the</span> <span></span> <span>leftmost</span> <span>node</span> <span>has</span> <span>the</span> <span>smallest</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>key</span> <span>value,</span> <span>which</span> <span>for</span> <span>the</span> <span>sake</span> <span>of</span> <span>the</span> <span>CFS</span> <span>scheduler</span> <span></span> <span>means</span> <span>that</span> <span>it</span> <span>is</span> <span>the</span> <span>task</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>with</span> <span>the</span> <span>highest</span> <span>priority</span> <span></span>.<span></span> <span>Because</span> <span>the</span> <span>red-black</span> <span></span> <span>tree</span> <span>is</span> <span>balanced,</span> <span>navigating</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>it</span> <span>to</span> <span>discover</span> <span>the</span> <span>leftmost</span> <span>node</span> <span>will</span> <span>require</span> <span></span><strong><span></span><em><span>O(lgN)</span> <span></span></em><span></span></strong><span>operations</span> <span>(where</span> <span></span><strong><span></span><em><span>N</span></em><span></span></strong><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>is</span> <span>the</span> <span>number</span> <span>of</span> <span>nodes</span> <span>in</span> <span>the</span> <span>tree)</span>.<span></span> <span>However,</span> <span>for</span> <span></span> <span>efficiency</span> <span>reasons,</span> <span>the</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>Linux</span> <span>scheduler</span> <span>caches</span> <span>this</span> <span>value</span> <span>in</span> <span>the</span> <span>variable</span> <span></span><span class="courier"><span>rb_leftmost</span></span><span>,</span> <span>and</span> <span></span> <span>thus</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>determining</span> <span>which</span> <span>task</span> <span>to</span> <span>run</span> <span>next</span> <span>requires</span> <span>only</span> <span></span> <span>retrieving</span> <span>the</span> <span>cached</span> <span>value</span>.<span></span></font><span></span></p></td>
      </tr>
    </tbody></table>
    <strong>New sidebar in ninth edition</strong>  </div>
  <ul>
    <li><span>The</span> <span>Linux</span> <span>scheduler</span> <span>is</span> <span>a</span> <span>preemptive</span> <span>priority-based</span> <span>algorithm</span> <span>with</span> <span>two</span> <span>priority</span> <span>ranges</span> <span>-</span> <span></span><strong><span></span><em><span>Real</span> <span>time</span></em><span></span></strong><span></span> <span>from</span> <span>0</span> <span>to</span> <span>99</span> <span>and</span> <span>a</span> <span></span><em><span></span><strong><span>nice</span></strong><span></span></em><span></span> <span>range</span> <span>from</span> <span>100</span> <span>to</span> <span>140</span>.</li>
    <li><span>Unlike</span> <span>Solaris</span> <span>or</span> <span>XP,</span> <span>Linux</span> <span>assigns</span> <span>longer</span> <span>time</span> <span>quantums</span> <span>to</span> <span>higher</span> <span>priority</span> <span>tasks</span>.<span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_21_LinuxPriorities.jpg" width="691" height="159"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>21</span> <span>-</span> <span>Scheduling</span> <span>priorities</span> <span>on</span> <span>a</span> <span>Linux</span> <span>system</span>.<span></span></strong><span>
</span> <span></span> </p>
<p align="center"><span></span><img src="./4_ CPU Scheduling_files/5_15_PrioritiesVS_Length.jpg" width="612" height="364"><span></span><br><span>
</span> <span></span> <span></span><strong><span>Replaced</span> <span>by</span> <span>Figure</span> <span>6</span>.<span>21</span> <span>in</span> <span>the</span> <span>ninth</span> <span>edition</span>.<span></span> <span></span></strong><span>Was</span> <span>Figure</span> <span>5</span>.<span>15</span> <span>in</span> <span>eighth</span> </p>
  <blockquote>
    <h4><span>/*</span> <span>The</span> <span>Following</span> <span>material</span> <span>was</span> <span>omitted</span> <span>from</span> <span>the</span> <span>ninth</span> </h4>
    <ul>
      <ul>
        <li><span>A</span> <span>runnable</span> <span>task</span> <span>is</span> <span>considered</span> <span>eligible</span> <span>for</span> <span>execution</span> <span>as</span> <span>long</span> <span>as</span> <span>it</span> <span>has</span> <span>not</span> <span>consumed</span> <span>all</span> <span>the</span> <span>time</span> <span>available</span> <span>in</span> <span>it's</span> <span>time</span> <span>slice</span>.<span></span> <span>Those</span> <span>tasks</span> <span>are</span> <span>stored</span> <span>in</span> <span>an</span> <span></span><em><span></span><strong><span>active</span> <span>array</span></strong><span></span></em><span>,</span> <span>indexed</span> <span>according</span> <span>to</span> <span>priority</span>.</li>
        <li><span>When</span> <span>a</span> <span>process</span> <span>consumes</span> <span>its</span> <span>time</span> <span>slice,</span> <span>it</span> <span>is</span> <span>moved</span> <span>to</span> <span>an</span> <span></span><em><span></span><strong><span>expired</span> <span>array</span>.<span></span></strong><span></span></em><span></span> <span>The</span> <span>tasks</span> <span>priority</span> <span>may</span> <span>be</span> <span>re-assigned</span> <span>as</span> <span>part</span> <span>of</span> <span>the</span> <span>transferal</span>.</li>
        <li><span>When</span> <span>the</span> <span>active</span> <span>array</span> <span>becomes</span> <span>empty,</span> <span>the</span> <span>two</span> <span>arrays</span> <span>are</span> <span>swapped</span>.</li>
        <li><span>These</span> <span>arrays</span> <span>are</span> <span>stored</span> <span>in</span> <span></span><em><span></span><strong><span>runqueue</span></strong><span></span></em><span></span> <span>structures</span>.<span></span> <span>On</span> <span>multiprocessor</span> <span>machines,</span> <span>each</span> <span>processor</span> <span>has</span> <span>its</span> <span>own</span> <span>scheduler</span> <span>with</span> <span>its</span> <span>own</span> <span>runqueue</span>.</li>
      </ul>
    </ul>
  </blockquote>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/5_16_TaskList.jpg" width="490" height="292"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Omitted</span> <span>from</span> <span>ninth</span> <span>edition</span>.<span></span> <span></span></strong><span>Figure</span> <span>5</span>.<span>16
</span> <span></span> <span></span> <span></span> <span>in</span> <span>eighth</span> <span>edition</span>.</p>
  <blockquote>
    <p align="left"></p>
  </blockquote>
  <h4><span>6</span>.<span>7</span>.<span>2</span> <span>Example:</span> <span>Windows</span> <span>XP</span> <span>Scheduling</span> <span>(</span> <span>was</span> <span>5</span>.<span>6</span>.<span>2</span> </h4>
  <ul>
    <li><span>Windows</span> <span>XP</span> <span>uses</span> <span>a</span> <span>priority-based</span> <span>preemptive</span> <span>scheduling</span> <span>algorithm</span>.</li>
    <li><span>The</span> <span>dispatcher</span> <span>uses</span> <span>a</span> <span>32-level</span> <span>priority</span> <span>scheme</span> <span>to</span> <span>determine</span> <span>the</span> <span>order</span> <span>of</span> <span>thread</span> <span>execution,</span> <span>divided</span> <span>into</span> <span>two</span> <span>classes</span> <span>-</span> <span></span><em><span></span><strong><span>variable</span> <span>class</span></strong><span></span></em><span></span> <span>from</span> <span>1</span> <span>to</span> <span>15</span> <span>and</span> <span></span><em><span></span><strong><span>real-time</span> <span>class</span></strong><span></span></em><span></span> <span>from</span> <span>16</span> <span>to</span> <span>31,</span> <span>(</span> <span>plus</span> <span>a</span> <span>thread</span> <span>at</span> <span>priority</span> <span>0</span> <span>managing</span> <span>memory</span>.<span></span> </li>
    <li><span>There</span> <span>is</span> <span>also</span> <span>a</span> <span>special</span> <span></span><em><span></span><strong><span>idle</span> <span></span></strong><span></span></em><span>thread</span> <span>that</span> <span>is</span> <span>scheduled</span> <span>when</span> <span>no</span> <span>other</span> <span>threads</span> <span>are</span> <span>ready</span>.</li>
    <li><span>Win</span> <span>XP</span> <span>identifies</span> <span>7</span> <span>priority</span> <span>classes</span> <span>(</span> <span>rows</span> <span>on</span> <span>the</span> <span>table</span> <span>below</span> <span>),</span> <span>and</span> <span>6</span> <span>relative</span> <span>priorities</span> <span>within</span> <span>each</span> <span>class</span> <span>(</span> <span>columns</span>.<span></span> </li>
    <li><span>Processes</span> <span>are</span> <span>also</span> <span>each</span> <span>given</span> <span>a</span> <span></span><strong><span>base</span> <span>priority</span></strong><span></span> <span>within</span> <span>their</span> <span>priority</span> <span>class</span>.<span></span> <span>When</span> <span>variable</span> <span>class</span> <span>processes</span> <span>consume</span> <span>their</span> <span>entire</span> <span>time</span> <span>quanta,</span> <span>then</span> <span>their</span> <span>priority</span> <span>gets</span> <span>lowered,</span> <span>but</span> <span>not</span> <span>below</span> <span>their</span> <span>base</span> <span>priority</span>.</li>
    <li><span>Processes</span> <span>in</span> <span>the</span> <span>foreground</span> <span>(</span> <span>active</span> <span>window</span> <span>)</span> <span>have</span> <span>their</span> <span>scheduling</span> <span>quanta</span> <span>multiplied</span> <span>by</span> <span>3,</span> <span>to</span> <span>give</span> <span>better</span> <span>response</span> <span>to</span> <span>interactive</span> <span>processes</span> <span>in</span> <span>the</span> <span>foreground</span>.</li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_22_WindowsThreadPriorities.jpg" width="718" height="291"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>22</span> <span>-</span> <span>Windows</span> <span>thread</span> <span>priorities</span>.<span></span></strong></p>
  <h4><span>6</span>.<span>7</span>.<span>1</span> <span>Example:</span> <span>Solaris</span> <span>Scheduling</span> </h4>
  <ul>
    <li><span>Priority-based</span> <span>kernel</span> <span>thread</span> <span>scheduling</span>.<span></span> </li>
    <li><span>Four</span> <span>classes</span> <span>(</span> <span>real-time,</span> <span>system,</span> <span>interactive,</span> <span>and</span> <span>time-sharing</span> <span>),</span> <span>and</span> <span>multiple</span> <span>queues</span> <span>/</span> <span>algorithms</span> <span>within</span> <span>each</span> <span>class</span>.<span></span> </li>
    <li><span>Default</span> <span>is</span> <span>time-sharing</span>.<span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Process</span> <span>priorities</span> <span>and</span> <span>time</span> <span>slices</span> <span>are</span> <span>adjusted</span> <span>dynamically</span> <span>in</span> <span>a</span> <span>multilevel-feedback</span> <span>priority</span> <span>queue</span> <span>system</span>.<span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Time</span> <span>slices</span> <span>are</span> <span>inversely</span> <span>proportional</span> <span>to</span> <span>priority</span> <span>-</span> <span>Higher</span> <span>priority</span> <span>jobs</span> <span>get</span> <span>smaller</span> <span>time</span> <span>slices</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Interactive</span> <span>jobs</span> <span>have</span> <span>higher</span> <span>priority</span> <span>than</span> <span>CPU-Bound</span> <span>ones</span>.<span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>See</span> <span>the</span> <span>table</span> <span>below</span> <span>for</span> <span>some</span> <span>of</span> <span>the</span> <span>60</span> <span>priority</span> <span>levels</span> <span>and</span> <span>how</span> <span>they</span> <span>shift</span>.<span></span> <span>"Time</span> <span>quantum</span> <span>expired"</span> <span>and</span> <span>"return</span> <span>from</span> <span>sleep"</span> <span>indicate</span> <span>the</span> <span>new</span> <span>priority</span> <span>when</span> <span>those</span> <span>events</span> <span>occur</span>.<span></span> <span>(</span> <span>Larger</span> <span>numbers</span> <span>are</span> <span>a</span> <span>higher,</span> <span>i</span>.<span>e</span>.<span></span> <span>better</span> <span>priority</span>.<span></span> <span>)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_23_SolarisDispatchTable.jpg" width="582" height="527"><span></span><br><span>
</span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>23</span> <span>-</span> <span>Solaris</span> <span>dispatch</span> <span>table</span> <span>for</span> <span>time-sharing</span> <span>and</span> <span>interactive</span> <span>threads</span>.<span></span></strong></p>
  <ul>
    <li><span>Solaris</span> <span>9</span> <span>introduced</span> <span>two</span> <span>new</span> <span>scheduling</span> <span>classes:</span> <span>Fixed</span> <span>priority</span> <span>and</span> <span>fair</span> <span>share</span>.<span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Fixed</span> <span>priority</span> <span>is</span> <span>similar</span> <span>to</span> <span>time</span> <span>sharing,</span> <span>but</span> <span>not</span> <span>adjusted</span> <span>dynamically</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Fair</span> <span>share</span> <span>uses</span> <span>shares</span> <span>of</span> <span>CPU</span> <span>time</span> <span>rather</span> <span>than</span> <span>priorities</span> <span>to</span> <span>schedule</span> <span>jobs</span>.<span></span> <span>A</span> <span>certain</span> <span>share</span> <span>of</span> <span>the</span> <span>available</span> <span>CPU</span> <span>time</span> <span>is</span> <span>allocated</span> <span>to</span> <span>a</span> <span>project,</span> <span>which</span> <span>is</span> <span>a</span> <span>set</span> <span>of</span> <span>processes</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>System</span> <span>class</span> <span>is</span> <span>reserved</span> <span>for</span> <span>kernel</span> <span>use</span>.<span></span> <span>(</span> <span>User</span> <span>programs</span> <span>running</span> <span>in</span> <span>kernel</span> <span>mode</span> <span>are</span> <span>NOT</span> <span>considered</span> <span>in</span> <span>the</span> <span>system</span> <span>scheduling</span> <span>class</span>.<span></span> <span>)</span> <span></span> <span></span> </li>
  </ul>
  <blockquote>
    <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_24_SolarisScheduling.jpg" width="460" height="716"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>24</span> <span>-</span> <span>Solaris</span> <span>scheduling</span>.<span></span></strong><span>
</span> <span></span> <span></span> <span></span> </p>
  </blockquote>
</blockquote>
<h3><span>6</span>.<span>8</span> <span>Algorithm</span> <span>Evaluation</span> </h3>
<ul>
  <li><span>The</span> <span>first</span> <span>step</span> <span>in</span> <span>determining</span> <span>which</span> <span>algorithm</span> <span>(</span> <span>and</span> <span>what</span> <span>parameter</span> <span>settings</span> <span>within</span> <span>that</span> <span>algorithm</span> <span>)</span> <span>is</span> <span>optimal</span> <span>for</span> <span>a</span> <span>particular</span> <span>operating</span> <span>environment</span> <span>is</span> <span>to</span> <span>determine</span> <span>what</span> <span>criteria</span> <span>are</span> <span>to</span> <span>be</span> <span>used,</span> <span>what</span> <span>goals</span> <span>are</span> <span>to</span> <span>be</span> <span>targeted,</span> <span>and</span> <span>what</span> <span>constraints</span> <span>if</span> <span>any</span> <span>must</span> <span>be</span> <span>applied</span>.<span></span> <span>For</span> <span>example,</span> <span>one</span> <span>might</span> <span>want</span> <span>to</span> <span>"maximize</span> <span>CPU</span> <span>utilization,</span> <span>subject</span> <span>to</span> <span>a</span> <span>maximum</span> <span>response</span> <span>time</span> <span>of</span> <span>1</span> <span>second"</span>.</li>
  <li><span>Once</span> <span>criteria</span> <span>have</span> <span>been</span> <span>established,</span> <span>then</span> <span>different</span> <span>algorithms</span> <span>can</span> <span>be</span> <span>analyzed</span> <span>and</span> <span>a</span> <span>"best</span> <span>choice"</span> <span>determined</span>.<span></span> <span>The</span> <span>following</span> <span>sections</span> <span>outline</span> <span>some</span> <span>different</span> <span>methods</span> <span>for</span> <span>determining</span> <span>the</span> <span>"best</span> <span>choice"</span>.<span></span> </li>
</ul>
<blockquote>
  <h4><span>6</span>.<span>8</span>.<span>1</span> <span>Deterministic</span> </h4>
  <ul>
    <li><span>If</span> <span>a</span> <span>specific</span> <span>workload</span> <span>is</span> <span>known,</span> <span>then</span> <span>the</span> <span>exact</span> <span>values</span> <span>for</span> <span>major</span> <span>criteria</span> <span>can</span> <span>be</span> <span>fairly</span> <span>easily</span> <span>calculated,</span> <span>and</span> <span>the</span> <span>"best"</span> <span>determined</span>.<span></span> <span>For</span> <span>example,</span> <span>consider</span> <span>the</span> <span>following</span> <span>workload</span> <span>(</span> <span>with</span> <span>all</span> <span>processes</span> <span>arriving</span> <span>at</span> <span>time</span> <span>0</span> <span>),</span> <span>and</span> <span>the</span> <span>resulting</span> <span>schedules</span> <span>determined</span> <span>by</span> <span>three</span> <span>different</span> </li>
  </ul>
  <blockquote>
  <center>
    <table width="400" border="1" cellspacing="5" cellpadding="2">
      <tbody><tr>
        <th scope="col">Process</th>
        <th scope="col">Burst Time </th>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P1</span></div></td>
        <td><span></span><div align="center"><span>10</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P2</span></div></td>
        <td><span></span><div align="center"><span>29</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P3</span></div></td>
        <td><span></span><div align="center"><span>3</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P4</span></div></td>
        <td><span></span><div align="center"><span>7</span></div></td>
      </tr>
      <tr>
        <td><span></span><div align="center"><span>P5</span></div></td>
        <td><span></span><div align="center"><span>12</span></div></td>
      </tr>
    </tbody></table>
    </center>
  <p></p>
  </blockquote>
  <div align="center">
    <table width="600" border="0" cellpadding="10">
    <tbody><tr>
          <td bgcolor="#FFFFFF"><span></span><p><span></span><strong><span>FCFS:</span></strong><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><img src="./4_ CPU Scheduling_files/6_deterministicFCFS.jpg" width="719" height="83"><span></span></p><span>
</span> <span></span> <span></span><p><span></span><strong><span>Non-preemptive</span> <span>SJF:</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><img src="./4_ CPU Scheduling_files/6_deterministicSJF.jpg" width="719" height="83"><span></span></strong><span></span></p><span>
</span> <span></span> <span></span><p><span></span><strong><span>Round</span> <span>Robin:</span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><img src="./4_ CPU Scheduling_files/6_deterministicRoundRobin.jpg" width="716" height="83"><span></span><br><span>
</span> <span></span> <span></span></strong><span></span></p></td>
        </tr>
      </tbody></table>
  </div>
  <ul>
    <li><span>The</span> <span>average</span> <span>waiting</span> <span>times</span> <span>for</span> <span>FCFS,</span> <span>SJF,</span> <span>and</span> <span>RR</span> <span>are</span> <span>28ms,</span> <span>13ms,</span> <span>and</span> <span>23ms</span> <span>respectively</span>.</li>
    <li><span>Deterministic</span> <span>modeling</span> <span>is</span> <span>fast</span> <span>and</span> <span>easy,</span> <span>but</span> <span>it</span> <span>requires</span> <span>specific</span> <span>known</span> <span>input,</span> <span>and</span> <span>the</span> <span>results</span> <span>only</span> <span>apply</span> <span>for</span> <span>that</span> <span>particular</span> <span>set</span> <span>of</span> <span>input</span>.<span></span> <span>However</span> <span>by</span> <span>examining</span> <span>multiple</span> <span>similar</span> <span>cases,</span> <span>certain</span> <span>trends</span> <span>can</span> <span>be</span> <span>observed</span>.<span></span> <span>(</span> <span>Like</span> <span>the</span> <span>fact</span> <span>that</span> <span>for</span> <span>processes</span> <span>arriving</span> <span>at</span> <span>the</span> <span>same</span> <span>time,</span> <span>SJF</span> <span>will</span> <span>always</span> <span>yield</span> <span>the</span> <span>shortest</span> <span>average</span> <span>wait</span> <span>time</span>.<span></span> <span>)</span> </li>
  </ul>
  <h4><span>6</span>.<span>8</span>.<span>2</span> <span>Queuing</span> </h4>
  <ul>
    <li><span>Specific</span> <span></span> <span>process</span> <span>data</span> <span>is</span> <span>often</span> <span>not</span> <span>available,</span> <span>particularly</span> <span>for</span> <span>future</span> <span>times</span>.<span></span> <span>However</span> <span>a</span> <span>study</span> <span>of</span> <span>historical</span> <span>performance</span> <span>can</span> <span>often</span> <span>produce</span> <span>statistical</span> <span>descriptions</span> <span>of</span> <span>certain</span> <span>important</span> <span>parameters,</span> <span>such</span> <span>as</span> <span>the</span> <span>rate</span> <span>at</span> <span>which</span> <span>new</span> <span>processes</span> <span>arrive,</span> <span>the</span> <span>ratio</span> <span>of</span> <span>CPU</span> <span>bursts</span> <span>to</span> <span>I/O</span> <span>times,</span> <span>the</span> <span>distribution</span> <span>of</span> <span>CPU</span> <span>burst</span> <span>times</span> <span>and</span> <span>I/O</span> <span>burst</span> <span>times,</span> <span>etc</span>.</li>
    <li><span>Armed</span> <span>with</span> <span>those</span> <span>probability</span> <span>distributions</span> <span>and</span> <span>some</span> <span>mathematical</span> <span>formulas,</span> <span>it</span> <span>is</span> <span>possible</span> <span>to</span> <span>calculate</span> <span>certain</span> <span>performance</span> <span>characteristics</span> <span>of</span> <span>individual</span> <span>waiting</span> <span>queues</span>.<span></span> <span>For</span> <span>example,</span> <span></span><strong><span>Little's</span> <span>Formula</span></strong><span></span> <span>says</span> <span>that</span> <span>for</span> <span>an</span> <span>average</span> <span>queue</span> <span>length</span> <span>of</span> <span>N,</span> <span>with</span> <span>an</span> <span>average</span> <span>waiting</span> <span>time</span> <span>in</span> <span>the</span> <span>queue</span> <span>of</span> <span>W,</span> <span>and</span> <span>an</span> <span>average</span> <span>arrival</span> <span>of</span> <span>new</span> <span>jobs</span> <span>in</span> <span>the</span> <span>queue</span> <span>of</span> <span>Lambda,</span> <span>then</span> <span>these</span> <span>three</span> <span>terms</span> <span>can</span> <span>be</span> <span>related</span> </li>
  </ul>
  <blockquote>
    <p align="center"><span>N</span> <span>=</span> <span>Lambda</span> <span>*</span> </p>
  </blockquote>
  <ul>
    <li><span>Queuing</span> <span>models</span> <span>treat</span> <span>the</span> <span>computer</span> <span>as</span> <span>a</span> <span>network</span> <span>of</span> <span>interconnected</span> <span>queues,</span> <span>each</span> <span>of</span> <span>which</span> <span>is</span> <span>described</span> <span>by</span> <span>its</span> <span>probability</span> <span>distribution</span> <span>statistics</span> <span>and</span> <span>formulas</span> <span>such</span> <span>as</span> <span>Little's</span> <span>formula</span>.<span></span> <span></span> <span></span> <span>Unfortunately</span> <span>real</span> <span>systems</span> <span>and</span> <span>modern</span> <span>scheduling</span> <span>algorithms</span> <span>are</span> <span>so</span> <span>complex</span> <span>as</span> <span>to</span> <span>make</span> <span>the</span> <span>mathematics</span> <span>intractable</span> <span>in</span> <span>many</span> <span>cases</span> <span>with</span> <span>real</span> <span>systems</span>.<span></span> </li>
  </ul>
  <h4><span>6</span>.<span>8</span>.<span>3</span> </h4>
  <ul>
    <li><span>Another</span> <span>approach</span> <span>is</span> <span>to</span> <span>run</span> <span>computer</span> <span>simulations</span> <span>of</span> <span>the</span> <span>different</span> <span>proposed</span> <span>algorithms</span> <span>(</span> <span>and</span> <span>adjustment</span> <span>parameters</span> <span>)</span> <span>under</span> <span>different</span> <span>load</span> <span>conditions,</span> <span>and</span> <span>to</span> <span>analyze</span> <span>the</span> <span>results</span> <span>to</span> <span>determine</span> <span>the</span> <span>"best"</span> <span>choice</span> <span>of</span> <span>operation</span> <span>for</span> <span>a</span> <span>particular</span> <span>load</span> <span>pattern</span>.</li>
    <li><span>Operating</span> <span>conditions</span> <span>for</span> <span>simulations</span> <span>are</span> <span>often</span> <span>randomly</span> <span>generated</span> <span>using</span> <span>distribution</span> <span>functions</span> <span>similar</span> <span>to</span> <span>those</span> <span>described</span> <span>above</span>.</li>
    <li><span>A</span> <span>better</span> <span>alternative</span> <span>when</span> <span>possible</span> <span>is</span> <span>to</span> <span>generate</span> <span></span><em><span></span><strong><span>trace</span> <span>tapes</span></strong><span></span></em><span>,</span> <span>by</span> <span>monitoring</span> <span>and</span> <span>logging</span> <span>the</span> <span>performance</span> <span>of</span> <span>a</span> <span>real</span> <span>system</span> <span>under</span> <span>typical</span> <span>expected</span> <span>work</span> <span>loads</span>.<span></span> <span>These</span> <span>are</span> <span>better</span> <span>because</span> <span>they</span> <span>provide</span> <span>a</span> <span>more</span> <span>accurate</span> <span>picture</span> <span>of</span> <span>system</span> <span>loads,</span> <span>and</span> <span>also</span> <span>because</span> <span>they</span> <span>allow</span> <span>multiple</span> <span>simulations</span> <span>to</span> <span>be</span> <span>run</span> <span>with</span> <span>the</span> <span>identical</span> <span>process</span> <span>load,</span> <span>and</span> <span>not</span> <span>just</span> <span>statistically</span> <span>equivalent</span> <span>loads</span>.<span></span> <span>A</span> <span>compromise</span> <span>is</span> <span>to</span> <span>randomly</span> <span>determine</span> <span>system</span> <span>loads</span> <span>and</span> <span>then</span> <span>save</span> <span>the</span> <span>results</span> <span>into</span> <span>a</span> <span>file,</span> <span>so</span> <span>that</span> <span>all</span> <span>simulations</span> <span>can</span> <span>be</span> <span>run</span> <span>against</span> <span>identical</span> <span>randomly</span> <span>determined</span> <span>system</span> <span>loads</span>.<span></span> </li>
    <li><span>Although</span> <span>trace</span> <span>tapes</span> <span>provide</span> <span>more</span> <span>accurate</span> <span>input</span> <span>information,</span> <span>they</span> <span>can</span> <span>be</span> <span>difficult</span> <span>and</span> <span>expensive</span> <span>to</span> <span>collect</span> <span>and</span> <span>store,</span> <span>and</span> <span>their</span> <span>use</span> <span>increases</span> <span>the</span> <span>complexity</span> <span>of</span> <span>the</span> <span>simulations</span> <span>significantly</span>.<span></span> <span>There</span> <span>is</span> <span>also</span> <span>some</span> <span>question</span> <span>as</span> <span>to</span> <span>whether</span> <span>the</span> <span>future</span> <span>performance</span> <span>of</span> <span>the</span> <span>new</span> <span>system</span> <span>will</span> <span>really</span> <span>match</span> <span>the</span> <span>past</span> <span>performance</span> <span>of</span> <span>the</span> <span>old</span> <span>system</span>.<span></span> <span>(</span> <span>If</span> <span>the</span> <span>system</span> <span>runs</span> <span>faster,</span> <span>users</span> <span>may</span> <span>take</span> <span>fewer</span> <span>coffee</span> <span>breaks,</span> <span>and</span> <span>submit</span> <span>more</span> <span>processes</span> <span>per</span> <span>hour</span> <span>than</span> <span>under</span> <span>the</span> <span>old</span> <span>system</span>.<span></span> <span>Conversely</span> <span>if</span> <span>the</span> <span>turnaround</span> <span>time</span> <span>for</span> <span>jobs</span> <span>is</span> <span>longer,</span> <span>intelligent</span> <span>users</span> <span>may</span> <span>think</span> <span>more</span> <span>carefully</span> <span>about</span> <span>the</span> <span>jobs</span> <span>they</span> <span>submit</span> <span>rather</span> <span>than</span> <span>randomly</span> <span>submitting</span> <span>jobs</span> <span>and</span> <span>hoping</span> <span>that</span> <span>one</span> <span>of</span> <span>them</span> <span>works</span> <span>out</span>.<span></span> <span>)</span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./4_ CPU Scheduling_files/6_25_SchedulerSimulation.jpg" width="742" height="463"><span></span><br><span>
</span> <span></span> <span></span><strong><span>Figure</span> <span>6</span>.<span>25</span> <span>-</span> <span>Evaluation</span> <span>of</span> <span>CPU</span> <span>schedulers</span> <span>by</span> <span>simulation</span>.<span></span></strong></p>
  <h4><span>6</span>.<span>8</span>.<span>4</span> <span>Implementation</span> </h4>
  <ul>
    <li><span>The</span> <span>only</span> <span>real</span> <span>way</span> <span>to</span> <span>determine</span> <span>how</span> <span>a</span> <span>proposed</span> <span>scheduling</span> <span>algorithm</span> <span>is</span> <span>going</span> <span>to</span> <span>operate</span> <span>is</span> <span>to</span> <span>implement</span> <span>it</span> <span>on</span> <span>a</span> <span>real</span> <span>system</span>.</li>
    <li><span>For</span> <span>experimental</span> <span>algorithms</span> <span>and</span> <span>those</span> <span>under</span> <span>development,</span> <span>this</span> <span>can</span> <span>cause</span> <span>difficulties</span> <span>and</span> <span>resistance</span> <span>among</span> <span>users</span> <span>who</span> <span>don't</span> <span>care</span> <span>about</span> <span>developing</span> <span>OSes</span> <span>and</span> <span>are</span> <span>only</span> <span>trying</span> <span>to</span> <span>get</span> <span>their</span> <span>daily</span> <span>work</span> <span>done</span>.</li>
    <li><span>Even</span> <span>in</span> <span>this</span> <span>case,</span> <span>the</span> <span>measured</span> <span>results</span> <span>may</span> <span>not</span> <span>be</span> <span>definitive,</span> <span>for</span> <span>at</span> <span>least</span> <span>two</span> <span>major</span> <span>reasons:</span> <span>(1)</span> <span>System</span> <span>work</span> <span>loads</span> <span>are</span> <span>not</span> <span>static,</span> <span>but</span> <span>change</span> <span>over</span> <span>time</span> <span>as</span> <span>new</span> <span>programs</span> <span>are</span> <span>installed,</span> <span>new</span> <span>users</span> <span>are</span> <span>added</span> <span>to</span> <span>the</span> <span>system,</span> <span>new</span> <span>hardware</span> <span>becomes</span> <span>available,</span> <span>new</span> <span>work</span> <span>projects</span> <span>get</span> <span>started,</span> <span>and</span> <span>even</span> <span>societal</span> <span>changes</span>.<span></span> <span>(</span> <span>For</span> <span>example</span> <span>the</span> <span>explosion</span> <span>of</span> <span>the</span> <span>Internet</span> <span>has</span> <span>drastically</span> <span>changed</span> <span>the</span> <span>amount</span> <span>of</span> <span>network</span> <span>traffic</span> <span>that</span> <span>a</span> <span>system</span> <span>sees</span> <span>and</span> <span>the</span> <span>importance</span> <span>of</span> <span>handling</span> <span>it</span> <span>with</span> <span>rapid</span> <span>response</span> <span>times</span>.<span></span> <span>)</span> <span>(2)</span> <span>As</span> <span>mentioned</span> <span>above,</span> <span>changing</span> <span>the</span> <span>scheduling</span> <span>system</span> <span>may</span> <span>have</span> <span>an</span> <span>impact</span> <span>on</span> <span>the</span> <span>work</span> <span>load</span> <span>and</span> <span>the</span> <span>ways</span> <span>in</span> <span>which</span> <span>users</span> <span>use</span> <span>the</span> <span>system</span>.<span></span> <span>(</span> <span>The</span> <span>book</span> <span>gives</span> <span>an</span> <span>example</span> <span>of</span> <span>a</span> <span>programmer</span> <span>who</span> <span>modified</span> <span>his</span> <span>code</span> <span>to</span> <span>write</span> <span>an</span> <span>arbitrary</span> <span>character</span> <span>to</span> <span>the</span> <span>screen</span> <span>at</span> <span>regular</span> <span>intervals,</span> <span>just</span> <span>so</span> <span>his</span> <span>job</span> <span>would</span> <span>be</span> <span>classified</span> <span>as</span> <span>interactive</span> <span>and</span> <span>placed</span> <span>into</span> <span>a</span> <span>higher</span> <span>priority</span> <span>queue</span>.<span></span> </li>
    <li><span>Most</span> <span>modern</span> <span>systems</span> <span>provide</span> <span>some</span> <span>capability</span> <span>for</span> <span>the</span> <span>system</span> <span>administrator</span> <span>to</span> <span>adjust</span> <span>scheduling</span> <span>parameters,</span> <span>either</span> <span>on</span> <span>the</span> <span>fly</span> <span>or</span> <span>as</span> <span>the</span> <span>result</span> <span>of</span> <span>a</span> <span>reboot</span> <span>or</span> <span>a</span> <span>kernel</span> <span>rebuild</span>.<span></span> <span></span> </li>
  </ul>
</blockquote>
<h3><span>6</span>.<span>9</span> <span>Summary</span> </h3>
<hr>
<h3><span>Material</span> <span>Omitted</span> <span>from</span> <span>the</span> <span>Eighth</span> </h3>
<h4><span>Was</span> <span>5</span>.<span>4</span>.<span>4</span> <span>Symmetric</span> <span>Multithreading</span> <span>(</span> <span>Omitted</span> <span>from</span> <span>8th</span> <span>edition</span> </h4>
<ul>
  <li><span>An</span> <span>alternative</span> <span>strategy</span> <span>to</span> <span>SMP</span> <span>is</span><em><span></span><strong><span></span> <span>SMT,</span> <span>Symmetric</span> <span>Multi-Threading,</span> <span></span></strong><span></span></em><span>in</span> <span>which</span> <span>multiple</span> <span>virtual</span> <span>(</span> <span>logical</span> <span>)</span> <span>CPUs</span> <span>are</span> <span>used</span> <span>instead</span> <span>of</span> <span>(</span> <span>or</span> <span>in</span> <span>combination</span> <span>with</span> <span>)</span> <span>multiple</span> <span>physical</span> <span>CPUs</span>.<span></span> </li>
  <li><span>SMT</span> <span>must</span> <span>be</span> <span>supported</span> <span>in</span> <span>hardware,</span> <span>as</span> <span>each</span> <span>logical</span> <span>CPU</span> <span>has</span> <span>its</span> <span>own</span> <span>registers</span> <span>and</span> <span>handles</span> <span>its</span> <span>own</span> <span>interrupts</span>.<span></span> <span>(</span> <span>Intel</span> <span>refers</span> <span>to</span> <span>SMT</span> <span>as</span> <span></span><em><span></span><strong><span>hyperthreading</span> <span>technology</span>.<span></span> <span>)</span> <span></span></strong><span></span></em></li>
  <li><span>To</span> <span>some</span> <span>extent</span> <span>the</span> <span>OS</span> <span>does</span> <span>not</span> <span>need</span> <span>to</span> <span>know</span> <span>if</span> <span>the</span> <span>processors</span> <span>it</span> <span>is</span> <span>managing</span> <span>are</span> <span>real</span> <span>or</span> <span>virtual</span>.<span></span> <span>On</span> <span>the</span> <span>other</span> <span>hand,</span> <span>some</span> <span>scheduling</span> <span>decisions</span> <span>can</span> <span>be</span> <span>optimized</span> <span>if</span> <span>the</span> <span>scheduler</span> <span>knows</span> <span>the</span> <span>mapping</span> <span>of</span> <span>virtual</span> <span>processors</span> <span>to</span> <span>real</span> <span>CPUs</span>.<span></span> <span>(</span> <span>Consider</span> <span>the</span> <span>scheduling</span> <span>of</span> <span>two</span> <span>CPU-intensive</span> <span>processes</span> <span>on</span> <span>the</span> <span>architecture</span> <span>shown</span> <span>below</span>.<span></span> <span>)</span> </li>
</ul>
<p align="center"><span></span><img src="./4_ CPU Scheduling_files/5_08B_SMT_Architecture.jpg" width="588" height="290"><span></span><br><span>
</span> <span></span> <span>omitted</span> </p>
<p></p>


</body><script src="./4_ CPU Scheduling_files/jquery.min.js.download"></script><script>function makeSpans(){$("h1, h2, h3, h4, h5, h6, p, li, td, img").each(function(){var s=splitText($(this).html());$(this).empty();for(var a="",h=0;h<s.length;h++)a+=s[h];$(this).html(a)})}function splitText(s){for(var a=[],h="",e=0;e<s.length;e++)if("<"===s.charAt(e)){a.push("<span>"+h+"</span>"),h="<";var i=1;do e++,"<"===s.charAt(e)&&i++,">"===s.charAt(e)&&i--,h+=s.charAt(e);while(i>0);console.log(h),a.push(h),h=""}else" "!=s.charAt(e)&&"."!=s.charAt(e)?h+=s.charAt(e):(console.log(h),a.push("<span>"+h+"</span>"),h="",a.push(""+s.charAt(e)));return a}$(document).ready(function(){makeSpans(),$("BODY").addClass("whiteBG"),$("span").on("click",function(){$(this).hasClass("hideWord")?($(this).removeClass("hideWord hoverOver"),$(this).addClass("hideWord2")):$(this).hasClass("hideWord2")?$(this).removeClass("hideWord2"):$(this).addClass("hideWord")}),$("span").hover(function(){$(this).hasClass("hideWord")&&$(this).addClass("hoverOver")},function(){$(this).removeClass("hoverOver")}),$("img").on("click",function(){$(this).hasClass("imageHide")?($(this).removeClass("imageHide"),$(this).addClass("imageReveal")):$(this).addClass("imageHide")}),$("img").hover(function(){$(this).hasClass("imageHide")&&$(this).addClass("imageReveal")},function(){$(this).removeClass("imageReveal")})});</script></html>