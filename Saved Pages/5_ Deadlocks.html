
<!-- saved from url=(0075)https://www.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/7_Deadlocks.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="GENERATOR" content="Adobe PageMill 3.0 Win">
  <title>Operating Systems: Deadlocks</title><style>.hideWord{color:blue;background-color:blue}.hideWord2{color:white;background-color:white}.hoverOver{color:red;opacity:1;background-color:white}.whiteBG{background-color:white!important}.imageHide{opacity:0.02!important}.imageReveal{opacity:1.0!important}.imageReveal:parent{background-color:white!important}.imageHide:parent{background-color:blue!important}</style></head>
<body bgcolor="#ffff80" class="whiteBG">

<h1><span></span><center><span>
</span> <span></span> <span>Deadlocks
</span></center></h1>

<h3></h3>

<ol>
  <li><span>Abraham</span> <span>Silberschatz,</span> <span>Greg</span> <span>Gagne,</span> <span>and</span> <span>Peter</span> <span>Baer</span> <span>Galvin,</span> <span>"Operating</span> <span>System</span> <span>Concepts,</span> <span>Ninth</span> <span>Edition</span> <span>",</span> <span>Chapter</span> </li></ol>

<h3><span>7</span>.<span>1</span> <span>System</span> </h3>
<ul>
  <li><span>For</span> <span>the</span> <span>purposes</span> <span>of</span> <span>deadlock</span> <span>discussion,</span> <span>a</span> <span>system</span> <span>can</span> <span>be</span> <span>modeled</span> <span>as</span> <span>a</span> <span>collection</span> <span>of</span> <span>limited</span> <span>resources,</span> <span>which</span> <span>can</span> <span>be</span> <span>partitioned</span> <span>into</span> <span>different</span> <span>categories,</span> <span>to</span> <span>be</span> <span>allocated</span> <span>to</span> <span>a</span> <span>number</span> <span>of</span> <span>processes,</span> <span>each</span> <span>having</span> <span>different</span> <span>needs</span>.</li>
  <li><span>Resource</span> <span>categories</span> <span>may</span> <span>include</span> <span>memory,</span> <span>printers,</span> <span>CPUs,</span> <span>open</span> <span>files,</span> <span>tape</span> <span>drives,</span> <span>CD-ROMS,</span> <span>etc</span>.<span></span> </li>
  <li><span>By</span> <span>definition,</span> <span>all</span> <span>the</span> <span>resources</span> <span>within</span> <span>a</span> <span>category</span> <span>are</span> <span>equivalent,</span> <span>and</span> <span>a</span> <span>request</span> <span>of</span> <span>this</span> <span>category</span> <span>can</span> <span>be</span> <span>equally</span> <span>satisfied</span> <span>by</span> <span>any</span> <span>one</span> <span>of</span> <span>the</span> <span>resources</span> <span>in</span> <span>that</span> <span>category</span>.<span></span> <span></span> <span>If</span> <span>this</span> <span>is</span> <span>not</span> <span>the</span> <span>case</span> <span>(&nbsp;i</span>.<span>e</span>.<span></span> <span>if</span> <span>there</span> <span>is</span> <span>some</span> <span>difference</span> <span>between</span> <span>the</span> <span>resources</span> <span>within</span> <span>a</span> <span>category</span> <span>),</span> <span>then</span> <span>that</span> <span>category</span> <span>needs</span> <span>to</span> <span>be</span> <span>further</span> <span>divided</span> <span>into</span> <span>separate</span> <span>categories</span>.<span></span> <span>For</span> <span>example,</span> <span>"printers"</span> <span>may</span> <span>need</span> <span>to</span> <span>be</span> <span>separated</span> <span>into</span> <span>"laser</span> <span>printers"</span> <span>and</span> <span>"color</span> <span>inkjet</span> <span>printers"</span>.</li>
  <li><span>Some</span> <span>categories</span> <span>may</span> <span>have</span> <span>a</span> <span>single</span> <span>resource</span>.</li>
  <li><span>In</span> <span>normal</span> <span>operation</span> <span>a</span> <span>process</span> <span>must</span> <span>request</span> <span>a</span> <span>resource</span> <span>before</span> <span>using</span> <span>it,</span> <span>and</span> <span>release</span> <span>it</span> <span>when</span> <span>it</span> <span>is</span> <span>done,</span> <span>in</span> <span>the</span> <span>following</span> <span>sequence:
</span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Request</span> <span>-</span> <span>If</span> <span>the</span> <span>request</span> <span>cannot</span> <span>be</span> <span>immediately</span> <span>granted,</span> <span>then</span> <span>the</span> <span>process</span> <span>must</span> <span>wait</span> <span>until</span> <span>the</span> <span>resource(s)</span> <span>it</span> <span>needs</span> <span>become</span> <span>available</span>.<span></span> <span>For</span> <span>example</span> <span>the</span> <span>system</span> <span>calls</span> <span>open(&nbsp;),</span> <span>malloc(&nbsp;),</span> <span>new(&nbsp;),</span> <span>and</span> <span>request(&nbsp;)</span>.<span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Use</span> <span>-</span> <span>The</span> <span>process</span> <span>uses</span> <span>the</span> <span>resource,</span> <span>e</span>.<span>g</span>.<span></span> <span>prints</span> <span>to</span> <span>the</span> <span>printer</span> <span>or</span> <span>reads</span> <span>from</span> <span>the</span> <span>file</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Release</span> <span>-</span> <span>The</span> <span>process</span> <span>relinquishes</span> <span>the</span> <span>resource</span>.<span></span> <span>so</span> <span>that</span> <span>it</span> <span>becomes</span> <span>available</span> <span>for</span> <span>other</span> <span>processes</span>.<span></span> <span>For</span> <span>example,</span> <span>close(&nbsp;),</span> <span>free(&nbsp;),</span> <span>delete(&nbsp;),</span> <span>and</span> <span>release(&nbsp;)</span>.<span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> </li>
  <li><span>For</span> <span>all</span> <span>kernel-managed</span> <span>resources,</span> <span>the</span> <span>kernel</span> <span>keeps</span> <span>track</span> <span>of</span> <span>what</span> <span>resources</span> <span>are</span> <span>free</span> <span>and</span> <span>which</span> <span>are</span> <span>allocated,</span> <span>to</span> <span>which</span> <span>process</span> <span>they</span> <span>are</span> <span>allocated,</span> <span>and</span> <span>a</span> <span>queue</span> <span>of</span> <span>processes</span> <span>waiting</span> <span>for</span> <span>this</span> <span>resource</span> <span>to</span> <span>become</span> <span>available</span>.<span></span> <span>Application-managed</span> <span>resources</span> <span>can</span> <span>be</span> <span>controlled</span> <span>using</span> <span>mutexes</span> <span>or</span> <span>wait(</span> <span>)</span> <span>and</span> <span>signal(</span> <span>)</span> <span>calls,</span> <span>(</span> <span>i</span>.<span>e</span>.<span></span> <span>binary</span> <span>or</span> <span>counting</span> <span>semaphores</span>.<span></span> </li>
  <li><span>A</span> <span>set</span> <span>of</span> <span>processes</span> <span>is</span> <span>deadlocked</span> <span>when</span> <span>every</span> <span>process</span> <span>in</span> <span>the</span> <span>set</span> <span>is</span> <span>waiting</span> <span>for</span> <span>a</span> <span>resource</span> <span>that</span> <span>is</span> <span>currently</span> <span>allocated</span> <span>to</span> <span>another</span> <span>process</span> <span>in</span> <span>the</span> <span>set</span> <span>(</span> <span>and</span> <span>which</span> <span>can</span> <span>only</span> <span>be</span> <span>released</span> <span>when</span> <span>that</span> <span>other</span> <span>waiting</span> <span>process</span> <span>makes</span> <span>progress</span>.<span></span> <span>)</span> <span></span> <span></span> <span></span> </li>
</ul>
<h3><span>7</span>.<span>2</span> <span>Deadlock</span> </h3>
<p align="center"><span></span><img src="./5_ Deadlocks_files/7_DeadlockWithMutexLocks.jpg" width="736" height="1565"><span></span><br><span>
</span> <span></span> <span></span><strong><span>New</span> <span>Sidebar</span> <span>in</span> <span>Ninth</span> <span>Edition</span></strong></p>
<blockquote>
  <h4><span>7</span>.<span>2</span>.<span>1</span> <span>Necessary</span> </h4>
  <ul>
    <li><span>There</span> <span>are</span> <span>four</span> <span>conditions</span> <span>that</span> <span>are</span> <span>necessary</span> <span>to</span> <span>achieve</span> <span>deadlock:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Mutual</span> <span>Exclusion</span></strong><span></span> <span>-</span> <span>At</span> <span>least</span> <span>one</span> <span>resource</span> <span>must</span> <span>be</span> <span>held</span> <span>in</span> <span>a</span> <span>non-sharable</span> <span>mode;</span> <span>If</span> <span>any</span> <span>other</span> <span>process</span> <span>requests</span> <span>this</span> <span>resource,</span> <span>then</span> <span>that</span> <span>process</span> <span>must</span> <span>wait</span> <span>for</span> <span>the</span> <span>resource</span> <span>to</span> <span>be</span> <span>released</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Hold</span> <span>and</span> <span>Wait</span></strong><span></span> <span>-</span> <span>A</span> <span>process</span> <span>must</span> <span>be</span> <span>simultaneously</span> <span>holding</span> <span>at</span> <span>least</span> <span>one</span> <span>resource</span> <span>and</span> <span>waiting</span> <span>for</span> <span>at</span> <span>least</span> <span>one</span> <span>resource</span> <span>that</span> <span>is</span> <span>currently</span> <span>being</span> <span>held</span> <span>by</span> <span>some</span> <span>other</span> <span>process</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>No</span> <span>preemption</span></strong><span></span> <span>-</span> <span>Once</span> <span>a</span> <span>process</span> <span>is</span> <span>holding</span> <span>a</span> <span>resource</span> <span>(</span> <span>i</span>.<span>e</span>.<span></span> <span>once</span> <span>its</span> <span>request</span> <span>has</span> <span>been</span> <span>granted</span> <span>),</span> <span>then</span> <span>that</span> <span>resource</span> <span>cannot</span> <span>be</span> <span>taken</span> <span>away</span> <span>from</span> <span>that</span> <span>process</span> <span>until</span> <span>the</span> <span>process</span> <span>voluntarily</span> <span>releases</span> <span>it</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Circular</span> <span>Wait</span></strong><span></span> <span>-</span> <span>A</span> <span>set</span> <span>of</span> <span>processes</span> <span>{</span> <span>P0,</span> <span>P1,</span> <span>P2,</span> <span></span>.<span></span> <span></span>.<span></span> <span></span>.<span>,</span> <span>PN</span> <span>}</span> <span>must</span> <span>exist</span> <span>such</span> <span>that</span> <span>every</span> <span>P[</span> <span>i</span> <span>]</span> <span>is</span> <span>waiting</span> <span>for</span> <span>P[</span> <span>(</span> <span>i</span> <span>+</span> <span>1</span> <span>)</span> <span>%</span> <span>(</span> <span>N</span> <span>+</span> <span>1</span> <span>)</span> <span>]</span>.<span></span> <span>(</span> <span>Note</span> <span>that</span> <span>this</span> <span>condition</span> <span>implies</span> <span>the</span> <span>hold-and-wait</span> <span>condition,</span> <span>but</span> <span>it</span> <span>is</span> <span>easier</span> <span>to</span> <span>deal</span> <span>with</span> <span>the</span> <span>conditions</span> <span>if</span> <span>the</span> <span>four</span> <span>are</span> <span>considered</span> <span>separately</span>.<span></span> <span>)</span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <h4><span>7</span>.<span>2</span>.<span>2</span> <span>Resource-Allocation</span> </h4>
  <ul>
    <li><span>In</span> <span>some</span> <span>cases</span> <span>deadlocks</span> <span>can</span> <span>be</span> <span>understood</span> <span>more</span> <span>clearly</span> <span>through</span> <span>the</span> <span>use</span> <span>of</span> <span></span><strong><span>Resource-Allocation</span> <span>Graphs</span></strong><span>,</span> <span>having</span> <span>the</span> <span>following</span> <span>properties:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>A</span> <span>set</span> <span>of</span> <span>resource</span> <span>categories,</span> <span>{</span> <span>R1,</span> <span>R2,</span> <span>R3,</span> <span></span>.<span></span> <span></span>.<span></span> <span></span>.<span>,</span> <span>RN</span> <span>},</span> <span>which</span> <span>appear</span> <span>as</span> <span>square</span> <span>nodes</span> <span>on</span> <span>the</span> <span>graph</span>.<span></span> <span>Dots</span> <span>inside</span> <span>the</span> <span>resource</span> <span>nodes</span> <span>indicate</span> <span>specific</span> <span>instances</span> <span>of</span> <span>the</span> <span>resource</span>.<span></span> <span>(</span> <span>E</span>.<span>g</span>.<span></span> <span>two</span> <span>dots</span> <span>might</span> <span>represent</span> <span>two</span> <span>laser</span> <span>printers</span>.<span></span> <span>)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>A</span> <span>set</span> <span>of</span> <span>processes,</span> <span>{</span> <span>P1,</span> <span>P2,</span> <span>P3,</span> <span></span> <span></span>.<span></span> <span></span>.<span></span> <span></span>.<span>,</span> <span>PN</span> <span>}</span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Request</span> <span>Edges</span> <span>-</span> <span></span></strong><span>A</span> <span>set</span> <span>of</span> <span>directed</span> <span>arcs</span> <span>from</span> <span>Pi</span> <span>to</span> <span>Rj,</span> <span>indicating</span> <span>that</span> <span>process</span> <span>Pi</span> <span>has</span> <span>requested</span> <span>Rj,</span> <span>and</span> <span>is</span> <span>currently</span> <span>waiting</span> <span>for</span> <span>that</span> <span>resource</span> <span>to</span> <span>become</span> <span>available</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Assignment</span> <span>Edges</span> <span>-</span> <span></span></strong><span>A</span> <span>set</span> <span>of</span> <span>directed</span> <span>arcs</span> <span>from</span> <span>Rj</span> <span>to</span> <span>Pi</span> <span>indicating</span> <span>that</span> <span>resource</span> <span>Rj</span> <span>has</span> <span>been</span> <span>allocated</span> <span>to</span> <span>process</span> <span>Pi,</span> <span>and</span> <span>that</span> <span>Pi</span> <span>is</span> <span>currently</span> <span>holding</span> <span>resource</span> <span>Rj</span>.<span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Note</span> <span>that</span> <span>a</span> <span></span><strong><span>request</span> <span>edge</span></strong><span></span> <span>can</span> <span>be</span> <span>converted</span> <span>into</span> <span>an</span> <span></span><strong><span>assignment</span> <span>edge</span></strong><span></span> <span>by</span> <span>reversing</span> <span>the</span> <span>direction</span> <span>of</span> <span>the</span> <span>arc</span> <span>when</span> <span>the</span> <span>request</span> <span>is</span> <span>granted</span>.<span></span> <span>(&nbsp;However</span> <span>note</span> <span>also</span> <span>that</span> <span>request</span> <span>edges</span> <span>point</span> <span>to</span> <span>the</span> <span>category</span> <span>box,</span> <span>whereas</span> <span>assignment</span> <span>edges</span> <span>emanate</span> <span>from</span> <span>a</span> <span>particular</span> <span>instance</span> <span>dot</span> <span>within</span> <span>the</span> <span>box</span>.<span>&nbsp;)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>For</span> <span>example:</span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./5_ Deadlocks_files/7_01_ResourceAllocation.jpg" width="250" height="360"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>7</span>.<span>1</span> <span>-</span> <span>Resource</span> <span>allocation</span> <span>graph</span></strong><span>
</span> <span></span> </p>
  <ul>
    <li><span>If</span> <span>a</span> <span>resource-allocation</span> <span>graph</span> <span>contains</span> <span>no</span> <span>cycles,</span> <span>then</span> <span>the</span> <span>system</span> <span>is</span> <span>not</span> <span>deadlocked</span>.<span></span> <span>(</span> <span>When</span> <span>looking</span> <span>for</span> <span>cycles,</span> <span>remember</span> <span>that</span> <span>these</span> <span>are</span> <span></span><em><span></span><strong><span>directed</span></strong><span></span></em><span></span> <span>graphs</span>.<span></span> <span>)</span> <span>See</span> <span>the</span> <span>example</span> <span>in</span> <span>Figure</span> <span>7</span>.<span>2</span> <span>above</span>.<span></span> </li>
    <li><span>If</span> <span>a</span> <span>resource-allocation</span> <span>graph</span> <span>does</span> <span>contain</span> <span>cycles</span> <span></span><strong><span>AND</span></strong><span></span> <span>each</span> <span>resource</span> <span>category</span> <span>contains</span> <span>only</span> <span>a</span> <span>single</span> <span>instance,</span> <span>then</span> <span>a</span> <span>deadlock</span> <span>exists</span>.</li>
    <li><span>If</span> <span>a</span> <span>resource</span> <span>category</span> <span>contains</span> <span>more</span> <span>than</span> <span>one</span> <span>instance,</span> <span>then</span> <span>the</span> <span>presence</span> <span>of</span> <span>a</span> <span>cycle</span> <span>in</span> <span>the</span> <span>resource-allocation</span> <span>graph</span> <span>indicates</span> <span>the</span> <span></span><em><span>possibility</span></em><span></span> <span>of</span> <span>a</span> <span>deadlock,</span> <span>but</span> <span>does</span> <span>not</span> <span>guarantee</span> <span>one</span>.<span></span> <span>Consider,</span> <span>for</span> <span>example,</span> <span>Figures</span> <span>7</span>.<span>3</span> <span>and</span> <span>7</span>.<span>4</span> <span>below:</span> </li>
  </ul>
  <p align="center"><span></span><img src="./5_ Deadlocks_files/7_02_Deadlock.jpg" width="250" height="360"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>7</span>.<span>2</span> <span>-</span> <span>Resource</span> <span>allocation</span> <span>graph</span> <span>with</span> <span>a</span> <span>deadlock</span></strong><span>
</span> <span></span> </p>
  <p align="center"><span></span><img src="./5_ Deadlocks_files/7_03_CycleNoDeadlock.jpg" width="275" height="346"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>7</span>.<span>3</span> <span>-</span> <span>Resource</span> <span>allocation</span> <span>graph</span> <span>with</span> <span>a</span> <span>cycle</span> <span>but</span> <span>no</span> <span>deadlock</span></strong><span>
</span> <span></span> </p>
</blockquote>
<h3><span>7</span>.<span>3</span> <span>Methods</span> <span>for</span> <span>Handling</span> </h3>
<ul>
  <li><span>Generally</span> <span>speaking</span> <span>there</span> <span>are</span> <span>three</span> <span>ways</span> <span>of</span> <span>handling</span> <span>deadlocks:
</span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Deadlock</span> <span>prevention</span> <span>or</span> <span>avoidance</span> <span>-</span> <span>Do</span> <span>not</span> <span>allow</span> <span>the</span> <span>system</span> <span>to</span> <span>get</span> <span>into</span> <span>a</span> <span>deadlocked</span> <span>state</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Deadlock</span> <span>detection</span> <span>and</span> <span>recovery</span> <span>-</span> <span>Abort</span> <span>a</span> <span>process</span> <span>or</span> <span>preempt</span> <span>some</span> <span>resources</span> <span>when</span> <span>deadlocks</span> <span>are</span> <span>detected</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Ignore</span> <span>the</span> <span>problem</span> <span>all</span> <span>together</span> <span>-</span> <span>If</span> <span>deadlocks</span> <span>only</span> <span>occur</span> <span>once</span> <span>a</span> <span>year</span> <span>or</span> <span>so,</span> <span>it</span> <span>may</span> <span>be</span> <span>better</span> <span>to</span> <span>simply</span> <span>let</span> <span>them</span> <span>happen</span> <span>and</span> <span>reboot</span> <span>as</span> <span>necessary</span> <span>than</span> <span>to</span> <span>incur</span> <span>the</span> <span>constant</span> <span>overhead</span> <span>and</span> <span>system</span> <span>performance</span> <span>penalties</span> <span>associated</span> <span>with</span> <span>deadlock</span> <span>prevention</span> <span>or</span> <span>detection</span>.<span></span> <span>This</span> <span>is</span> <span>the</span> <span>approach</span> <span>that</span> <span>both</span> <span>Windows</span> <span>and</span> <span>UNIX</span> <span>take</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> </li>
  <li><span>In</span> <span>order</span> <span>to</span> <span>avoid</span> <span>deadlocks,</span> <span>the</span> <span>system</span> <span>must</span> <span>have</span> <span>additional</span> <span>information</span> <span>about</span> <span>all</span> <span>processes</span>.<span></span> <span>In</span> <span>particular,</span> <span>the</span> <span>system</span> <span>must</span> <span>know</span> <span>what</span> <span>resources</span> <span>a</span> <span>process</span> <span>will</span> <span>or</span> <span>may</span> <span>request</span> <span>in</span> <span>the</span> <span>future</span>.<span></span> <span>(</span> <span>Ranging</span> <span>from</span> <span>a</span> <span>simple</span> <span>worst-case</span> <span>maximum</span> <span>to</span> <span>a</span> <span>complete</span> <span>resource</span> <span>request</span> <span>and</span> <span>release</span> <span>plan</span> <span>for</span> <span>each</span> <span>process,</span> <span>depending</span> <span>on</span> <span>the</span> <span>particular</span> <span>algorithm</span>.<span></span> </li>
  <li><span>Deadlock</span> <span>detection</span> <span>is</span> <span>fairly</span> <span>straightforward,</span> <span>but</span> <span>deadlock</span> <span>recovery</span> <span>requires</span> <span>either</span> <span>aborting</span> <span>processes</span> <span>or</span> <span>preempting</span> <span>resources,</span> <span>neither</span> <span>of</span> <span>which</span> <span>is</span> <span>an</span> <span>attractive</span> <span>alternative</span>.</li>
  <li><span>If</span> <span>deadlocks</span> <span>are</span> <span>neither</span> <span>prevented</span> <span>nor</span> <span>detected,</span> <span>then</span> <span>when</span> <span>a</span> <span>deadlock</span> <span>occurs</span> <span>the</span> <span>system</span> <span>will</span> <span>gradually</span> <span>slow</span> <span>down,</span> <span>as</span> <span>more</span> <span>and</span> <span>more</span> <span>processes</span> <span>become</span> <span>stuck</span> <span>waiting</span> <span>for</span> <span>resources</span> <span>currently</span> <span>held</span> <span>by</span> <span>the</span> <span>deadlock</span> <span>and</span> <span>by</span> <span>other</span> <span>waiting</span> <span>processes</span>.<span></span> <span>Unfortunately</span> <span>this</span> <span>slowdown</span> <span>can</span> <span>be</span> <span>indistinguishable</span> <span>from</span> <span>a</span> <span>general</span> <span>system</span> <span>slowdown</span> <span>when</span> <span>a</span> <span>real-time</span> <span>process</span> <span>has</span> <span>heavy</span> <span>computing</span> <span>needs</span>.<span></span> <span></span> <span></span> </li>
</ul>
<h3><span>7</span>.<span>4</span> <span>Deadlock</span> </h3>
<ul>
  <li><span>Deadlocks</span> <span>can</span> <span>be</span> <span>prevented</span> <span>by</span> <span>preventing</span> <span>at</span> <span>least</span> <span>one</span> <span>of</span> <span>the</span> <span>four</span> <span>required</span> <span>conditions:</span> </li>
</ul>
<blockquote>
  <h4><span>7</span>.<span>4</span>.<span>1</span> <span>Mutual</span> </h4>
  <ul>
    <li><span>Shared</span> <span>resources</span> <span>such</span> <span>as</span> <span>read-only</span> <span>files</span> <span>do</span> <span>not</span> <span>lead</span> <span>to</span> <span>deadlocks</span>.<span></span> </li>
    <li><span>Unfortunately</span> <span>some</span> <span>resources,</span> <span>such</span> <span>as</span> <span>printers</span> <span>and</span> <span>tape</span> <span>drives,</span> <span>require</span> <span>exclusive</span> <span>access</span> <span>by</span> <span>a</span> <span>single</span> <span>process</span>.<span></span> </li>
  </ul>
  <h4><span>7</span>.<span>4</span>.<span>2</span> <span>Hold</span> <span>and</span> </h4>
  <ul>
    <li><span>To</span> <span>prevent</span> <span>this</span> <span>condition</span> <span>processes</span> <span>must</span> <span>be</span> <span>prevented</span> <span>from</span> <span></span> <span>holding</span> <span>one</span> <span>or</span> <span>more</span> <span>resources</span> <span>while</span> <span>simultaneously</span> <span>waiting</span> <span>for</span> <span>one</span> <span>or</span> <span>more</span> <span>others</span>.<span></span> <span>There</span> <span>are</span> <span>several</span> <span>possibilities</span> <span>for</span> <span>this:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Require</span> <span>that</span> <span>all</span> <span>processes</span> <span>request</span> <span>all</span> <span>resources</span> <span>at</span> <span>one</span> <span>time</span>.<span></span> <span>This</span> <span>can</span> <span>be</span> <span>wasteful</span> <span>of</span> <span>system</span> <span>resources</span> <span>if</span> <span>a</span> <span>process</span> <span>needs</span> <span>one</span> <span>resource</span> <span>early</span> <span>in</span> <span>its</span> <span>execution</span> <span>and</span> <span>doesn't</span> <span>need</span> <span>some</span> <span>other</span> <span>resource</span> <span>until</span> <span>much</span> <span>later</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Require</span> <span>that</span> <span>processes</span> <span>holding</span> <span>resources</span> <span>must</span> <span>release</span> <span>them</span> <span>before</span> <span>requesting</span> <span>new</span> <span>resources,</span> <span>and</span> <span>then</span> <span>re-acquire</span> <span>the</span> <span>released</span> <span>resources</span> <span>along</span> <span>with</span> <span>the</span> <span>new</span> <span>ones</span> <span>in</span> <span>a</span> <span>single</span> <span>new</span> <span>request</span>.<span></span> <span>This</span> <span>can</span> <span>be</span> <span>a</span> <span>problem</span> <span>if</span> <span>a</span> <span>process</span> <span>has</span> <span>partially</span> <span>completed</span> <span>an</span> <span>operation</span> <span>using</span> <span>a</span> <span>resource</span> <span>and</span> <span>then</span> <span>fails</span> <span>to</span> <span>get</span> <span>it</span> <span>re-allocated</span> <span>after</span> <span>releasing</span> <span>it</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Either</span> <span>of</span> <span>the</span> <span>methods</span> <span>described</span> <span>above</span> <span>can</span> <span>lead</span> <span>to</span> <span>starvation</span> <span>if</span> <span>a</span> <span>process</span> <span>requires</span> <span>one</span> <span>or</span> <span>more</span> <span>popular</span> <span>resources</span>.<span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <h4><span>7</span>.<span>4</span>.<span>3</span> <span>No</span> </h4>
  <ul>
    <li><span>Preemption</span> <span>of</span> <span>process</span> <span>resource</span> <span>allocations</span> <span>can</span> <span>prevent</span> <span>this</span> <span>condition</span> <span>of</span> <span>deadlocks,</span> <span>when</span> <span>it</span> <span>is</span> <span>possible</span>.<span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>One</span> <span>approach</span> <span>is</span> <span>that</span> <span>if</span> <span>a</span> <span>process</span> <span>is</span> <span>forced</span> <span>to</span> <span>wait</span> <span>when</span> <span>requesting</span> <span>a</span> <span>new</span> <span>resource,</span> <span>then</span> <span>all</span> <span></span> <span>other</span> <span>resources</span> <span>previously</span> <span>held</span> <span>by</span> <span>this</span> <span>process</span> <span>are</span> <span>implicitly</span> <span>released,</span> <span>(&nbsp;preempted&nbsp;),</span> <span>forcing</span> <span>this</span> <span>process</span> <span>to</span> <span>re-acquire</span> <span>the</span> <span>old</span> <span>resources</span> <span>along</span> <span>with</span> <span>the</span> <span>new</span> <span>resources</span> <span>in</span> <span>a</span> <span>single</span> <span>request,</span> <span>similar</span> <span>to</span> <span>the</span> <span>previous</span> <span>discussion</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Another</span> <span>approach</span> <span>is</span> <span>that</span> <span>when</span> <span>a</span> <span>resource</span> <span>is</span> <span>requested</span> <span>and</span> <span>not</span> <span>available,</span> <span>then</span> <span>the</span> <span>system</span> <span>looks</span> <span>to</span> <span>see</span> <span>what</span> <span>other</span> <span>processes</span> <span>currently</span> <span>have</span> <span>those</span> <span>resources</span> <span></span><em><span>and</span></em><span></span> <span>are</span> <span>themselves</span> <span>blocked</span> <span>waiting</span> <span>for</span> <span>some</span> <span>other</span> <span>resource</span>.<span></span> <span>If</span> <span>such</span> <span>a</span> <span>process</span> <span>is</span> <span>found,</span> <span>then</span> <span>some</span> <span>of</span> <span>their</span> <span>resources</span> <span>may</span> <span>get</span> <span>preempted</span> <span>and</span> <span>added</span> <span>to</span> <span>the</span> <span>list</span> <span>of</span> <span>resources</span> <span>for</span> <span>which</span> <span>the</span> <span>process</span> <span>is</span> <span>waiting</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Either</span> <span>of</span> <span>these</span> <span>approaches</span> <span>may</span> <span>be</span> <span>applicable</span> <span>for</span> <span>resources</span> <span>whose</span> <span>states</span> <span>are</span> <span>easily</span> <span>saved</span> <span>and</span> <span>restored,</span> <span>such</span> <span>as</span> <span>registers</span> <span>and</span> <span>memory,</span> <span>but</span> <span>are</span> <span>generally</span> <span>not</span> <span>applicable</span> <span>to</span> <span>other</span> <span>devices</span> <span>such</span> <span>as</span> <span>printers</span> <span>and</span> <span>tape</span> <span>drives</span>.<span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <h4><span>7</span>.<span>4</span>.<span>4</span> <span>Circular</span> </h4>
  <ul>
    <li><span>One</span> <span>way</span> <span>to</span> <span>avoid</span> <span>circular</span> <span>wait</span> <span>is</span> <span>to</span> <span>number</span> <span>all</span> <span>resources,</span> <span>and</span> <span>to</span> <span>require</span> <span>that</span> <span>processes</span> <span>request</span> <span>resources</span> <span>only</span> <span>in</span> <span>strictly</span> <span>increasing</span> <span>(</span> <span>or</span> <span>decreasing</span> <span>)</span> <span>order</span>.<span></span> </li>
    <li><span>In</span> <span>other</span> <span>words,</span> <span>in</span> <span>order</span> <span>to</span> <span>request</span> <span>resource</span> <span>Rj,</span> <span>a</span> <span>process</span> <span>must</span> <span>first</span> <span>release</span> <span>all</span> <span>Ri</span> <span>such</span> <span>that</span> <span>i</span> <span>&gt;=</span> <span>j</span>.</li>
    <li><span>One</span> <span>big</span> <span>challenge</span> <span>in</span> <span>this</span> <span>scheme</span> <span>is</span> <span>determining</span> <span>the</span> <span>relative</span> <span>ordering</span> <span>of</span> <span>the</span> <span>different</span> </li>
  </ul>
</blockquote>
<h3><span>7</span>.<span>5</span> <span>Deadlock</span> </h3>
<ul>
  <li><span>The</span> <span>general</span> <span>idea</span> <span>behind</span> <span>deadlock</span> <span>avoidance</span> <span>is</span> <span>to</span> <span>prevent</span> <span>deadlocks</span> <span>from</span> <span>ever</span> <span>happening,</span> <span>by</span> <span>preventing</span> <span>at</span> <span>least</span> <span>one</span> <span>of</span> <span>the</span> <span>aforementioned</span> <span>conditions</span>.</li>
  <li><span>This</span> <span>requires</span> <span>more</span> <span>information</span> <span>about</span> <span>each</span> <span>process,</span> <span>AND</span> <span>tends</span> <span>to</span> <span>lead</span> <span>to</span> <span>low</span> <span>device</span> <span>utilization</span>.<span></span> <span>(</span> <span>I</span>.<span>e</span>.<span></span> <span>it</span> <span>is</span> <span>a</span> <span>conservative</span> <span>approach</span>.<span></span> </li>
  <li><span>In</span> <span>some</span> <span>algorithms</span> <span>the</span> <span>scheduler</span> <span>only</span> <span>needs</span> <span>to</span> <span>know</span> <span>the</span> <span></span><em><span>maximum</span></em><span></span> <span>number</span> <span>of</span> <span>each</span> <span>resource</span> <span>that</span> <span>a</span> <span>process</span> <span>might</span> <span>potentially</span> <span>use</span>.<span></span> <span>In</span> <span>more</span> <span>complex</span> <span>algorithms</span> <span>the</span> <span>scheduler</span> <span>can</span> <span>also</span> <span>take</span> <span>advantage</span> <span>of</span> <span>the</span> <span></span><em><span>schedule</span></em><span></span> <span>of</span> <span>exactly</span> <span>what</span> <span>resources</span> <span>may</span> <span>be</span> <span>needed</span> <span>in</span> <span>what</span> <span>order</span>.<span></span> </li>
  <li><span>When</span> <span>a</span> <span>scheduler</span> <span>sees</span> <span>that</span> <span>starting</span> <span>a</span> <span>process</span> <span>or</span> <span>granting</span> <span>resource</span> <span>requests</span> <span>may</span> <span>lead</span> <span>to</span> <span>future</span> <span>deadlocks,</span> <span>then</span> <span>that</span> <span>process</span> <span>is</span> <span>just</span> <span>not</span> <span>started</span> <span>or</span> <span>the</span> <span>request</span> <span>is</span> <span>not</span> <span>granted</span>.<span></span> </li>
  <li><span>A</span> <span>resource</span> <span>allocation</span> <span></span><em><span></span><strong><span>state</span></strong><span></span></em><span></span> <span>is</span> <span>defined</span> <span>by</span> <span>the</span> <span>number</span> <span>of</span> <span>available</span> <span>and</span> <span>allocated</span> <span>resources,</span> <span>and</span> <span>the</span> <span>maximum</span> <span>requirements</span> <span>of</span> <span>all</span> <span>processes</span> <span>in</span> <span>the</span> <span>system</span>.<span></span> </li>
</ul>
<blockquote>
  <h4><span>7</span>.<span>5</span>.<span>1</span> <span>Safe</span> </h4>
  <ul>
    <li><span>A</span> <span>state</span> <span>is</span> <span></span><em><span></span><strong><span>safe</span></strong><span></span></em><span></span> <span>if</span> <span>the</span> <span>system</span> <span>can</span> <span>allocate</span> <span>all</span> <span>resources</span> <span>requested</span> <span>by</span> <span>all</span> <span>processes</span> <span>(</span> <span>up</span> <span>to</span> <span>their</span> <span>stated</span> <span>maximums</span> <span>)</span> <span>without</span> <span>entering</span> <span>a</span> <span>deadlock</span> <span>state</span>.</li>
    <li><span>More</span> <span>formally,</span> <span>a</span> <span>state</span> <span>is</span> <span>safe</span> <span>if</span> <span>there</span> <span>exists</span> <span>a</span> <span></span><em><span></span><strong><span>safe</span> <span>sequence</span></strong><span></span></em><span></span> <span>of</span> <span>processes</span> <span>{&nbsp;P0,</span> <span>P1,</span> <span>P2,</span> <span></span>.<span></span>.<span></span>.<span>,</span> <span>PN&nbsp;}</span> <span>such</span> <span>that</span> <span></span> <span></span> <span>all</span> <span>of</span> <span>the</span> <span>resource</span> <span>requests</span> <span>for</span> <span>Pi</span> <span>can</span> <span>be</span> <span>granted</span> <span>using</span> <span>the</span> <span>resources</span> <span>currently</span> <span>allocated</span> <span>to</span> <span>Pi</span> <span>and</span> <span>all</span> <span>processes</span> <span>Pj</span> <span>where</span> <span>j</span> <span>&lt;</span> <span>i</span>.<span></span> <span>(</span> <span>I</span>.<span>e</span>.<span></span> <span>if</span> <span>all</span> <span>the</span> <span>processes</span> <span>prior</span> <span>to</span> <span>Pi</span> <span>finish</span> <span>and</span> <span>free</span> <span>up</span> <span>their</span> <span>resources,</span> <span>then</span> <span>Pi</span> <span>will</span> <span>be</span> <span>able</span> <span>to</span> <span>finish</span> <span>also,</span> <span>using</span> <span>the</span> <span>resources</span> <span>that</span> <span>they</span> <span>have</span> <span>freed</span> <span>up</span>.<span></span> <span>)</span> </li>
    <li><span>If</span> <span>a</span> <span>safe</span> <span>sequence</span> <span>does</span> <span>not</span> <span>exist,</span> <span>then</span> <span>the</span> <span>system</span> <span>is</span> <span>in</span> <span>an</span> <span>unsafe</span> <span>state,</span> <span>which</span> <span></span><em><span></span><strong><span>MAY</span></strong><span></span></em><span></span> <span>lead</span> <span>to</span> <span>deadlock</span>.<span></span> <span>(</span> <span>All</span> <span>safe</span> <span>states</span> <span>are</span> <span>deadlock</span> <span>free,</span> <span>but</span> <span>not</span> <span>all</span> <span>unsafe</span> <span>states</span> <span>lead</span> <span>to</span> <span>deadlocks</span>.<span></span> <span>)</span> </li>
  </ul>
  <p align="center"><span></span><img src="./5_ Deadlocks_files/7_06_StateSpaces.jpg" width="296" height="296"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>7</span>.<span>6</span> <span>-</span> <span>Safe,</span> <span>unsafe,</span> <span>and</span> <span>deadlocked</span> <span>state</span> <span>spaces</span>.<span></span></strong><span>
</span> <span></span> </p>
  <ul>
    <li><span>For</span> <span>example,</span> <span>consider</span> <span>a</span> <span>system</span> <span>with</span> <span>12</span> <span>tape</span> <span>drives,</span> <span>allocated</span> <span>as</span> <span>follows</span>.<span></span> <span>Is</span> <span>this</span> <span>a</span> <span>safe</span> <span>state?</span> <span>What</span> <span>is</span> <span>the</span> <span>safe</span> <span>sequence?</span> </li>
  </ul>
  <blockquote> <center>
    <table width="400" border="1" cellspacing="5" cellpadding="2">
      <tbody><tr>
        <th scope="col">&nbsp;</th>
        <th scope="col">Maximum Needs </th>
        <th scope="col">Current Allocation </th>
      </tr>
      <tr>
        <th scope="row">P0</th>
        <td><span></span><div align="center"><span>10</span></div></td>
        <td><span></span><div align="center"><span>5</span></div></td>
      </tr>
      <tr>
        <th scope="row">P1</th>
        <td><span></span><div align="center"><span>4</span></div></td>
        <td><span></span><div align="center"><span>2</span></div></td>
      </tr>
      <tr>
        <th scope="row">P2</th>
        <td><span></span><div align="center"><span>9</span></div></td>
        <td><span></span><div align="center"><span>2</span></div></td>
      </tr>
    </tbody></table>
	</center>
  </blockquote>
  <ul>
    <li><span>What</span> <span>happens</span> <span>to</span> <span>the</span> <span>above</span> <span>table</span> <span>if</span> <span>process</span> <span>P2</span> <span>requests</span> <span>and</span> <span>is</span> <span>granted</span> <span>one</span> <span>more</span> <span>tape</span> </li>
    <li><span>Key</span> <span>to</span> <span>the</span> <span>safe</span> <span>state</span> <span>approach</span> <span>is</span> <span>that</span> <span>when</span> <span>a</span> <span>request</span> <span>is</span> <span>made</span> <span>for</span> <span>resources,</span> <span>the</span> <span>request</span> <span>is</span> <span>granted</span> <span>only</span> <span>if</span> <span>the</span> <span>resulting</span> <span>allocation</span> <span>state</span> <span>is</span> <span>a</span> <span>safe</span> <span>one</span>.<span></span> <span></span> </li>
  </ul>
  <h4><span>7</span>.<span>5</span>.<span>2</span> <span>Resource-Allocation</span> <span>Graph</span> </h4>
  <ul>
    <li><span>If</span> <span>resource</span> <span>categories</span> <span>have</span> <span>only</span> <span>single</span> <span>instances</span> <span>of</span> <span>their</span> <span>resources,</span> <span>then</span> <span>deadlock</span> <span>states</span> <span>can</span> <span>be</span> <span>detected</span> <span>by</span> <span>cycles</span> <span>in</span> <span>the</span> <span>resource-allocation</span> <span>graphs</span>.</li>
    <li><span>In</span> <span>this</span> <span>case,</span> <span>unsafe</span> <span>states</span> <span>can</span> <span>be</span> <span>recognized</span> <span>and</span> <span>avoided</span> <span>by</span> <span>augmenting</span> <span>the</span> <span>resource-allocation</span> <span>graph</span> <span>with</span> <span></span><em><span></span><strong><span>claim</span> <span>edges</span></strong><span></span></em><span>,</span> <span>noted</span> <span>by</span> <span>dashed</span> <span>lines,</span> <span>which</span> <span>point</span> <span>from</span> <span>a</span> <span>process</span> <span>to</span> <span>a</span> <span>resource</span> <span>that</span> <span>it</span> <span>may</span> <span>request</span> <span>in</span> <span>the</span> <span>future</span>.</li>
    <li><span>In</span> <span>order</span> <span>for</span> <span>this</span> <span>technique</span> <span>to</span> <span>work,</span> <span>all</span> <span>claim</span> <span>edges</span> <span>must</span> <span>be</span> <span>added</span> <span>to</span> <span>the</span> <span>graph</span> <span>for</span> <span>any</span> <span>particular</span> <span>process</span> <span>before</span> <span>that</span> <span>process</span> <span>is</span> <span>allowed</span> <span>to</span> <span>request</span> <span>any</span> <span>resources</span>.<span></span> <span>(&nbsp;Alternatively,</span> <span>processes</span> <span>may</span> <span>only</span> <span>make</span> <span>requests</span> <span>for</span> <span>resources</span> <span>for</span> <span>which</span> <span>they</span> <span>have</span> <span>already</span> <span>established</span> <span>claim</span> <span>edges,</span> <span>and</span> <span>claim</span> <span>edges</span> <span>cannot</span> <span>be</span> <span>added</span> <span>to</span> <span>any</span> <span>process</span> <span>that</span> <span>is</span> <span>currently</span> <span>holding</span> <span>resources</span>.</li>
    <li><span>When</span> <span>a</span> <span>process</span> <span>makes</span> <span>a</span> <span>request,</span> <span>the</span> <span>claim</span> <span>edge</span> <span>Pi-&gt;Rj</span> <span>is</span> <span>converted</span> <span>to</span> <span>a</span> <span>request</span> <span>edge</span>.<span></span> <span></span> <span></span> <span>Similarly</span> <span>when</span> <span>a</span> <span>resource</span> <span>is</span> <span>released,</span> <span>the</span> <span>assignment</span> <span>reverts</span> <span>back</span> <span>to</span> <span>a</span> <span>claim</span> <span>edge</span>.<span></span> </li>
    <li><span>This</span> <span>approach</span> <span>works</span> <span>by</span> <span>denying</span> <span>requests</span> <span>that</span> <span>would</span> <span>produce</span> <span>cycles</span> <span>in</span> <span>the</span> <span>resource-allocation</span> <span>graph,</span> <span>taking</span> <span>claim</span> <span>edges</span> <span>into</span> <span>effect</span>.</li>
    <li><span>Consider</span> <span>for</span> <span>example</span> <span>what</span> <span>happens</span> <span>when</span> <span>process</span> <span>P2</span> <span>requests</span> <span>resource</span> <span>R2:</span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./5_ Deadlocks_files/7_07_DeadlockAvoidance.jpg" width="250" height="254"><span></span><br><span>
</span> <span></span> <span></span><strong><span>Figure</span> <span>7</span>.<span>7</span> <span>-</span> <span>Resource</span> <span>allocation</span> <span>graph</span> <span>for</span> <span>deadlock</span> <span>avoidance</span></strong></p>
  <ul>
    <li><span>The</span> <span>resulting</span> <span>resource-allocation</span> <span>graph</span> <span>would</span> <span>have</span> <span>a</span> <span>cycle</span> <span>in</span> <span>it,</span> <span>and</span> <span>so</span> <span>the</span> <span>request</span> <span>cannot</span> <span>be</span> <span>granted</span>.<span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./5_ Deadlocks_files/7_08_UnsafeState.jpg" width="250" height="254"><span></span><br><span>
</span> <span></span> <span></span> <span></span> <span></span><strong><span>Figure</span> <span>7</span>.<span>8</span> <span>-</span> <span>An</span> <span>unsafe</span> <span>state</span> <span>in</span> <span>a</span> <span>resource</span> <span>allocation</span> <span>graph</span></strong><span>
</span> <span></span> </p>
  <h4><span>7</span>.<span>5</span>.<span>3</span> <span>Banker's</span> </h4>
  <ul>
    <li><span>For</span> <span>resource</span> <span>categories</span> <span>that</span> <span>contain</span> <span>more</span> <span>than</span> <span>one</span> <span>instance</span> <span>the</span> <span>resource-allocation</span> <span>graph</span> <span>method</span> <span>does</span> <span>not</span> <span>work,</span> <span>and</span> <span>more</span> <span>complex</span> <span>(&nbsp;and</span> <span>less</span> <span>efficient&nbsp;)</span> <span>methods</span> <span>must</span> <span>be</span> <span>chosen</span>.</li>
    <li><span>The</span> <span>Banker's</span> <span>Algorithm</span> <span>gets</span> <span>its</span> <span>name</span> <span>because</span> <span>it</span> <span>is</span> <span>a</span> <span>method</span> <span>that</span> <span>bankers</span> <span>could</span> <span>use</span> <span>to</span> <span>assure</span> <span>that</span> <span>when</span> <span>they</span> <span>lend</span> <span>out</span> <span>resources</span> <span>they</span> <span>will</span> <span>still</span> <span>be</span> <span>able</span> <span>to</span> <span>satisfy</span> <span>all</span> <span>their</span> <span>clients</span>.<span></span> <span>(&nbsp;A</span> <span>banker</span> <span>won't</span> <span>loan</span> <span>out</span> <span>a</span> <span>little</span> <span>money</span> <span>to</span> <span>start</span> <span>building</span> <span>a</span> <span>house</span> <span>unless</span> <span>they</span> <span>are</span> <span>assured</span> <span>that</span> <span>they</span> <span>will</span> <span>later</span> <span>be</span> <span>able</span> <span>to</span> <span>loan</span> <span>out</span> <span>the</span> <span>rest</span> <span>of</span> <span>the</span> <span>money</span> <span>to</span> <span>finish</span> <span>the</span> <span>house</span>.</li>
    <li><span>When</span> <span>a</span> <span>process</span> <span>starts</span> <span>up,</span> <span>it</span> <span>must</span> <span>state</span> <span>in</span> <span>advance</span> <span>the</span> <span>maximum</span> <span>allocation</span> <span>of</span> <span>resources</span> <span>it</span> <span>may</span> <span>request,</span> <span>up</span> <span>to</span> <span>the</span> <span>amount</span> <span>available</span> <span>on</span> <span>the</span> <span>system</span>.</li>
    <li><span>When</span> <span>a</span> <span>request</span> <span>is</span> <span>made,</span> <span>the</span> <span>scheduler</span> <span>determines</span> <span>whether</span> <span>granting</span> <span>the</span> <span>request</span> <span>would</span> <span>leave</span> <span>the</span> <span>system</span> <span>in</span> <span>a</span> <span>safe</span> <span>state</span>.<span></span> <span>If</span> <span>not,</span> <span>then</span> <span>the</span> <span>process</span> <span>must</span> <span>wait</span> <span>until</span> <span>the</span> <span>request</span> <span>can</span> <span>be</span> <span>granted</span> <span>safely</span>.</li>
    <li><span>The</span> <span>banker's</span> <span>algorithm</span> <span>relies</span> <span>on</span> <span>several</span> <span>key</span> <span>data</span> <span>structures:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span>(</span> <span>where</span> <span>n</span> <span>is</span> <span>the</span> <span>number</span> <span>of</span> <span>processes</span> <span>and</span> <span>m</span> <span>is</span> <span>the</span> <span>number</span> <span>of</span> <span>resource</span> <span>categories</span>.<span></span> <span>)
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Available[</span> <span>m</span> <span>]</span> <span>indicates</span> <span>how</span> <span>many</span> <span>resources</span> <span>are</span> <span>currently</span> <span>available</span> <span>of</span> <span>each</span> <span>type</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Max[</span> <span>n</span> <span>][</span> <span>m</span> <span>]</span> <span>indicates</span> <span>the</span> <span>maximum</span> <span>demand</span> <span>of</span> <span>each</span> <span>process</span> <span>of</span> <span>each</span> <span>resource</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Allocation[</span> <span>n</span> <span>][</span> <span>m</span> <span>]</span> <span>indicates</span> <span>the</span> <span>number</span> <span>of</span> <span>each</span> <span>resource</span> <span>category</span> <span>allocated</span> <span>to</span> <span>each</span> <span>process</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Need[</span> <span>n</span> <span>][</span> <span>m</span> <span>]</span> <span>indicates</span> <span>the</span> <span>remaining</span> <span>resources</span> <span>needed</span> <span>of</span> <span>each</span> <span>type</span> <span>for</span> <span>each</span> <span>process</span>.<span></span> <span>(&nbsp;Note</span> <span>that</span> <span>Need[&nbsp;i&nbsp;][&nbsp;j&nbsp;]</span> <span>=</span> <span>Max[&nbsp;i&nbsp;][&nbsp;j&nbsp;]</span> <span>-</span> <span>Allocation[&nbsp;i&nbsp;][&nbsp;j&nbsp;]</span> <span>for</span> <span>all</span> <span>i,</span> <span>j</span>.<span>&nbsp;)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>For</span> <span>simplification</span> <span>of</span> <span>discussions,</span> <span>we</span> <span>make</span> <span>the</span> <span>following</span> <span>notations</span> <span>/</span> <span>observations:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>One</span> <span>row</span> <span>of</span> <span>the</span> <span>Need</span> <span>vector,</span> <span>Need[</span> <span>i</span> <span>],</span> <span>can</span> <span>be</span> <span>treated</span> <span>as</span> <span>a</span> <span>vector</span> <span>corresponding</span> <span>to</span> <span>the</span> <span>needs</span> <span>of</span> <span>process</span> <span>i,</span> <span>and</span> <span>similarly</span> <span>for</span> <span>Allocation</span> <span>and</span> <span>Max</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>A</span> <span>vector</span> <span>X</span> <span>is</span> <span>considered</span> <span>to</span> <span>be</span> <span>&lt;=</span> <span>a</span> <span>vector</span> <span>Y</span> <span>if</span> <span>X[&nbsp;i&nbsp;]</span> <span>&lt;=</span> <span>Y[&nbsp;i&nbsp;]</span> <span>for</span> <span>all</span> <span>i</span>.<span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <blockquote>
    <h4><span>7</span>.<span>5</span>.<span>3</span>.<span>1</span> <span>Safety</span> </h4>
    <ul>
      <li><span>In</span> <span>order</span> <span>to</span> <span>apply</span> <span>the</span> <span>Banker's</span> <span>algorithm,</span> <span>we</span> <span>first</span> <span>need</span> <span>an</span> <span>algorithm</span> <span>for</span> <span>determining</span> <span>whether</span> <span>or</span> <span>not</span> <span>a</span> <span>particular</span> <span>state</span> <span>is</span> <span>safe</span>.</li>
      <li><span>This</span> <span>algorithm</span> <span>determines</span> <span>if</span> <span>the</span> <span>current</span> <span>state</span> <span>of</span> <span>a</span> <span>system</span> <span>is</span> <span>safe,</span> <span>according</span> <span>to</span> <span>the</span> <span>following</span> <span>steps:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Let</span> <span>Work</span> <span>and</span> <span>Finish</span> <span>be</span> <span>vectors</span> <span>of</span> <span>length</span> <span>m</span> <span>and</span> <span>n</span> <span>respectively</span>.<span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Work</span> <span>is</span> <span>a</span> <span>working</span> <span>copy</span> <span>of</span> <span>the</span> <span>available</span> <span>resources,</span> <span>which</span> <span>will</span> <span>be</span> <span>modified</span> <span>during</span> <span>the</span> <span>analysis</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Finish</span> <span>is</span> <span>a</span> <span>vector</span> <span>of</span> <span>booleans</span> <span>indicating</span> <span>whether</span> <span>a</span> <span>particular</span> <span>process</span> <span>can</span> <span>finish</span>.<span></span> <span>(</span> <span>or</span> <span>has</span> <span>finished</span> <span>so</span> <span>far</span> <span>in</span> <span>the</span> <span>analysis</span>.<span></span> <span>)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Initialize</span> <span>Work</span> <span>to</span> <span>Available,</span> <span>and</span> <span>Finish</span> <span>to</span> <span>false</span> <span>for</span> <span>all</span> <span>elements</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Find</span> <span>an</span> <span>i</span> <span>such</span> <span>that</span> <span>both</span> <span>(A)</span> <span>Finish[</span> <span>i</span> <span>]</span> <span>==</span> <span>false,</span> <span>and</span> <span>(B)</span> <span>Need[</span> <span>i</span> <span>]</span> <span>&lt;</span> <span>Work</span>.<span></span> <span>This</span> <span>process</span> <span>has</span> <span>not</span> <span>finished,</span> <span>but</span> <span>could</span> <span>with</span> <span>the</span> <span>given</span> <span>available</span> <span>working</span> <span>set</span>.<span></span> <span>If</span> <span>no</span> <span>such</span> <span>i</span> <span>exists,</span> <span>go</span> <span>to</span> <span>step</span> <span>4</span>.<span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Set</span> <span>Work</span> <span>=</span> <span>Work</span> <span>+</span> <span>Allocation[</span> <span>i</span> <span>],</span> <span>and</span> <span>set</span> <span>Finish[</span> <span>i</span> <span>]</span> <span>to</span> <span>true</span>.<span></span> <span>This</span> <span>corresponds</span> <span>to</span> <span>process</span> <span>i</span> <span>finishing</span> <span>up</span> <span>and</span> <span>releasing</span> <span>its</span> <span>resources</span> <span>back</span> <span>into</span> <span>the</span> <span>work</span> <span>pool</span>.<span></span> <span>Then</span> <span>loop</span> <span>back</span> <span>to</span> <span>step</span> <span>2</span>.<span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>If</span> <span>finish[</span> <span>i</span> <span>]</span> <span>==</span> <span>true</span> <span>for</span> <span>all</span> <span>i,</span> <span>then</span> <span>the</span> <span>state</span> <span>is</span> <span>a</span> <span>safe</span> <span>state,</span> <span>because</span> <span>a</span> <span>safe</span> <span>sequence</span> <span>has</span> <span>been</span> <span>found</span>.<span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> </li>
      <li><span>(</span> <span>JTB's</span> <span>Modification:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>In</span> <span>step</span> <span>1</span>.<span></span> <span>instead</span> <span>of</span> <span>making</span> <span>Finish</span> <span>an</span> <span>array</span> <span>of</span> <span>booleans</span> <span>initialized</span> <span>to</span> <span>false,</span> <span>make</span> <span>it</span> <span>an</span> <span>array</span> <span>of</span> <span>ints</span> <span>initialized</span> <span>to</span> <span>0</span>.<span></span> <span>Also</span> <span>initialize</span> <span>an</span> <span>int</span> <span>s</span> <span>=</span> <span>0</span> <span>as</span> <span>a</span> <span>step</span> <span>counter</span>.<span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>In</span> <span>step</span> <span>2,</span> <span>look</span> <span>for</span> <span>Finish[</span> <span>i</span> <span>]</span> <span>==</span> <span>0</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>In</span> <span>step</span> <span>3,</span> <span>set</span> <span>Finish[</span> <span>i</span> <span>]</span> <span>to</span> <span></span> <span>++s</span>.<span></span> <span>S</span> <span>is</span> <span>counting</span> <span>the</span> <span>number</span> <span>of</span> <span>finished</span> <span>processes</span>.<span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>For</span> <span>step</span> <span>4,</span> <span>the</span> <span>test</span> <span>can</span> <span>be</span> <span>either</span> <span>Finish[</span> <span>i</span> <span>]</span> <span>&gt;</span> <span>0</span> <span>for</span> <span>all</span> <span>i,</span> <span>or</span> <span>s</span> <span>&gt;=</span> <span>n</span>.<span></span> <span>The</span> <span>benefit</span> <span>of</span> <span>this</span> <span>method</span> <span>is</span> <span>that</span> <span>if</span> <span>a</span> <span>safe</span> <span>state</span> <span>exists,</span> <span>then</span> <span>Finish[</span> <span>]</span> <span>indicates</span> <span>one</span> <span>safe</span> <span>sequence</span> <span>(</span> <span>of</span> <span>possibly</span> <span>many</span>.<span></span> <span>)</span> <span>)</span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> </li>
    </ul>
    <h4><span>7</span>.<span>5</span>.<span>3</span>.<span>2</span> <span>Resource-Request</span> <span>Algorithm</span> <span>(</span> <span>The</span> <span>Bankers</span> <span>Algorithm</span> </h4>
    <ul>
      <li><span>Now</span> <span>that</span> <span>we</span> <span>have</span> <span>a</span> <span>tool</span> <span>for</span> <span>determining</span> <span>if</span> <span>a</span> <span>particular</span> <span>state</span> <span>is</span> <span>safe</span> <span>or</span> <span>not,</span> <span>we</span> <span>are</span> <span>now</span> <span>ready</span> <span>to</span> <span>look</span> <span>at</span> <span>the</span> <span>Banker's</span> <span>algorithm</span> <span>itself</span>.</li>
      <li><span>This</span> <span>algorithm</span> <span>determines</span> <span>if</span> <span>a</span> <span>new</span> <span>request</span> <span>is</span> <span>safe,</span> <span>and</span> <span>grants</span> <span>it</span> <span>only</span> <span>if</span> <span>it</span> <span>is</span> <span>safe</span> <span>to</span> <span>do</span> <span>so</span>.<span></span> </li>
      <li><span>When</span> <span>a</span> <span>request</span> <span>is</span> <span>made</span> <span>(</span> <span>that</span> <span>does</span> <span>not</span> <span>exceed</span> <span>currently</span> <span>available</span> <span>resources</span> <span>),</span> <span>pretend</span> <span>it</span> <span>has</span> <span>been</span> <span>granted,</span> <span>and</span> <span>then</span> <span>see</span> <span>if</span> <span>the</span> <span>resulting</span> <span>state</span> <span>is</span> <span>a</span> <span>safe</span> <span>one</span>.<span></span> <span>If</span> <span>so,</span> <span>grant</span> <span>the</span> <span>request,</span> <span>and</span> <span>if</span> <span>not,</span> <span>deny</span> <span>the</span> <span>request,</span> <span>as</span> <span>follows:</span> <span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Let</span> <span>Request[</span> <span>n</span> <span>][</span> <span>m</span> <span>]</span> <span>indicate</span> <span>the</span> <span>number</span> <span>of</span> <span>resources</span> <span>of</span> <span>each</span> <span>type</span> <span>currently</span> <span>requested</span> <span>by</span> <span>processes</span>.<span></span> <span>If</span> <span>Request[</span> <span>i</span> <span>]</span> <span>&gt;</span> <span>Need[</span> <span>i</span> <span>]</span> <span>for</span> <span>any</span> <span>process</span> <span>i,</span> <span>raise</span> <span>an</span> <span>error</span> <span>condition</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>If</span> <span>Request[</span> <span>i</span> <span>]</span> <span>&gt;</span> <span>Available</span> <span>for</span> <span>any</span> <span>process</span> <span>i,</span> <span>then</span> <span>that</span> <span>process</span> <span>must</span> <span>wait</span> <span>for</span> <span>resources</span> <span>to</span> <span>become</span> <span>available</span>.<span></span> <span>Otherwise</span> <span>the</span> <span>process</span> <span>can</span> <span>continue</span> <span>to</span> <span>step</span> <span>3</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Check</span> <span>to</span> <span>see</span> <span>if</span> <span>the</span> <span>request</span> <span>can</span> <span>be</span> <span>granted</span> <span>safely,</span> <span>by</span> <span>pretending</span> <span>it</span> <span>has</span> <span>been</span> <span>granted</span> <span>and</span> <span>then</span> <span>seeing</span> <span>if</span> <span>the</span> <span>resulting</span> <span>state</span> <span>is</span> <span>safe</span>.<span></span> <span>If</span> <span>so,</span> <span>grant</span> <span>the</span> <span>request,</span> <span>and</span> <span>if</span> <span>not,</span> <span>then</span> <span>the</span> <span>process</span> <span>must</span> <span>wait</span> <span>until</span> <span>its</span> <span>request</span> <span>can</span> <span>be</span> <span>granted</span> <span>safely</span>.<span>The</span> <span>procedure</span> <span>for</span> <span>granting</span> <span>a</span> <span>request</span> <span>(</span> <span>or</span> <span>pretending</span> <span>to</span> <span>for</span> <span>testing</span> <span>purposes</span> <span>)</span> <span>is:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Available</span> <span>=</span> <span>Available</span> <span>-</span> <span>Request</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Allocation</span> <span>=</span> <span>Allocation</span> <span>+</span> <span>Request</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Need</span> <span>=</span> <span>Need</span> <span>-</span> <span>Request</span> <span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> </li>
    </ul>
    <h4><span>7</span>.<span>5</span>.<span>3</span>.<span>3</span> <span>An</span> <span>Illustrative</span> </h4>
    <ul>
      <li><span>Consider</span> <span>the</span> <span>following</span> </li>
    </ul>
    <blockquote>
      <p align="center"><span></span><img src="./5_ Deadlocks_files/7_IllustrativeExample.jpg" width="452" height="221"></p>
    </blockquote>
    <ul>
      <li><span>And</span> <span>now</span> <span>consider</span> <span>what</span> <span>happens</span> <span>if</span> <span>process</span> <span>P1</span> <span>requests</span> <span>1</span> <span>instance</span> <span>of</span> <span>A</span> <span>and</span> <span>2</span> <span>instances</span> <span>of</span> <span>C</span>.<span></span> <span>(</span> <span>Request[</span> <span>1</span> <span>]</span> <span>=</span> <span>(</span> <span>1,</span> <span>0,</span> <span>2</span> <span>)</span> </li>
    </ul>
    <blockquote>
      <p align="center"><span></span><img src="./5_ Deadlocks_files/7_IllustrativeExample_2.jpg" width="406" height="236"><span></span> <span></span> </p>
    </blockquote>
    <ul>
      <li><span>What</span> <span>about</span> <span>requests</span> <span>of</span> <span>(</span> <span>3,</span> <span>3,0</span> <span>)</span> <span>by</span> <span>P4?</span> <span>or</span> <span>(</span> <span>0,</span> <span>2,</span> <span>0</span> <span>)</span> <span>by</span> <span>P0?</span> <span>Can</span> <span>these</span> <span>be</span> <span>safely</span> <span>granted?</span> <span>Why</span> <span>or</span> <span>why</span> <span>not?</span> </li>
    </ul>
  </blockquote>
</blockquote>
<h3><span>7</span>.<span>6</span> <span>Deadlock</span> </h3>
<ul>
  <li><span>If</span> <span>deadlocks</span> <span>are</span> <span>not</span> <span>avoided,</span> <span>then</span> <span>another</span> <span>approach</span> <span>is</span> <span>to</span> <span>detect</span> <span>when</span> <span>they</span> <span>have</span> <span>occurred</span> <span>and</span> <span>recover</span> <span>somehow</span>.</li>
  <li><span>In</span> <span>addition</span> <span>to</span> <span>the</span> <span>performance</span> <span>hit</span> <span>of</span> <span>constantly</span> <span>checking</span> <span>for</span> <span>deadlocks,</span> <span>a</span> <span>policy</span> <span>/</span> <span>algorithm</span> <span>must</span> <span>be</span> <span>in</span> <span>place</span> <span>for</span> <span>recovering</span> <span>from</span> <span>deadlocks,</span> <span>and</span> <span>there</span> <span>is</span> <span>potential</span> <span>for</span> <span>lost</span> <span>work</span> <span>when</span> <span>processes</span> <span>must</span> <span>be</span> <span>aborted</span> <span>or</span> <span>have</span> <span>their</span> <span>resources</span> <span>preempted</span>.<span></span> <span></span> </li>
</ul>
<blockquote>
  <h4><span>7</span>.<span>6</span>.<span>1</span> <span>Single</span> <span>Instance</span> <span>of</span> <span>Each</span> <span>Resource</span> </h4>
  <ul>
    <li><span>If</span> <span>each</span> <span>resource</span> <span>category</span> <span>has</span> <span>a</span> <span>single</span> <span>instance,</span> <span>then</span> <span>we</span> <span>can</span> <span>use</span> <span>a</span> <span>variation</span> <span>of</span> <span>the</span> <span>resource-allocation</span> <span>graph</span> <span>known</span> <span>as</span> <span>a</span> <span></span><em><span></span><strong><span>wait-for</span> <span>graph</span></strong><span></span></em><span></span>.</li>
    <li><span>A</span> <span>wait-for</span> <span>graph</span> <span>can</span> <span>be</span> <span>constructed</span> <span>from</span> <span>a</span> <span>resource-allocation</span> <span>graph</span> <span>by</span> <span>eliminating</span> <span>the</span> <span>resources</span> <span>and</span> <span>collapsing</span> <span>the</span> <span>associated</span> <span>edges,</span> <span>as</span> <span>shown</span> <span>in</span> <span>the</span> <span>figure</span> <span>below</span>.</li>
    <li><span>An</span> <span>arc</span> <span>from</span> <span>Pi</span> <span>to</span> <span>Pj</span> <span>in</span> <span>a</span> <span>wait-for</span> <span>graph</span> <span>indicates</span> <span>that</span> <span>process</span> <span>Pi</span> <span>is</span> <span>waiting</span> <span>for</span> <span>a</span> <span>resource</span> <span>that</span> <span>process</span> <span>Pj</span> <span>is</span> <span>currently</span> <span>holding</span>.<span></span> <span></span> </li>
  </ul>
  <p align="center"><span></span><img src="./5_ Deadlocks_files/7_09_TwoGraphs.jpg" width="664" height="436"><span></span><br><span>
</span> <span></span> <span></span><strong><span>Figure</span> <span>7</span>.<span>9</span> <span>-</span> <span>(a)</span> <span>Resource</span> <span>allocati</span></strong><span></span><strong><span>on</span> <span>graph</span>.<span></span> <span>(b)</span> <span>Corresponding</span> <span>wait-for</span> <span>graph</span></strong></p>
  <ul>
    <li><span>As</span> <span>before,</span> <span>cycles</span> <span>in</span> <span>the</span> <span>wait-for</span> <span>graph</span> <span>indicate</span> <span>deadlocks</span>.</li>
    <li><span>This</span> <span>algorithm</span> <span>must</span> <span>maintain</span> <span>the</span> <span>wait-for</span> <span>graph,</span> <span>and</span> <span>periodically</span> <span>search</span> <span>it</span> <span>for</span> <span>cycles</span>.<span></span> <span></span> </li>
  </ul>
  <h4><span>7</span>.<span>6</span>.<span>2</span> <span>Several</span> <span>Instances</span> <span>of</span> <span>a</span> <span>Resource</span> </h4>
  <ul>
    <li><span>The</span> <span>detection</span> <span>algorithm</span> <span>outlined</span> <span>here</span> <span>is</span> <span>essentially</span> <span>the</span> <span>same</span> <span>as</span> <span>the</span> <span>Banker's</span> <span>algorithm,</span> <span>with</span> <span>two</span> <span>subtle</span> <span>differences:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>In</span> <span>step</span> <span>1,</span> <span>the</span> <span>Banker's</span> <span>Algorithm</span> <span>sets</span> <span>Finish[</span> <span>i</span> <span>]</span> <span>to</span> <span>false</span> <span>for</span> <span>all</span> <span>i</span>.<span></span> <span>The</span> <span>algorithm</span> <span>presented</span> <span>here</span> <span>sets</span> <span>Finish[</span> <span>i</span> <span>]</span> <span>to</span> <span>false</span> <span>only</span> <span>if</span> <span>Allocation[</span> <span>i</span> <span>]</span> <span>is</span> <span>not</span> <span>zero</span>.<span></span> <span>If</span> <span>the</span> <span>currently</span> <span>allocated</span> <span>resources</span> <span>for</span> <span>this</span> <span>process</span> <span>are</span> <span>zero,</span> <span>the</span> <span>algorithm</span> <span>sets</span> <span>Finish[</span> <span>i</span> <span>]</span> <span>to</span> <span>true</span>.<span></span> <span>This</span> <span>is</span> <span>essentially</span> <span>assuming</span> <span>that</span> <span>IF</span> <span>all</span> <span>of</span> <span>the</span> <span>other</span> <span>processes</span> <span>can</span> <span>finish,</span> <span>then</span> <span>this</span> <span>process</span> <span>can</span> <span>finish</span> <span>also</span>.<span></span> <span>Furthermore,</span> <span>this</span> <span>algorithm</span> <span>is</span> <span>specifically</span> <span>looking</span> <span>for</span> <span>which</span> <span>processes</span> <span>are</span> <span>involved</span> <span>in</span> <span>a</span> <span>deadlock</span> <span>situation,</span> <span>and</span> <span>a</span> <span>process</span> <span>that</span> <span>does</span> <span>not</span> <span>have</span> <span>any</span> <span>resources</span> <span>allocated</span> <span>cannot</span> <span>be</span> <span>involved</span> <span>in</span> <span>a</span> <span>deadlock,</span> <span>and</span> <span>so</span> <span>can</span> <span>be</span> <span>removed</span> <span>from</span> <span>any</span> <span>further</span> <span>consideration</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Steps</span> <span>2</span> <span>and</span> <span>3</span> <span>are</span> <span>unchanged</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>In</span> <span>step</span> <span>4,</span> <span>the</span> <span>basic</span> <span>Banker's</span> <span>Algorithm</span> <span>says</span> <span>that</span> <span>if</span> <span>Finish[</span> <span>i</span> <span>]</span> <span>==</span> <span>true</span> <span>for</span> <span>all</span> <span>i,</span> <span>that</span> <span>there</span> <span>is</span> <span>no</span> <span>deadlock</span>.<span></span> <span>This</span> <span>algorithm</span> <span>is</span> <span>more</span> <span>specific,</span> <span>by</span> <span>stating</span> <span>that</span> <span>if</span> <span>Finish[</span> <span>i</span> <span>]</span> <span>==</span> <span>false</span> <span>for</span> <span>any</span> <span>process</span> <span>Pi,</span> <span>then</span> <span>that</span> <span>process</span> <span>is</span> <span>specifically</span> <span>involved</span> <span>in</span> <span>the</span> <span>deadlock</span> <span>which</span> <span>has</span> <span>been</span> <span>detected</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>(</span> <span>Note:</span> <span>An</span> <span>alternative</span> <span>method</span> <span>was</span> <span>presented</span> <span>above,</span> <span>in</span> <span>which</span> <span>Finish</span> <span>held</span> <span>integers</span> <span>instead</span> <span>of</span> <span>booleans</span>.<span></span> <span>This</span> <span>vector</span> <span>would</span> <span>be</span> <span>initialized</span> <span>to</span> <span>all</span> <span>zeros,</span> <span>and</span> <span>then</span> <span>filled</span> <span>with</span> <span>increasing</span> <span>integers</span> <span>as</span> <span>processes</span> <span>are</span> <span>detected</span> <span>which</span> <span>can</span> <span>finish</span>.<span></span> <span>If</span> <span>any</span> <span>processes</span> <span>are</span> <span>left</span> <span>at</span> <span>zero</span> <span>when</span> <span>the</span> <span>algorithm</span> <span>completes,</span> <span>then</span> <span>there</span> <span>is</span> <span>a</span> <span>deadlock,</span> <span>and</span> <span>if</span> <span>not,</span> <span>then</span> <span>the</span> <span>integers</span> <span>in</span> <span>finish</span> <span>describe</span> <span>a</span> <span>safe</span> <span>sequence</span>.<span></span> <span>To</span> <span>modify</span> <span>this</span> <span>algorithm</span> <span>to</span> <span>match</span> <span>this</span> <span>section</span> <span>of</span> <span>the</span> <span>text,</span> <span>processes</span> <span>with</span> <span>allocation</span> <span>=</span> <span>zero</span> <span>could</span> <span>be</span> <span>filled</span> <span>in</span> <span>with</span> <span>N,</span> <span>N</span> <span>-</span> <span>1,</span> <span>N&nbsp;-&nbsp;2,</span> <span></span> <span>etc</span>.<span></span> <span>in</span> <span>step</span> <span>1,</span> <span>and</span> <span>any</span> <span>processes</span> <span>left</span> <span>with</span> <span>Finish</span> <span>=</span> <span>0</span> <span>in</span> <span>step</span> <span>4</span> <span>are</span> <span>the</span> <span>deadlocked</span> <span>processes</span>.<span></span> <span>)</span> </li>
    <li><span>Consider,</span> <span>for</span> <span>example,</span> <span>the</span> <span>following</span> <span>state,</span> <span>and</span> <span>determine</span> <span>if</span> <span>it</span> <span>is</span> <span>currently</span> </li>
  </ul>
  <blockquote>
    <p align="center"><span></span><img src="./5_ Deadlocks_files/7_IllustrativeExample_3.jpg" width="384" height="217"></p>
  </blockquote>
  <ul>
    <li><span>Now</span> <span>suppose</span> <span>that</span> <span>process</span> <span>P2</span> <span>makes</span> <span>a</span> <span>request</span> <span>for</span> <span>an</span> <span>additional</span> <span>instance</span> <span>of</span> <span>type</span> <span>C,</span> <span>yielding</span> <span>the</span> <span>state</span> <span>shown</span> <span>below</span>.<span></span> <span>Is</span> <span>the</span> <span>system</span> <span>now</span> </li>
  </ul>
  <blockquote>
    <p align="center"><span></span><img src="./5_ Deadlocks_files/7_IllustrativeExample_4.jpg" width="388" height="217"></p>
  </blockquote>
  <h4><span>7</span>.<span>6</span>.<span>3</span> <span>Detection-Algorithm</span> </h4>
  <ul>
    <li><span>When</span> <span>should</span> <span>the</span> <span>deadlock</span> <span>detection</span> <span>be</span> <span>done?</span> <span>Frequently,</span> <span>or</span> </li>
    <li><span>The</span> <span>answer</span> <span>may</span> <span>depend</span> <span>on</span> <span>how</span> <span>frequently</span> <span>deadlocks</span> <span>are</span> <span>expected</span> <span>to</span> <span>occur,</span> <span>as</span> <span>well</span> <span>as</span> <span>the</span> <span>possible</span> <span>consequences</span> <span>of</span> <span>not</span> <span>catching</span> <span>them</span> <span>immediately</span>.<span></span> <span>(</span> <span>If</span> <span>deadlocks</span> <span>are</span> <span>not</span> <span>removed</span> <span>immediately</span> <span>when</span> <span>they</span> <span>occur,</span> <span>then</span> <span>more</span> <span>and</span> <span>more</span> <span>processes</span> <span>can</span> <span>"back</span> <span>up"</span> <span>behind</span> <span>the</span> <span>deadlock,</span> <span>making</span> <span>the</span> <span>eventual</span> <span>task</span> <span>of</span> <span>unblocking</span> <span>the</span> <span>system</span> <span>more</span> <span>difficult</span> <span>and</span> <span>possibly</span> <span>damaging</span> <span>to</span> <span>more</span> <span>processes</span>.<span></span> </li>
    <li><span>There</span> <span>are</span> <span>two</span> <span>obvious</span> <span>approaches,</span> <span>each</span> <span>with</span> <span>trade-offs:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Do</span> <span>deadlock</span> <span>detection</span> <span>after</span> <span>every</span> <span>resource</span> <span>allocation</span> <span>which</span> <span>cannot</span> <span>be</span> <span>immediately</span> <span>granted</span>.<span></span> <span>This</span> <span>has</span> <span>the</span> <span>advantage</span> <span>of</span> <span>detecting</span> <span>the</span> <span>deadlock</span> <span>right</span> <span>away,</span> <span>while</span> <span>the</span> <span>minimum</span> <span>number</span> <span>of</span> <span>processes</span> <span>are</span> <span>involved</span> <span>in</span> <span>the</span> <span>deadlock</span>.<span></span> <span>(</span> <span>One</span> <span>might</span> <span>consider</span> <span>that</span> <span>the</span> <span>process</span> <span>whose</span> <span>request</span> <span>triggered</span> <span>the</span> <span>deadlock</span> <span>condition</span> <span>is</span> <span>the</span> <span>"cause"</span> <span>of</span> <span>the</span> <span>deadlock,</span> <span>but</span> <span>realistically</span> <span>all</span> <span>of</span> <span>the</span> <span>processes</span> <span>in</span> <span>the</span> <span>cycle</span> <span>are</span> <span>equally</span> <span>responsible</span> <span>for</span> <span>the</span> <span>resulting</span> <span>deadlock</span>.<span></span> <span>)</span> <span>The</span> <span>down</span> <span>side</span> <span>of</span> <span>this</span> <span>approach</span> <span>is</span> <span>the</span> <span>extensive</span> <span>overhead</span> <span>and</span> <span>performance</span> <span>hit</span> <span>caused</span> <span>by</span> <span>checking</span> <span>for</span> <span>deadlocks</span> <span>so</span> <span>frequently</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Do</span> <span>deadlock</span> <span>detection</span> <span>only</span> <span>when</span> <span>there</span> <span>is</span> <span>some</span> <span>clue</span> <span>that</span> <span>a</span> <span>deadlock</span> <span>may</span> <span>have</span> <span>occurred,</span> <span>such</span> <span>as</span> <span>when</span> <span>CPU</span> <span>utilization</span> <span>reduces</span> <span>to</span> <span>40%</span> <span>or</span> <span>some</span> <span>other</span> <span>magic</span> <span>number</span>.<span></span> <span>The</span> <span>advantage</span> <span>is</span> <span>that</span> <span>deadlock</span> <span>detection</span> <span>is</span> <span>done</span> <span>much</span> <span>less</span> <span>frequently,</span> <span>but</span> <span>the</span> <span>down</span> <span>side</span> <span>is</span> <span>that</span> <span>it</span> <span>becomes</span> <span>impossible</span> <span>to</span> <span>detect</span> <span>the</span> <span>processes</span> <span>involved</span> <span>in</span> <span>the</span> <span>original</span> <span>deadlock,</span> <span>and</span> <span>so</span> <span>deadlock</span> <span>recovery</span> <span>can</span> <span>be</span> <span>more</span> <span>complicated</span> <span>and</span> <span>damaging</span> <span>to</span> <span>more</span> <span>processes</span>.<span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>(</span> <span>As</span> <span>I</span> <span>write</span> <span>this,</span> <span>a</span> <span>third</span> <span>alternative</span> <span>comes</span> <span>to</span> <span>mind:</span> <span>Keep</span> <span>a</span> <span>historical</span> <span>log</span> <span>of</span> <span>resource</span> <span>allocations,</span> <span>since</span> <span>that</span> <span>last</span> <span>known</span> <span>time</span> <span>of</span> <span>no</span> <span>deadlocks</span>.<span></span> <span>Do</span> <span>deadlock</span> <span>checks</span> <span>periodically</span> <span>(</span> <span>once</span> <span>an</span> <span>hour</span> <span>or</span> <span>when</span> <span>CPU</span> <span>usage</span> <span>is</span> <span>low?),</span> <span>and</span> <span>then</span> <span>use</span> <span>the</span> <span>historical</span> <span>log</span> <span>to</span> <span>trace</span> <span>through</span> <span>and</span> <span>determine</span> <span>when</span> <span>the</span> <span>deadlock</span> <span>occurred</span> <span>and</span> <span>what</span> <span>processes</span> <span>caused</span> <span>the</span> <span>initial</span> <span>deadlock</span>.<span></span> <span>Unfortunately</span> <span>I'm</span> <span>not</span> <span>certain</span> <span>that</span> <span>breaking</span> <span>the</span> <span>original</span> <span>deadlock</span> <span>would</span> <span>then</span> <span>free</span> <span>up</span> <span>the</span> <span>resulting</span> <span>log</span> <span>jam</span>.<span></span> <span>)</span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
</blockquote>
<h3><span>7</span>.<span>7</span> <span>Recovery</span> <span>From</span> <span>Deadlock</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> </h3>
<ul>
  <li><span>There</span> <span>are</span> <span>three</span> <span>basic</span> <span>approaches</span> <span>to</span> <span>recovery</span> <span>from</span> <span>deadlock:
</span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Inform</span> <span>the</span> <span>system</span> <span>operator,</span> <span>and</span> <span>allow</span> <span>him/her</span> <span>to</span> <span>take</span> <span>manual</span> <span>intervention</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Terminate</span> <span>one</span> <span>or</span> <span>more</span> <span>processes</span> <span>involved</span> <span>in</span> <span>the</span> <span>deadlock</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Preempt</span> <span>resources</span>.<span></span> <span></span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> </li>
</ul>
<blockquote>
  <h4><span>7</span>.<span>7</span>.<span>1</span> <span>Process</span> </h4>
  <ul>
    <li><span>Two</span> <span>basic</span> <span>approaches,</span> <span>both</span> <span>of</span> <span>which</span> <span>recover</span> <span>resources</span> <span>allocated</span> <span>to</span> <span>terminated</span> <span>processes:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ul><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Terminate</span> <span>all</span> <span>processes</span> <span>involved</span> <span>in</span> <span>the</span> <span>deadlock</span>.<span></span> <span>This</span> <span>definitely</span> <span>solves</span> <span>the</span> <span>deadlock,</span> <span>but</span> <span>at</span> <span>the</span> <span>expense</span> <span>of</span> <span>terminating</span> <span>more</span> <span>processes</span> <span>than</span> <span>would</span> <span>be</span> <span>absolutely</span> <span>necessary</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Terminate</span> <span>processes</span> <span>one</span> <span>by</span> <span>one</span> <span>until</span> <span>the</span> <span>deadlock</span> <span>is</span> <span>broken</span>.<span></span> <span>This</span> <span>is</span> <span>more</span> <span>conservative,</span> <span>but</span> <span>requires</span> <span>doing</span> <span>deadlock</span> <span>detection</span> <span>after</span> <span>each</span> <span>step</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ul><span>
</span> <span></span> <span></span> <span></span> </li>
    <li><span>In</span> <span>the</span> <span>latter</span> <span>case</span> <span>there</span> <span>are</span> <span>many</span> <span>factors</span> <span>that</span> <span>can</span> <span>go</span> <span>into</span> <span>deciding</span> <span>which</span> <span>processes</span> <span>to</span> <span>terminate</span> <span>next:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Process</span> <span>priorities</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>How</span> <span>long</span> <span>the</span> <span>process</span> <span>has</span> <span>been</span> <span>running,</span> <span>and</span> <span>how</span> <span>close</span> <span>it</span> <span>is</span> <span>to</span> <span>finishing</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>How</span> <span>many</span> <span>and</span> <span>what</span> <span>type</span> <span>of</span> <span>resources</span> <span>is</span> <span>the</span> <span>process</span> <span>holding</span>.<span></span> <span>(</span> <span>Are</span> <span>they</span> <span>easy</span> <span>to</span> <span>preempt</span> <span>and</span> <span>restore?</span> <span>)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>How</span> <span>many</span> <span>more</span> <span>resources</span> <span>does</span> <span>the</span> <span>process</span> <span>need</span> <span>to</span> <span>complete</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>How</span> <span>many</span> <span>processes</span> <span>will</span> <span>need</span> <span>to</span> <span>be</span> <span>terminated</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>Whether</span> <span>the</span> <span>process</span> <span>is</span> <span>interactive</span> <span>or</span> <span>batch</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span>(</span> <span>Whether</span> <span>or</span> <span>not</span> <span>the</span> <span>process</span> <span>has</span> <span>made</span> <span>non-restorable</span> <span>changes</span> <span>to</span> <span>any</span> <span>resource</span>.<span></span> <span>)</span> <span></span> <span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
  <h4><span>7</span>.<span>7</span>.<span>2</span> <span>Resource</span> <span>Preemption</span> </h4>
  <ul>
    <li><span>When</span> <span>preempting</span> <span>resources</span> <span>to</span> <span>relieve</span> <span>deadlock,</span> <span>there</span> <span>are</span> <span>three</span> <span>important</span> <span>issues</span> <span>to</span> <span>be</span> <span>addressed:
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><ol><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Selecting</span> <span>a</span> <span>victim</span> <span></span></strong><span>-</span> <span>Deciding</span> <span>which</span> <span>resources</span> <span>to</span> <span>preempt</span> <span>from</span> <span>which</span> <span>processes</span> <span>involves</span> <span>many</span> <span>of</span> <span>the</span> <span>same</span> <span>decision</span> <span>criteria</span> <span>outlined</span> <span>above</span>.<span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Rollback</span></strong><span></span> <span>-</span> <span>Ideally</span> <span>one</span> <span>would</span> <span>like</span> <span>to</span> <span>roll</span> <span>back</span> <span>a</span> <span>preempted</span> <span>process</span> <span>to</span> <span>a</span> <span>safe</span> <span>state</span> <span>prior</span> <span>to</span> <span>the</span> <span>point</span> <span>at</span> <span>which</span> <span>that</span> <span>resource</span> <span>was</span> <span>originally</span> <span>allocated</span> <span>to</span> <span>the</span> <span>process</span>.<span></span> <span>Unfortunately</span> <span>it</span> <span>can</span> <span>be</span> <span>difficult</span> <span>or</span> <span>impossible</span> <span>to</span> <span>determine</span> <span>what</span> <span>such</span> <span>a</span> <span>safe</span> <span>state</span> <span>is,</span> <span>and</span> <span>so</span> <span>the</span> <span>only</span> <span>safe</span> <span>rollback</span> <span>is</span> <span>to</span> <span>roll</span> <span>back</span> <span>all</span> <span>the</span> <span>way</span> <span>back</span> <span>to</span> <span>the</span> <span>beginning</span>.<span></span> <span>(</span> <span>I</span>.<span>e</span>.<span></span> <span>abort</span> <span>the</span> <span>process</span> <span>and</span> <span>make</span> <span>it</span> <span>start</span> <span>over</span>.<span></span> <span>)</span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span><li><span></span><strong><span>Starvation</span> <span></span></strong><span></span> <span>-</span> <span>How</span> <span>do</span> <span>you</span> <span>guarantee</span> <span>that</span> <span>a</span> <span>process</span> <span>won't</span> <span>starve</span> <span>because</span> <span>its</span> <span>resources</span> <span>are</span> <span>constantly</span> <span>being</span> <span>preempted?</span> <span>One</span> <span>option</span> <span>would</span> <span>be</span> <span>to</span> <span>use</span> <span>a</span> <span>priority</span> <span>system,</span> <span>and</span> <span>increase</span> <span>the</span> <span>priority</span> <span>of</span> <span>a</span> <span>process</span> <span>every</span> <span>time</span> <span>its</span> <span>resources</span> <span>get</span> <span>preempted</span>.<span></span> <span>Eventually</span> <span>it</span> <span>should</span> <span>get</span> <span>a</span> <span>high</span> <span>enough</span> <span>priority</span> <span>that</span> <span>it</span> <span>won't</span> <span>get</span> <span>preempted</span> <span>any</span> <span>more</span>.<span></span> <span></span></li><span>
</span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></ol><span>
</span> <span></span> <span></span> <span></span> </li>
  </ul>
</blockquote>
<h3><span>7</span>.<span>8</span> </h3>


</body><script src="./5_ Deadlocks_files/jquery.min.js.download"></script><script>function makeSpans(){$("h1, h2, h3, h4, h5, h6, p, li, td, img").each(function(){var s=splitText($(this).html());$(this).empty();for(var a="",h=0;h<s.length;h++)a+=s[h];$(this).html(a)})}function splitText(s){for(var a=[],h="",e=0;e<s.length;e++)if("<"===s.charAt(e)){a.push("<span>"+h+"</span>"),h="<";var i=1;do e++,"<"===s.charAt(e)&&i++,">"===s.charAt(e)&&i--,h+=s.charAt(e);while(i>0);console.log(h),a.push(h),h=""}else" "!=s.charAt(e)&&"."!=s.charAt(e)?h+=s.charAt(e):(console.log(h),a.push("<span>"+h+"</span>"),h="",a.push(""+s.charAt(e)));return a}$(document).ready(function(){makeSpans(),$("BODY").addClass("whiteBG"),$("span").on("click",function(){$(this).hasClass("hideWord")?($(this).removeClass("hideWord hoverOver"),$(this).addClass("hideWord2")):$(this).hasClass("hideWord2")?$(this).removeClass("hideWord2"):$(this).addClass("hideWord")}),$("span").hover(function(){$(this).hasClass("hideWord")&&$(this).addClass("hoverOver")},function(){$(this).removeClass("hoverOver")}),$("img").on("click",function(){$(this).hasClass("imageHide")?($(this).removeClass("imageHide"),$(this).addClass("imageReveal")):$(this).addClass("imageHide")}),$("img").hover(function(){$(this).hasClass("imageHide")&&$(this).addClass("imageReveal")},function(){$(this).removeClass("imageReveal")})});</script></html>